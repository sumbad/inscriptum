(window.webpackJsonp=window.webpackJsonp||[]).push([[11,27,31,52],{529:function(t,e,n){"use strict";n.r(e),n.d(e,"AbstractRouter",function(){return i});var r=n(78);class i{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector("main")||document.body;this.routerOutlet=t,this.page=r.a.page;const e=this.getRouter();r.a.routing(e.rootPath,e.routers)}}},551:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(608),i=n.n(r),s=n(201);class o{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.URL;if(this._storageService=t,this.$authenticated=new s.BehaviorSubject(!1),o.instance)return o.instance;const n=new i.a("sSGAFDwnRqJUsJw7v12KV8SAeuYtl3Cd","inscriptum.auth0.com",{auth:{redirectUrl:e,responseType:"token id_token",params:{scope:"openid email"},audience:"https://inscriptum.js.org"}});n.on("authenticated",t=>{this.checkAuth(t.accessToken,n),n.getUserInfo(t.accessToken,(e,r)=>{if(e)throw e;localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("auth0IdToken",t.idToken),localStorage.setItem("profile",JSON.stringify(r)),n.hide()})}),this.checkAuth(localStorage.getItem("accessToken")||"",n),o.instance=this}async checkAuth(t,e){try{await new Promise((n,r)=>{e.getUserInfo(t,(t,e)=>{t?r(t):n(e)})}),await this._storageService.authenticateUser(t)&&this.$authenticated.next(!0)}catch(t){e.show()}}}},553:function(t,e,n){"use strict";n(202);var r=n(624),i="\n  {\n    allDrafts {\n      contents\n      id\n    }\n  }\n",s="\n  mutation($accessToken: String) {\n    authenticateUser(\n      accessToken: $accessToken\n    ) {\n      id\n      token\n    }\n  }\n",o="\n  mutation($id: ID!, $contents: Json!) {\n    updateDraft(id: $id, contents: $contents){\n      id\n    }\n  }\n",a="\n  query Draft($id: ID!) {\n      Draft(id: $id) {\n      contents\n      id\n    }\n  }\n",c="\n  mutation {\n    createDraft {\n      contents\n      id\n    }\n  }\n",u="\n  mutation($id: ID!) {\n    deleteDraft(id: $id){\n      id\n      contents\n    }\n  }\n";function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){l(t,e,n[e])})}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",function(){return d});class d{constructor(){if(this._graphQLClientOptions={credentials:"include",mode:"cors",cache:"no-cache",method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}},this._graphQLClientEndpoind="https://api.graph.cool/simple/v1/cjd617qc7245901203dv54gy4",d.instance)return d.instance;this._graphQLClient=new r.GraphQLClient(this._graphQLClientEndpoind,this._graphQLClientOptions),d.instance=this}getDraft(t){return this._graphQLClient.request(a,{id:t})}allDrafts(){return this._graphQLClient.request(i)}updateDraft(t,e){return this._graphQLClient.request(o,{id:t,contents:e})}deleteDraft(t){return this._graphQLClient.request(u,{id:t})}createDraft(){return this._graphQLClient.request(c)}sendBeacon4UpdateDraft(t,e){const n=`\n      mutation {\n        updateDraft(id: ${t}, contents: ${e}){\n          id\n        }\n      }\n    `,r={type:"application/x-www-form-urlencoded",Authorization:(this._graphQLClientOptions.headers||{}).Authorization,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"};Object.keys(JSON.stringify(n)).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n)}).join("&");let i=new Blob([encodeURIComponent("query")+"="+encodeURIComponent(n)],r);navigator.sendBeacon(this._graphQLClientEndpoind,i)}async authenticateUser(t){const e=await this._graphQLClient.request(s,{accessToken:t});return this._addAuthInfoToGraphQLClient(e.authenticateUser.token),e}_addAuthInfoToGraphQLClient(t){this._graphQLClientOptions=h({},this._graphQLClientOptions,{headers:h({},this._graphQLClientOptions.headers,{Authorization:`Bearer ${t}`})}),this._graphQLClient=new r.GraphQLClient(this._graphQLClientEndpoind,this._graphQLClientOptions)}}},562:function(t,e,n){"use strict";n.r(e),n.d(e,"DraftComponent",function(){return h});n(202);var r=n(613),i=n(54),s=n(607),o=n(553),a=n(551),c=n(602),u=function(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,n,o):i(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};let h=class extends r.a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.a,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.a(t);super(s.a,!1),this._storageService=t,this._authService=e,this.html=i.a,this.state={time:(new Date).toLocaleTimeString()},this._subscriptions=[]}set sub(t){this._subscriptions.push(t)}connectedCallback(){super.connectedCallback(),this.sub=c.draftRouter.$routeDraftsList.subscribe(async t=>{await n.e(56).then(n.bind(null,612)),this.routerView=this.html`<inscriptum-draft-list></inscriptum-draft-list>`,this.render(),t.ctx.handled=!0})}disconnectedCallback(){this._subscriptions.forEach(t=>t.unsubscribe())}render(){return this.html`
      ${this.routerView}
    `}};u([Object(r.c)()],h.prototype,"routerView",void 0),h=u([Object(r.b)("inscriptum-draft")],h)},602:function(t,e,n){"use strict";n.r(e),n.d(e,"draftRouter",function(){return s});n(203);var r=n(201),i=n(529);const s=new class extends i.AbstractRouter{constructor(){super(...arguments),this.$routeEdit=new r.Subject,this.$routeDraftsList=new r.Subject}getRouter(){return{rootPath:"/articles/draft",routers:[{path:"/list",callback:(t,e)=>this.$routeDraftsList.next({ctx:t,next:e})},{path:"/*",callback:(t,e)=>{t.handled?(t.handled=!1,e()):this.page.replace("/articles/draft/list")}}]}}}}}]);