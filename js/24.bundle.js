(window.webpackJsonp=window.webpackJsonp||[]).push([[24,41,56],{528:function(t,e,n){"use strict";n.r(e),n.d(e,"PreloaderService",function(){return r});var i=n(201);class r{}r.isAppLoading=new i.Subject},551:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n(608),r=n.n(i),s=n(201);class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.URL;if(this._storageService=t,this.$authenticated=new s.BehaviorSubject(!1),a.instance)return a.instance;const n=new r.a("sSGAFDwnRqJUsJw7v12KV8SAeuYtl3Cd","inscriptum.auth0.com",{auth:{redirectUrl:e,responseType:"token id_token",params:{scope:"openid email"},audience:"https://inscriptum.js.org"}});n.on("authenticated",t=>{this.checkAuth(t.accessToken,n),n.getUserInfo(t.accessToken,(e,i)=>{if(e)throw e;localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("auth0IdToken",t.idToken),localStorage.setItem("profile",JSON.stringify(i)),n.hide()})}),this.checkAuth(localStorage.getItem("accessToken")||"",n),a.instance=this}async checkAuth(t,e){try{await new Promise((n,i)=>{e.getUserInfo(t,(t,e)=>{t?i(t):n(e)})}),await this._storageService.authenticateUser(t)&&this.$authenticated.next(!0)}catch(t){e.show()}}}},553:function(t,e,n){"use strict";n(202);var i=n(624),r="\n  {\n    allDrafts {\n      contents\n      id\n    }\n  }\n",s="\n  mutation($accessToken: String) {\n    authenticateUser(\n      accessToken: $accessToken\n    ) {\n      id\n      token\n    }\n  }\n",a="\n  mutation($id: ID!, $contents: Json!) {\n    updateDraft(id: $id, contents: $contents){\n      id\n    }\n  }\n",o="\n  query Draft($id: ID!) {\n      Draft(id: $id) {\n      contents\n      id\n    }\n  }\n",c="\n  mutation {\n    createDraft {\n      contents\n      id\n    }\n  }\n",h="\n  mutation($id: ID!) {\n    deleteDraft(id: $id){\n      id\n      contents\n    }\n  }\n";function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){d(t,e,n[e])})}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",function(){return u});class u{constructor(){if(this._graphQLClientOptions={credentials:"include",mode:"cors",cache:"no-cache",method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}},this._graphQLClientEndpoind="https://api.graph.cool/simple/v1/cjd617qc7245901203dv54gy4",u.instance)return u.instance;this._graphQLClient=new i.GraphQLClient(this._graphQLClientEndpoind,this._graphQLClientOptions),u.instance=this}getDraft(t){return this._graphQLClient.request(o,{id:t})}allDrafts(){return this._graphQLClient.request(r)}updateDraft(t,e){return this._graphQLClient.request(a,{id:t,contents:e})}deleteDraft(t){return this._graphQLClient.request(h,{id:t})}createDraft(){return this._graphQLClient.request(c)}sendBeacon4UpdateDraft(t,e){const n=`\n      mutation {\n        updateDraft(id: ${t}, contents: ${e}){\n          id\n        }\n      }\n    `,i={type:"application/x-www-form-urlencoded",Authorization:(this._graphQLClientOptions.headers||{}).Authorization,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"};Object.keys(JSON.stringify(n)).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n)}).join("&");let r=new Blob([encodeURIComponent("query")+"="+encodeURIComponent(n)],i);navigator.sendBeacon(this._graphQLClientEndpoind,r)}async authenticateUser(t){const e=await this._graphQLClient.request(s,{accessToken:t});return this._addAuthInfoToGraphQLClient(e.authenticateUser.token),e}_addAuthInfoToGraphQLClient(t){this._graphQLClientOptions=l({},this._graphQLClientOptions,{headers:l({},this._graphQLClientOptions.headers,{Authorization:`Bearer ${t}`})}),this._graphQLClient=new i.GraphQLClient(this._graphQLClientEndpoind,this._graphQLClientOptions)}}},612:function(t,e,n){"use strict";n.r(e),n.d(e,"DraftComponent",function(){return l});var i=n(613),r=n(54),s=n(607),a=n(553),o=n(551),c=n(528),h=function(t,e,n,i){var r,s=arguments.length,a=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,n,a):r(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a};let l=class extends i.a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new a.a,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.a(t);super(s.a,!1),this._storageService=t,this._authService=e,this.html=r.a,this.draftList=[],this._subscriptions=[],this._authService.$authenticated.subscribe(t=>{t&&this._storageService.allDrafts().then(t=>{console.log(t),this.draftList=t.allDrafts,c.PreloaderService.isAppLoading.next(!1)})})}set sub(t){this._subscriptions.push(t)}render(){const t=this.draftList.map(t=>this.html`
        <section class="entry">
        
          <header class="entry-header">
            <h2 class="entry-title">
              <a href=${"/editor/"+t.id}> ${t.contents.ops[0].insert} </a> </h2>
            <div class="entry-meta">
              <ul>
                <li>${t.id}</li>
              </ul>
            </div>
          </header>
        
          <div class="entry-content">
            <slot></slot>
          </div>
        
        </section>
    `);return this.html`${t}`}};h([Object(i.c)()],l.prototype,"draftList",void 0),l=h([Object(i.b)("inscriptum-draft-list")],l)}}]);