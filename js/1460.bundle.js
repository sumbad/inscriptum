/*! For license information please see 1460.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkinscriptum=self.webpackChunkinscriptum||[]).push([[1460,8079,8926,3164,4099,9731,3041,9296,9691,9022,1888,6885,6301],{8079:(t,e,o)=>{o.r(e),o.d(e,{BlockquoteBlot:()=>r});var n=o(5039),i=o(3691);class r extends i.ZP{}r.blotName="blockBlockquote",r.tagName="blockquote",n.Z.register(r)},8926:(t,e,o)=>{o.r(e),o.d(e,{BreakBlot:()=>r});var n=o(5039),i=o(3691);class r extends i.i2{}r.blotName="textBreak",r.tagName="br",r.className="inline",n.Z.register(r)},3164:(t,e,o)=>{o.r(e),o.d(e,{DescriptionBlot:()=>r});var n=o(5039),i=o(9731);class r extends i.FieldBlot{static create(t){console.log("DescriptionBlot create ",t);let e=super.create(t);return e.setAttribute("data-placeholder","Summary of the text"),e.setAttribute("data-label","Description"),e}formatAt(t,e,o,n){console.log("DescriptionBlot formatAt ",t,e,o,n),o===r.blotName?super.formatAt(t,e,o,n):"link"===o&&super.formatAt(0,this.length(),o,n)}format(t,e){console.log("DescriptionBlot format ",t,e),super.format(t,e)}replace(t){console.log("DescriptionBlot replace ",t),super.replace(t)}insertAt(t,e,o){console.log("DescriptionBlot insertAt ",t,e,o),super.insertAt(t,e,o)}}r.blotName="blockDescription",r.tagName="address",n.Z.register(r)},4099:(t,e,o)=>{o.r(e),o.d(e,{DividerBlot:()=>i});var n=o(3691);class i extends n.i2{}i.blotName="blockDivider",i.tagName="hr"},9731:(t,e,o)=>{o.r(e),o.d(e,{FieldBlot:()=>i});var n=o(9022);class i extends n.SingleLineBlot{}},3041:(t,e,o)=>{o.r(e),o.d(e,{HeaderBlot:()=>r});var n=o(5039),i=o(9022);class r extends i.SingleLineBlot{optimize(t){super.optimize(t);let e=this.domNode.innerText;e=e.replace(/[\s_]+/g,"-"),e=e.replace(/(^-+|-+$)/g,""),this.domNode.id!==e&&this.domNode.setAttribute("id",e)}formatAt(t,e,o,n){("bold"!==o&&"italic"!==o&&"code"!==o||!n)&&super.formatAt(t,e,o,n)}}r.blotName="blockHeader",r.tagName="h3",n.Z.register(r)},5622:(t,e,o)=>{o.r(e),o.d(e,{CodeEndLineFlag:()=>a,InsSyntaxCodeBlock:()=>l,InsSyntaxModule:()=>s});var n=o(5039),i=o(1154),r=o(3549);class a extends i.Z{static formats(){return{}}}a.blotName="code-end",a.className="l",a.tagName="SPAN",n.Z.register(a);class l extends r.dn{highlight(t){let e=this.domNode.textContent||"";if(this.cachedText!==e){if(e.trim().length>0||null==this.cachedText){let o="";const n=t(e).split("\n");for(let t=0;t<n.length-1;t++)o+=`<span class="l">${n[t]||" "}</span>\n`;o+=`<span class="l">${n[n.length-1]}</span>`,this.domNode.innerHTML=`<code class="hljs">${o}</code>`}this.cachedText=e}}}class s extends r.ZP{static register(){n.Z.register(r.GW,!0),n.Z.register(l,!0)}highlight(){if(this.quill.selection.composing)return;this.quill.update(n.Z.sources.USER);let t=this.quill.getSelection();this.quill.scroll.descendants(l).forEach((t=>{t.highlight(this.options.highlight)})),this.quill.update(n.Z.sources.SILENT),null!=t&&document.activeElement===this.quill.container.querySelector("[contenteditable]")&&this.quill.setSelection(t,n.Z.sources.SILENT)}}},7466:(t,e,o)=>{o.r(e),o.d(e,{LinkBlot:()=>r});var n=o(1154),i=o(6136);class r extends n.Z{constructor(t,e){super(t),this.value=e,t.addEventListener("mouseover",r.showLinkTooltip.bind(this,this),!1),t.addEventListener("mouseout",r.hideLinkTooltip,!1)}static create(t){let e=super.create(t);t=this.sanitize(t),e.setAttribute("href",t);var o=t.substr(0,1);return"/"!=o&&"#"!=o&&"tg://"!=t.substr(0,5)&&"mailto:"!=t.substr(0,7)&&e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){const e=r.relativeUrl(t);return(0,i.sanitize)(t,["http","https","tg","mailto"])?e:"about:blank"}detach(){this.domNode.removeEventListener("mouseover",r.showLinkTooltip.bind(this,this),!1),this.domNode.removeEventListener("mouseout",r.hideLinkTooltip,!1),super.detach(),r.hideLinkTooltip()}format(t,e){if(t!==this.statics.blotName||!e)return super.format(t,e);e=r.sanitize(e),this.domNode.setAttribute("href",e),this.domNode.setAttribute("data-title",e)}static relativeUrl(t){let e=location,o=document.createElement("a");return o.href=t,e.origin!==o.origin?o.href:e.pathname!==o.pathname||e.search!==o.search?o.pathname+o.search+o.hash:e.href===o.href?o.hash||o.pathname+o.search+o.hash:o.hash}}},1428:(t,e,o)=>{o.r(e),o.d(e,{ListContinuer:()=>i});var n=o(9244);class i extends n.Z{static create(t){let e;return"string"==typeof t?e=super.create(t):(e=super.create(t.type),void 0!==t.start&&(e.setAttribute("start",t.start),e.style["counter-reset"]=`list-0 ${t.start}`)),e}static formats(t){let e=super.formats(t);return console.log("MyList-static.formats",e,t.getAttribute("start")),{type:e,start:t.getAttribute("start")}}}},9296:(t,e,o)=>{o.r(e),o.d(e,{MyQuill:()=>i});var n=o(5039);class i extends n.Z{formatLine(...t){super.formatLine(...t),this.updateSelection()}formatText(...t){super.formatText(...t),this.updateSelection()}updateSelection(t){if(this.hasFocus()){t=t||i.sources.SILENT;let e=this.getSelection(!0);this.setSelection(++e.index,e.length,t),this.setSelection(--e.index,e.length,t)}}}},9691:(t,e,o)=>{o.r(e),o.d(e,{PullquoteBlot:()=>r});var n=o(5039),i=o(3691);class r extends i.ZP{}r.blotName="blockPullquote",r.tagName="aside",n.Z.register(r)},9022:(t,e,o)=>{o.r(e),o.d(e,{SingleLineBlot:()=>l});var n=o(3691),i=o(8926),r=o(347),a=o.n(r);class l extends n.ZP{replace(t){t.children.forEach((t=>{t instanceof i.BreakBlot&&t.replaceWith(a().create("text"," "))})),super.replace(t)}insertAt(t,e,o){void 0!==o&&"textBreak"==e?super.insertAt(t,"\n"):super.insertAt(t,e,o)}}},1888:(t,e,o)=>{o.r(e),o.d(e,{SubheaderBlot:()=>r});var n=o(5039),i=o(3041);class r extends i.HeaderBlot{}r.blotName="blockSubheader",r.tagName="h4",n.Z.register(r)},6885:(t,e,o)=>{o.r(e),o.d(e,{TitleBlot:()=>r});var n=o(5039),i=o(9731);class r extends i.FieldBlot{static create(t){let e=super.create(t);return e.setAttribute("data-placeholder","Title"),e.setAttribute("data-label","Title"),e}formatAt(t,e,o,n){o===r.blotName&&super.formatAt(t,e,o,n)}}r.blotName="blockTitle",r.tagName="h1",n.Z.register(r)},6301:(t,e,o)=>{o.r(e),o.d(e,{default:()=>u});var n=o(637),i=o(9622),r=o(2247),a=o(4085),l=o(1042),s=o(836),c=o(6167),d=o(5688);n.Z.registerLanguage("javascript",i.Z),n.Z.registerLanguage("typescript",r.Z),n.Z.registerLanguage("sql",a.Z),n.Z.registerLanguage("xml",l.Z),n.Z.registerLanguage("css",s.Z),n.Z.registerLanguage("bash",c.Z),n.Z.registerLanguage("yaml",d.Z);const u=n.Z},1460:(t,e,o)=>{o.r(e),o.d(e,{draftElement:()=>Ao});var n=o(3445),i=o(78),r=o(9048);const a={PAGE_SAVE:Symbol("[HUB_ACTION] PAGE_SAVE"),PAGE_SAVING:Symbol("[HUB_ACTION] PAGE_SAVING"),PAGE_SAVE_DONE:Symbol("[HUB_ACTION] PAGE_SAVE_DONE"),PAGE_SAVE_FAIL:Symbol("[HUB_ACTION] PAGE_SAVE_FAIL"),DRAFT_ADD_PAGE_DONE:Symbol("[HUB_ACTION] DRAFT_ADD_PAGE_DONE"),DRAFT_DELETE_PAGE_DONE:Symbol("[HUB_ACTION] DRAFT_DELETE_PAGE_DONE"),DRAFT_PUBLISH:Symbol("[HUB_ACTION] DRAFT_PUBLISH")};var l=o(7157),s=o(7012),c=o(1640),d=o(3584),u=o(4938),p=o(669);const h=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-download" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"></path>
          <polyline points="7 11 12 16 17 11"></polyline>
          <line x1="12" y1="4" x2="12" y2="16"></line>
        </svg>
    `,this)}))(),g=(0,d.EG)({props:{draftId:d.p.req("draft-id")}})((function*(t){function e(){r.Z.dispatch({type:a.DRAFT_PUBLISH,payload:{draftId:t.draftId}})}for(;;)yield(0,c.sY)(c.dy`<div style=${u.iv`
          margin: 1rem 0;
          display: flex;
          flex-direction: row;
        `}>
        <button class="btn btn_icon" @click=${e}>
          ${h({})}
        </button>
      </div>`,this)}));var f=o(8760),m=o(6008),b=o(2114);const v="DRAFT_ACTION",y={LOAD:Symbol(`[${v}] LOAD`),LOADING:Symbol(`[${v}] LOADING`),LOAD_DONE:Symbol(`[${v}] LOAD_DONE`),UPDATE_TOC_DONE:Symbol(`[${v}] UPDATE_TOC_DONE`),UPDATE_TOC_ERROR:Symbol(`[${v}] UPDATE_TOC_ERROR`)};var _=o(6798),x=o(8481),w=o(6856),k=o(128),A=o(7082),E=o(54),S=o(9302),L=o(4334),T=o(7191),P=o(1769),M=o(732),$=o(6829),N=o(9802),C=o(3427),B=o(5961),I=o(9457),D=o(3418),z=o(9068),Z=o(4746),O=o(6667),j=o(4524),R=o(6106),H=o(6922),F=o(8757);const q=_.NB.create({name:"topicDoc",topNode:!0,content:"topicTitle topicSummary topicFirstLine block*",addProseMirrorPlugins:()=>[new H.Sy({key:new H.H$("TopicDoc Decorations"),props:{decorations:({doc:t,selection:e})=>{const o=[],n=t.content.child(0),i=t.content.child(1),r=t.content.child(2);return 0===n.content.size?o.push(F.p.node(0,n.nodeSize,{class:"empty"})):e.to<=n.nodeSize+i.nodeSize&&o.push(F.p.node(0,n.nodeSize,{class:"focused"})),0===i.content.size?o.push(F.p.node(n.nodeSize,n.nodeSize+i.nodeSize,{class:"empty"})):e.to<=n.nodeSize+i.nodeSize&&o.push(F.p.node(n.nodeSize,n.nodeSize+i.nodeSize,{class:"focused"})),t.content.lastChild===r&&0===r.content.size&&o.push(F.p.node(n.nodeSize+i.nodeSize,n.nodeSize+i.nodeSize+r.nodeSize,{class:"empty"})),F.EH.create(t,o)}}})]});var U=o(9059),G=o(9586);const W=_.NB.create({name:"topicFirstLine",group:"topicDoc",content:"inline*",addAttributes:()=>({"data-placeholder":{default:"Take a notes"}}),parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",(0,_.P1)(this.options.HTMLAttributes,t),0]}});const V=o(8802).rU.extend({renderHTML(t){return"function"==typeof this.options.onRenderHTML&&this.options.onRenderHTML(t),["a",(0,_.P1)(this.options.HTMLAttributes,t.HTMLAttributes),0]}});var Y=o(3861);const J=_.NB.create({name:"aside",defaultOptions:{HTMLAttributes:{}},content:"block*",group:"block",defining:!0,parseHTML:()=>[{tag:"aside"}],renderHTML({HTMLAttributes:t}){return["aside",(0,_.P1)(this.options.HTMLAttributes,t),0]},addCommands:()=>({setAside:()=>({commands:t})=>t.wrapIn("aside"),toggleAside:()=>({commands:t})=>t.toggleWrap("aside"),unsetAside:()=>({commands:t})=>t.lift("aside")})});var K=o(8638);const Q=o(9889).dn.extend({name:"hljsCodeBlock",content:"hljsCodeBlockRow+",topNode:!0,parseHTML:()=>[{preserveWhitespace:"full",tag:"pre"}],renderHTML({HTMLAttributes:t}){return["pre",this.options.HTMLAttributes,["code",t,0]]}}),X=_.vc.create({name:"hljsMark",spanning:!1,group:"hljsCodeBlock hljsCodeBlockRow",defaultOptions:{HTMLAttributes:{}},addAttributes:()=>({class:{default:void 0}}),parseHTML:()=>[{tag:"span",preserveWhitespace:!0}],renderHTML({HTMLAttributes:t}){return["span",(0,_.P1)(this.options.HTMLAttributes,t),0]}}),tt=_.NB.create({name:"hljsCodeBlockRow",defaultOptions:{HTMLAttributes:{}},group:"hljsCodeBlock",content:"inline*",marks:"hljsMark",addAttributes:()=>({class:{default:"l"}}),parseHTML:()=>[{tag:"div.l",preserveWhitespace:"full",attrs:{class:"l"}}],renderHTML({HTMLAttributes:t,node:e}){return["div",(0,_.P1)(this.options.HTMLAttributes,t),0]}});var et=o(896),ot=o(837),nt=o(9622),it=o(2247),rt=o(4085),at=o(1042),lt=o(836),st=o(6167),ct=o(5688);ot.Z.registerLanguage("javascript",nt.Z),ot.Z.registerLanguage("typescript",it.Z),ot.Z.registerLanguage("sql",rt.Z),ot.Z.registerLanguage("xml",at.Z),ot.Z.registerLanguage("css",lt.Z),ot.Z.registerLanguage("bash",st.Z),ot.Z.registerLanguage("yaml",ct.Z);const dt=["javascript","typescript","sql","xml","css","bash","yaml"];function ut(t){const e=ot.Z.highlightAuto(t,dt).value.split("\n");let o="";const n=[Q,z.Z,tt,X],i=document.createElement("pre");for(const t of e)o+=`<div class="l">${t||""}</div>`;i.innerHTML=o;const r=function(t,e){const o=(0,_.J1)(e);return K.aw.fromSchema(o).parse(t,{preserveWhitespace:"full"})}(i,n);return i.remove(),n.length=0,r.toJSON()}function pt(t,e,o){return new et.VK(t,((t,n,i,r)=>{const a=o instanceof Function?o(n):o,{tr:l}=t;return n[0]&&(l.replaceWith(i-1,r,e.create(a,t.schema.node("hljsCodeBlockRow"))),l.setSelection(H.Bs.create(l.doc,r-1))),l}))}function ht(t){let e="";return t.content.forEach(((o,n)=>{e+=o.textContent,n+o.nodeSize<t.nodeSize-2&&(e+="\n")})),e}const gt=/^```(?<language>[a-z]*)? $/,ft=/^~~~(?<language>[a-z]*)? $/,mt=_.NB.create({name:"hljsCodeBlock",content:"(hljsCodeBlockRow|paragraph?)+",isolating:!0,defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{},printContentAsHTML:!1},marks:"",group:"block",defining:!0,addAttributes(){return{autocomplete:{default:"off"},autocorrect:{default:"off"},autocapitalize:{default:"off"},spellcheck:{default:"false"},language:{default:null,parseHTML:t=>{var e;const o=null===(e=t.firstElementChild)||void 0===e?void 0:e.getAttribute("class");if(!o)return null;const n=new RegExp(`^(${this.options.languageClassPrefix})`);return{language:o.replace(n,"")}},renderHTML:t=>t.language?{class:this.options.languageClassPrefix+t.language}:null}}},parseHTML:()=>[{preserveWhitespace:"full",tag:"pre",getContent(t,e){let o="";t.childNodes.forEach((t=>{o+=t.textContent,"BR"===t.nodeName&&(o+="\n")}));const n=ut(o);return e.nodeFromJSON(n).content}},{tag:"div",preserveWhitespace:"full",getAttrs:t=>"pre"===t.style.whiteSpace&&null,getContent(t,e){let o="";t.childNodes.forEach((t=>{o+=t.textContent+"\n"}));const n=ut(o);return e.nodeFromJSON(n).content}}],renderHTML({HTMLAttributes:t,node:e}){const o=this.options.printContentAsHTML?0:ht(e);return["pre",this.options.HTMLAttributes,["code",t,o]]},addCommands(){return{setHljsCodeBlock:t=>e=>{const o=e.state.selection.content();let n="";o.content.forEach(((t,e)=>{n+=t.textContent,e+t.nodeSize<o.content.size-2&&(n+="\n")}));const i=ut(n),r=e.editor.schema.nodeFromJSON(i).content.toJSON()||[];return e.chain().insertContent({type:this.name,attrs:t,content:r}).setTextSelection(e.state.selection.$to.end()-1).run()},toggleHljsCodeBlock:t=>e=>{const o=e.state.selection.content().content;if(null!=o.firstChild&&o.firstChild.type===this.type){let t="";return o.forEach(((e,n)=>{e.type===this.type?t+=ht(e):t+=e.textContent,n+e.nodeSize<o.size-2&&(t+="\n")})),e.chain().deleteRange({from:e.state.selection.from-2,to:e.state.selection.to}).insertContent({type:"paragraph",content:[{type:"text",text:t}]}).setTextSelection(e.state.selection.$to.end()).run()}return e.commands.setHljsCodeBlock(t)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleHljsCodeBlock(),"Mod-Enter":()=>{const{$anchor:t}=this.editor.state.selection;if("hljsCodeBlockRow"!==t.parent.type.name)return!1;const{tr:e}=this.editor.state;return this.editor.view.dispatch(e.insert(t.pos,this.editor.schema.node("paragraph",{})).split(t.pos+1,1).replaceWith(t.pos+2,t.pos+4,this.editor.schema.node("paragraph",{})).setSelection(H.Bs.create(e.doc,t.pos+2))),!0},Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,o=this.editor.state.doc.nodeAt(e.pos-2);return!((null==o?void 0:o.type)!==this.type||1!==o.content.childCount||!t)&&this.editor.commands.insertContentAt({from:e.pos-2,to:e.pos-2+o.nodeSize},{type:"paragraph"})}}},addInputRules(){return[pt(gt,this.type,(({groups:t})=>t)),pt(ft,this.type,(({groups:t})=>t))]},addNodeView(){return({editor:t,node:e,getPos:o})=>{const n=document.createElement("pre"),i=document.createElement("code");for(const t in e.attrs)i.setAttribute(t,e.attrs[t]);return 0===e.content.size&&"function"==typeof o&&requestAnimationFrame((()=>{t.view.dispatch(t.view.state.tr.insert(o()+1,t.schema.node("hljsCodeBlockRow")))})),n.appendChild(i),{dom:n,contentDOM:i,update:e=>{if(e.type!==this.type)return!1;const o=ut(ht(e)),n=t.schema.nodeFromJSON(o);e.content=n.content}}}}}),bt=_.NB.create({name:"codeBlock",defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{}},content:"text*",marks:"",group:"block",code:!0,defining:!0,parseHTML:()=>[{preserveWhitespace:"full",tag:"pre"}],renderHTML({HTMLAttributes:t}){return["pre",this.options.HTMLAttributes,["code",t,0]]},addNodeView:()=>({editor:t,node:e,getPos:o})=>{const n=e.content.firstChild;if(1===e.content.childCount&&null!=n&&"function"==typeof o)return requestAnimationFrame((()=>{const i=ut(n.text||""),r=t.schema.nodeFromJSON(i);t.view.dispatch(t.view.state.tr.deleteRange(o(),o()+e.nodeSize-1).insert(o(),r))})),{ignoreMutation:!0,update:!1};{const t=document.createElement("pre"),e=document.createElement("code");return t.appendChild(e),{dom:t,contentDOM:e}}}});function vt(t,e=!1){return(0,_.ar)(t,yt(e,!0))}function yt(t=!1,e=!1){return[...t?[q,U.l,G.V,W]:[x.Z],I.Z,z.Z,k.ZP,N.ZP,E.ZP,D.ZP,T.Z,P.Z,w.ZP,A.ZP,B.ZP,C.Z,$.Z,M.Z,S.Z,L.Z,Z.Z,O.ZP,j.ZP,mt.configure({printContentAsHTML:e}),X,tt,bt,R.Bc,J,V.configure({onRenderHTML:()=>{setTimeout((()=>{document.querySelectorAll("a[href]").forEach((t=>{null==t._tippy&&(0,Y.ZP)(t,{delay:[300,200],placement:"bottom",content:t=>t.href})}))}),1)}})]}var _t=o(3135),xt=o(7848),wt=function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function l(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,l)}s((n=n.apply(t,e||[])).next())}))};function kt(t,e){return wt(this,void 0,void 0,(function*(){return(0,xt.G)((()=>wt(this,void 0,void 0,(function*(){try{const{update_draft_by_pk:o}=yield(0,b.S)().updateDraftTOC({id:e,table_of_contents:t,updated_at:(new Date).toISOString()});null!=o&&r.Z.dispatch({type:y.UPDATE_TOC_DONE,payload:{id:e,toc:o.table_of_contents}})}catch(t){r.Z.dispatch({type:y.UPDATE_TOC_ERROR,payload:{id:e,error:t}})}}))))}))}function At(t){return wt(this,void 0,void 0,(function*(){(0,xt.G)((e=>wt(this,void 0,void 0,(function*(){var o,n;const i="Title is too small",r="Content cannot be empty",a="Title was not found",l="Author was not found";let s,c="",d="",p="";for(const e of t.pages||[]){const t=0===e.order,o=e.content;if(null==o.content)throw alert(r),new Error(r);p+=`<section>${vt(o,t)}</section>`,t&&(s=(0,u.WV)(o),c=s.title.trim(),d=(0,u.u)(c).replace(/[^a-zA-Z0-9-_]/g,"-"))}if(null==s)throw alert(a),new Error(a);if(c.length<2)throw alert(i),new Error(i);const h=(yield(0,b.S)().findAuthorByAuth0({auth0_id:e.userInfo.auth0Id})).author[0];if(null==h)throw alert(l),new Error(l);const g={created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};if(null!=t.notes&&t.notes.length>0){const e=t.notes[0],o=(yield(0,b.S)().updateNode({id:e.id,name:d,preview:s,static_link:`note/${d}`,updated_at:g.updated_at})).update_note_by_pk;g.created_at=null==o?void 0:o.created_at,g.created_at=null==o?void 0:o.created_at}else{const e=(yield(0,b.S)().createNode({draft_id:t.id,author_id:h.id,name:d,preview:s,static_link:`note/${d}`,created_at:(new Date).toISOString()})).insert_note_one;g.created_at=null==e?void 0:e.created_at,g.created_at=null==e?void 0:e.created_at}const f=(yield(0,b.S)().getAllNotes()).notes;!function(t){const e=document.createElement("a");t.forEach((t=>{const o=new Blob([t.content],{type:t.type||"application/octet-stream"});e.href=window.URL.createObjectURL(o),e.download=t.name,e.click()})),e.remove()}([{content:`  \n    <html>\n      <head>\n        <meta charset="utf-8">\n        <title>${c}</title>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">\n        <meta name="format-detection" content="telephone=no">\n        <meta http-equiv="X-UA-Compatible" content="IE=edge">\n        <meta name="MobileOptimized" content="176">\n        <meta name="HandheldFriendly" content="True">\n        <meta name="robots" content="index, follow">\n        <meta name="description" content="${s.description}">\n        <meta property="og:site_name" content="inscriptum">\n        <meta property="og:type" content="article">\n        <meta property="og:title" content="${c}">\n        <meta property="og:description" content="${s.description}">\n        <meta property="og:image" content="${s.image}">\n        <meta property="article:published_time" content="${g.created_at}">\n        <meta property="article:modified_time" content="${g.updated_at}">\n        <meta property="article:author" content="${h.name||h.email}">\n        <meta name="twitter:card" content="summary">\n        <meta name="twitter:title" content="${c}">\n        <meta name="twitter:description" content="${s.description}">\n        <meta name="twitter:image" content="${s.image}">\n        ${(null===(n=null===(o=document.styleSheets.item(0))||void 0===o?void 0:o.ownerNode)||void 0===n?void 0:n.outerHTML)||""}\n        <link rel="shortcut icon" type="image/png" href="favicon.png">\n        <link href="/css/note.css" rel="stylesheet">\n        <link href="/css/custom_editor_fonts.css" rel="stylesheet">\n      </head>\n      <body>\n        <article>\n          ${p}\n        </article>\n      </body>\n      <script type="text/javascript" src="/js/note.js"><\/script>\n    </html>`,name:`${d}.html`},{content:JSON.stringify(f,null,2),name:_t.v.nodeListFileName}])}))))}))}const Et={LOAD_DONE:Symbol("[MARGIN_ACTION] LOAD_DONE"),LOAD_FAIL:Symbol("[MARGIN_ACTION] LOAD_FAIL"),SAVE_DONE:Symbol("[MARGIN_ACTION] SAVE_DONE"),SAVE_FAIL:Symbol("[MARGIN_ACTION] SAVE_FAIL")};var St=function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function l(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,l)}s((n=n.apply(t,e||[])).next())}))};function Lt(t){return St(this,void 0,void 0,(function*(){return yield(0,xt.G)((()=>St(this,void 0,void 0,(function*(){const{margin:e}=yield(0,b.S)().getMarginById({id:t});if(null!=e)return r.Z.dispatch({type:Et.LOAD_DONE,payload:e}),e;throw r.Z.dispatch({type:Et.LOAD_FAIL,payload:{id:t,error:{message:`The Margin ${t} not found!`}}}),new Error(`The Margin ${t} not found!`)}))))}))}var Tt=o(6925);const Pt={data:void 0,isLoading:!1};var Mt=o(9491);class $t{constructor(t,e,o,n){if(isNaN(t)||isNaN(e))throw new Error(`Point is invalid: (${t}, ${e})`);this.x=+t,this.y=+e,this.pressure=o||0,this.time=n||Date.now()}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y&&this.pressure===t.pressure&&this.time===t.time}velocityFrom(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):0}}class Nt{constructor(t,e,o,n,i,r){this.startPoint=t,this.control2=e,this.control1=o,this.endPoint=n,this.startWidth=i,this.endWidth=r}static fromPoints(t,e){const o=this.calculateControlPoints(t[0],t[1],t[2]).c2,n=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new Nt(t[1],o,n,t[2],e.start,e.end)}static calculateControlPoints(t,e,o){const n=t.x-e.x,i=t.y-e.y,r=e.x-o.x,a=e.y-o.y,l=(t.x+e.x)/2,s=(t.y+e.y)/2,c=(e.x+o.x)/2,d=(e.y+o.y)/2,u=Math.sqrt(n*n+i*i),p=Math.sqrt(r*r+a*a),h=p/(u+p),g=c+(l-c)*h,f=d+(s-d)*h,m=e.x-g,b=e.y-f;return{c1:new $t(l+m,s+b),c2:new $t(c+m,d+b)}}length(){let t,e,o=0;for(let n=0;n<=10;n+=1){const i=n/10,r=this.point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),a=this.point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){const n=r-t,i=a-e;o+=Math.sqrt(n*n+i*i)}t=r,e=a}return o}point(t,e,o,n,i){return e*(1-t)*(1-t)*(1-t)+3*o*(1-t)*(1-t)*t+3*n*(1-t)*t*t+i*t*t*t}}class Ct extends EventTarget{constructor(t,e={}){super(),this.canvas=t,this._handleMouseDown=t=>{1===t.buttons&&(this._drawningStroke=!0,this._strokeBegin(t))},this._handleMouseMove=t=>{this._drawningStroke&&this._strokeMoveUpdate(t)},this._handleMouseUp=t=>{1===t.buttons&&this._drawningStroke&&(this._drawningStroke=!1,this._strokeEnd(t))},this._handleTouchStart=t=>{if(t.preventDefault(),1===t.targetTouches.length){const e=t.changedTouches[0];this._strokeBegin(e)}},this._handleTouchMove=t=>{t.preventDefault();const e=t.targetTouches[0];this._strokeMoveUpdate(e)},this._handleTouchEnd=t=>{if(t.target===this.canvas){t.preventDefault();const e=t.changedTouches[0];this._strokeEnd(e)}},this._handlePointerStart=t=>{this._drawningStroke=!0,t.preventDefault(),this._strokeBegin(t)},this._handlePointerMove=t=>{this._drawningStroke&&(t.preventDefault(),this._strokeMoveUpdate(t))},this._handlePointerEnd=t=>{this._drawningStroke=!1;t.target===this.canvas&&(t.preventDefault(),this._strokeEnd(t))},this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.dotSize=e.dotSize||0,this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this._strokeMoveUpdate=this.throttle?function(t,e=250){let o,n,i,r=0,a=null;const l=()=>{r=Date.now(),a=null,o=t.apply(n,i),a||(n=null,i=[])};return function(...s){const c=Date.now(),d=e-(c-r);return n=this,i=s,d<=0||d>e?(a&&(clearTimeout(a),a=null),r=c,o=t.apply(n,i),a||(n=null,i=[])):a||(a=window.setTimeout(l,d)),o}}(Ct.prototype._strokeUpdate,this.throttle):Ct.prototype._strokeUpdate,this._ctx=t.getContext("2d"),this.clear(),this.on()}clear(){const{_ctx:t,canvas:e}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0}fromDataURL(t,e={}){return new Promise(((o,n)=>{const i=new Image,r=e.ratio||window.devicePixelRatio||1,a=e.width||this.canvas.width/r,l=e.height||this.canvas.height/r,s=e.xOffset||0,c=e.yOffset||0;this._reset(),i.onload=()=>{this._ctx.drawImage(i,s,c,a,l),o()},i.onerror=t=>{n(t)},i.crossOrigin="anonymous",i.src=t,this._isEmpty=!1}))}toDataURL(t="image/png",e){switch(t){case"image/svg+xml":return this._toSVG();default:return this.canvas.toDataURL(t,e)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none";const t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),document.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t,{clear:e=!0}={}){e&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=e?t:this._data.concat(t)}toData(){return this._data}_strokeBegin(t){this.dispatchEvent(new CustomEvent("beginStroke",{detail:t}));const e={dotSize:this.dotSize,minWidth:this.minWidth,maxWidth:this.maxWidth,penColor:this.penColor,points:[]};this._data.push(e),this._reset(),this._strokeUpdate(t)}_strokeUpdate(t){if(0===this._data.length)return void this._strokeBegin(t);this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));const e=t.clientX,o=t.clientY,n=void 0!==t.pressure?t.pressure:void 0!==t.force?t.force:0,i=this._createPoint(e,o,n),r=this._data[this._data.length-1],a=r.points,l=a.length>0&&a[a.length-1],s=!!l&&i.distanceTo(l)<=this.minDistance,{penColor:c,dotSize:d,minWidth:u,maxWidth:p}=r;if(!l||!l||!s){const t=this._addPoint(i);l?t&&this._drawCurve(t,{penColor:c,dotSize:d,minWidth:u,maxWidth:p}):this._drawDot(i,{penColor:c,dotSize:d,minWidth:u,maxWidth:p}),a.push({time:i.time,x:i.x,y:i.y,pressure:i.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t){this._strokeUpdate(t),this.dispatchEvent(new CustomEvent("endStroke",{detail:t}))}_handlePointerEvents(){this._drawningStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),document.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawningStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor}_createPoint(t,e,o){const n=this.canvas.getBoundingClientRect();return new $t(t-n.left,e-n.top,o,(new Date).getTime())}_addPoint(t){const{_lastPoints:e}=this;if(e.push(t),e.length>2){3===e.length&&e.unshift(e[0]);const t=this._calculateCurveWidths(e[1],e[2]),o=Nt.fromPoints(e,t);return e.shift(),o}return null}_calculateCurveWidths(t,e){const o=this.velocityFilterWeight*e.velocityFrom(t)+(1-this.velocityFilterWeight)*this._lastVelocity,n=this._strokeWidth(o),i={end:n,start:this._lastWidth};return this._lastVelocity=o,this._lastWidth=n,i}_strokeWidth(t){return Math.max(this.maxWidth/(t+1),this.minWidth)}_drawCurveSegment(t,e,o){const n=this._ctx;n.moveTo(t,e),n.arc(t,e,o,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,e){const o=this._ctx,n=t.endWidth-t.startWidth,i=2*Math.ceil(t.length());o.beginPath(),o.fillStyle=e.penColor;for(let o=0;o<i;o+=1){const r=o/i,a=r*r,l=a*r,s=1-r,c=s*s,d=c*s;let u=d*t.startPoint.x;u+=3*c*r*t.control1.x,u+=3*s*a*t.control2.x,u+=l*t.endPoint.x;let p=d*t.startPoint.y;p+=3*c*r*t.control1.y,p+=3*s*a*t.control2.y,p+=l*t.endPoint.y;const h=Math.min(t.startWidth+l*n,e.maxWidth);this._drawCurveSegment(u,p,h)}o.closePath(),o.fill()}_drawDot(t,e){const o=this._ctx,n=e.dotSize>0?e.dotSize:(e.minWidth+e.maxWidth)/2;o.beginPath(),this._drawCurveSegment(t.x,t.y,n),o.closePath(),o.fillStyle=e.penColor,o.fill()}_fromData(t,e,o){for(const n of t){const{penColor:t,dotSize:i,minWidth:r,maxWidth:a,points:l}=n;if(l.length>1)for(let o=0;o<l.length;o+=1){const n=l[o],s=new $t(n.x,n.y,n.pressure,n.time);this.penColor=t,0===o&&this._reset();const c=this._addPoint(s);c&&e(c,{penColor:t,dotSize:i,minWidth:r,maxWidth:a})}else this._reset(),o(l[0],{penColor:t,dotSize:i,minWidth:r,maxWidth:a})}}_toSVG(){const t=this._data,e=Math.max(window.devicePixelRatio||1,1),o=this.canvas.width/e,n=this.canvas.height/e,i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("width",this.canvas.width.toString()),i.setAttribute("height",this.canvas.height.toString()),this._fromData(t,((t,{penColor:e})=>{const o=document.createElement("path");if(!(isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y))){const n=`M ${t.startPoint.x.toFixed(3)},${t.startPoint.y.toFixed(3)} C ${t.control1.x.toFixed(3)},${t.control1.y.toFixed(3)} ${t.control2.x.toFixed(3)},${t.control2.y.toFixed(3)} ${t.endPoint.x.toFixed(3)},${t.endPoint.y.toFixed(3)}`;o.setAttribute("d",n),o.setAttribute("stroke-width",(2.25*t.endWidth).toFixed(3)),o.setAttribute("stroke",e),o.setAttribute("fill","none"),o.setAttribute("stroke-linecap","round"),i.appendChild(o)}}),((t,{penColor:e,dotSize:o,minWidth:n,maxWidth:r})=>{const a=document.createElement("circle"),l=o>0?o:(n+r)/2;a.setAttribute("r",l.toString()),a.setAttribute("cx",t.x.toString()),a.setAttribute("cy",t.y.toString()),a.setAttribute("fill",e),i.appendChild(a)}));const r=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 ${this.canvas.width} ${this.canvas.height}" width="${o}" height="${n}">`;let a=i.innerHTML;if(void 0===a){const t=document.createElement("dummy"),e=i.childNodes;t.innerHTML="";for(let o=0;o<e.length;o+=1)t.appendChild(e[o].cloneNode(!0));a=t.innerHTML}return"data:image/svg+xml;base64,"+btoa(r+a+"</svg>")}}const Bt=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file-download" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
        <line x1="12" y1="11" x2="12" y2="17"></line>
        <polyline points="9 14 12 17 15 14"></polyline>
      </svg>
    `,this)})),It=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-eraser" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M19 19h-11l-4 -4a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9 9"></path>
        <line x1="18" y1="12.3" x2="11.7" y2="6"></line>
      </svg>
    `,this)})),Dt=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-device-floppy" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"></path>
        <circle cx="12" cy="14" r="2"></circle>
        <polyline points="14 4 14 8 8 8 8 4"></polyline>
      </svg>
    `,this)})),zt=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
      </svg>
    `,this)})),Zt=(0,d.NG)((function*(t={strokeWidth:"1"}){for(;;)t=yield(0,p.$)(c.YP`
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        class="icon icon-tabler icon-tabler-ripple" 
        width="24" 
        height="24" 
        viewBox="0 0 24 24" 
        stroke-width=${t.strokeWidth} 
        stroke="currentColor" 
        fill="none" 
        stroke-linecap="round" 
        stroke-linejoin="round"
      >
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12c3 -2 6 -2 9 0s6 2 9 0"></path>
      </svg>
    `,this)})),Ot=Bt(),jt=Dt(),Rt=It(),Ht=zt(),Ft=Zt(),qt=(0,d.EG)({props:{data:d.p.req(),mode:d.p.opt()}})((function*(t){var e,o,n,i;const a=(0,Mt.V)(),l=(0,Mt.V)();let s,d,p=t.data,h=t.mode,g=Math.max(window.devicePixelRatio||1,1),f=null!==(o=null===(e=p.options)||void 0===e?void 0:e.height)&&void 0!==o?o:0,m=null!==(i=null===(n=p.options)||void 0===n?void 0:n.width)&&void 0!==i?i:0,v=1,y="#000000";const _=()=>{const t=a.value,e=l.value;if(null==t||null==e)throw new Error("Can not find a canvas element!");s=e.getContext("2d");const o=m,n=f;let i=null;null==d?d=new Ct(e,{penColor:y,minDistance:1,throttle:0,onBegin:()=>{null!=s&&(s.globalAlpha=1)}}):(i=d.toDataURL(),d.clear()),f=Math.max(t.getBoundingClientRect().height,window.innerHeight,n),m=Math.max(t.getBoundingClientRect().width,o),e.height=f,e.width=m,e.style.height=`${f}px`,e.style.width=`${m}px`,t.style.height=`${f}px`,this.style.height=`${f}px`,null!=e&&null!=s&&(g=Math.max(window.devicePixelRatio||1,1),e.width=e.offsetWidth*g,e.height=e.offsetHeight*g,s.scale(g,g)),null!=d&&null!=i&&d.fromDataURL(i,{height:n,width:o,ratio:g})},x=()=>{null!=s&&(s.globalCompositeOperation="source-over")},w=()=>{if(null==d||d.isEmpty())return alert("Please provide a signature first.");null!=(null==p?void 0:p.id)&&function(t,e,o){St(this,void 0,void 0,(function*(){const[n,i]=e.split(",");return yield(0,xt.G)((()=>St(this,void 0,void 0,(function*(){const{update_margin_by_pk:e}=yield(0,b.S)().saveMargin({id:t,options:Object.assign(Object.assign({},o),{type:n}),img:i,updated_at:(new Date).toISOString()});if(null!=e)return r.Z.dispatch({type:Et.SAVE_DONE,payload:e}),e;r.Z.dispatch({type:Et.SAVE_FAIL,payload:{id:t,error:{message:`The Margin ${t} has not been saved!`}}})}))))}))}(p.id,d.toDataURL(),{height:f,width:m,ratio:g})},k=()=>{if(null!=s&&null!=d&&null!=(null==p?void 0:p.imgBase64)&&null!=(null==p?void 0:p.options)){console.log(s.globalCompositeOperation),s.globalAlpha=v,s.globalCompositeOperation="source-over";const t=d.toData();d.clear();const e=p.options,o=`${e.type},${p.imgBase64}`;d.fromDataURL(o,{height:e.height,width:e.width,ratio:g}),d.fromData(t)}},A=()=>{null!=p.id&&Lt(p.id),null!=d&&d.clear(),null!=s&&(s.font="26px sans-serif",s.fillStyle="#CCCCCC",s.fillText("loading...",50,100))};function E(){null!=s&&(s.globalCompositeOperation="destination-out")}function S(){null!=d&&d.clear()}function L(t,e){return()=>{null!=d&&(d.minWidth=t,d.maxWidth=e,console.log(t,e))}}const T=t=>{if(null!=(null==t?void 0:t.currentTarget)&&null!=d){const e=t.currentTarget;y=e.value,d.penColor=y,this.next()}},P=t=>{if(null!=(null==t?void 0:t.currentTarget)){const e=t.currentTarget;v=Number(e.value)}};for(window.onresize=_,requestAnimationFrame((()=>{_(),k()}));;)p!==t.data&&(p=t.data,k()),h!==t.mode&&(_(),h=t.mode),t=yield(0,c.sY)(c.dy`
        <div .ref=${(0,Mt.i)(a)} class="sketch-pad_frame" style=${u.iv`
            background-color: ${"full"===h?"white":"transparent"};
          `}>
          <canvas .ref=${(0,Mt.i)(l)} class="signature-pad"></canvas>
        </div>
        <div class="fab-container fab-container_main">
          <div class="fab-container">
            <button class="fab-button">
              <input type="color" id=${`${p.id}_colorPicker`} name="colorPicker" style=${u.iv`
                  cursor: pointer;
                `} .value=${y} @input=${T}>
            </button>
          </div>
          <div class="fab-container fab-container_vertical">
            <button class="fab-button" @click=${L(6,8)}>
              ${Ft({strokeWidth:"6"})}
            </button>
            <button class="fab-button" @click=${L(2.5,4)}>
              ${Ft({strokeWidth:"4"})}
            </button>
            <button class="fab-button" @click=${L(.3,1)}>
              ${Ft({strokeWidth:"1"})}
            </button>
            <button class="fab-button fab-button_lg" @click=${L(.5,2.5)}>
              ${Ft({strokeWidth:"2"})}
            </button>
          </div>
          <div class="fab-container fab-container_vertical">
            <button class="fab-button" @click=${S}>
              ${Ht({})}
            </button>
            <button class="fab-button fab-button_lg" @click=${E}>
              ${Rt({})}
            </button>
          </div>
          <div class="fab-container fab-container_vertical">
            <button class="fab-button" @click=${k}>
              <div class="alpha-setter">
                <input type="range" .value=${v} min="0" max="1" step="0.01" @input=${P}>
                <div class="alpha-setter__back">
                  <div style=${u.iv`
                      width: 100%;
                      height: 20px;
                      background: linear-gradient(to right, rgba(255, 128, 0, 0), ${y});
                    `}></div>
                </div>
              </div>
            </button>
            <button class="fab-button" @click=${A}>
              ${Ot({})}
            </button>
            <button class="fab-button fab-button_lg" @click=${w}>
              ${jt({})}
            </button>
          </div>
          <button class="fab-button fab-button_lg" @click=${x}>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4"></path>
              <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
            </svg>
          </button>
        </div>
      `,this)})),Ut=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
        <svg xmlns="http://www.w3.org/2000/svg" 
          class="icon icon-tabler icon-tabler-arrow-bar-left" 
          width="24" 
          height="24" 
          viewBox="0 0 24 24" 
          stroke-width="1" 
          stroke="currentColor" 
          fill="none" 
          stroke-linecap="round" 
          stroke-linejoin="round"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <line x1="4" y1="12" x2="14" y2="12"></line>
          <line x1="4" y1="12" x2="8" y2="16"></line>
          <line x1="4" y1="12" x2="8" y2="8"></line>
          <line x1="20" y1="4" x2="20" y2="20"></line>
        </svg>
    `,this)})),Gt=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
        <svg xmlns="http://www.w3.org/2000/svg" 
          class="icon icon-tabler icon-tabler-arrow-bar-right" 
          width="24" 
          height="24" 
          viewBox="0 0 24 24" 
          stroke-width="1" 
          stroke="currentColor" 
          fill="none" 
          stroke-linecap="round" 
          stroke-linejoin="round"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <line x1="20" y1="12" x2="10" y2="12"></line>
          <line x1="20" y1="12" x2="16" y2="16"></line>
          <line x1="20" y1="12" x2="16" y2="8"></line>
          <line x1="4" y1="4" x2="4" y2="20"></line>
        </svg>
    `,this)})),Wt=(0,d.NG)((function*(t){var e;const o=c.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bulb" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7"></path>
      <path d="M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3"></path>
      <line x1="9.7" y1="17" x2="14.3" y2="17"></line>
    </svg>
`,n=c.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bulb-off" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3"></path>
      <line x1="9.7" y1="17" x2="14.3" y2="17"></line>
    </svg>
`;for(;;){let i=null!==(e=t.isOn)&&void 0!==e&&e;t=yield(0,p.$)(i?o:n,this)}})),Vt=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrows-maximize" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <polyline points="16 4 20 4 20 8"></polyline>
          <line x1="14" y1="10" x2="20" y2="4"></line>
          <polyline points="8 20 4 20 4 16"></polyline>
          <line x1="4" y1="20" x2="10" y2="14"></line>
          <polyline points="16 20 20 20 20 16"></polyline>
          <line x1="14" y1="14" x2="20" y2="20"></line>
          <polyline points="8 4 4 4 4 8"></polyline>
          <line x1="4" y1="4" x2="10" y2="10"></line>
        </svg>
      `,this)})),Yt=(0,d.NG)((function*(){for(;;)yield(0,p.$)(c.YP`
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrows-minimize" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <polyline points="5 9 9 9 9 5"></polyline>
          <line x1="3" y1="3" x2="9" y2="9"></line>
          <polyline points="5 15 9 15 9 19"></polyline>
          <line x1="3" y1="21" x2="9" y2="15"></line>
          <polyline points="19 9 15 9 15 5"></polyline>
          <line x1="15" y1="9" x2="21" y2="3"></line>
          <polyline points="19 15 15 15 15 19"></polyline>
          <line x1="15" y1="15" x2="21" y2="21"></line>
        </svg>
      `,this)})),Jt=(qt("sketch-pad"),Ut()),Kt=Gt(),Qt=Wt(),Xt=Vt(),te=Yt(),ee=(0,d.EG)({props:{marginId:d.p.req(),onchangeMarginMode:d.p.opt()}})((function*(t){var e;const n=this.attachShadow({mode:"open"});let i=Pt,a="hide";const l=(s=t.marginId,r.Z.$.pipe((0,Tt.Z)(Et),(0,m.h)((t=>t.payload.id===s)))).subscribe((t=>{i=function(t,e){switch(e.type){case Et.LOAD_DONE:return{data:e.payload,isLoading:!1,error:null};case Et.LOAD_FAIL:return Object.assign(Object.assign({},t),{isLoading:!1,error:e.payload.error});case Et.SAVE_FAIL:return Object.assign(Object.assign({},t),{error:e.payload.error});default:return t}}(i,t),this.next()}));var s;const d=t=>()=>{switch(t){case"expand":n.host.style.position="absolute";break;case"full":"requestFullscreen"in(e=n.host)&&null==document.fullscreenElement?e.requestFullscreen():"webkitRequestFullscreen"in e&&e.webkitRequestFullscreen();break;default:n.host.style.position="relative","exitFullscreen"in document&&null!=document.fullscreenElement?document.exitFullscreen():"webkitExitFullscreen"in document&&document.webkitExitFullscreen()}var e;a=t,this.dispatchEvent(new CustomEvent("changeMarginMode",{detail:{mode:a}})),this.next()};try{for(;;){t.marginId!==(null===(e=i.data)||void 0===e?void 0:e.id)&&Lt(t.marginId);let r=c.dy``;switch(a){case"hide":r=c.dy`
              <button class="btn btn_icon btn__first" @click=${d("collapse")}>
                ${Qt({isOn:!1})}
              </button>
            `;break;case"collapse":r=c.dy`
              <button class="btn btn_icon btn__first" @click=${d("hide")}>
                ${Qt({isOn:!0})}
              </button>
              <button class="btn btn_icon btn__second" title="expand" @click=${d("expand")}>
                ${Jt({})}
              </button>
              <button class="btn btn_icon btn__third" title="full" @click=${d("full")}>
                ${Xt({})}
              </button>
            `;break;case"expand":r=c.dy`
              <button class="btn btn_icon btn__first" title="expand" @click=${d("collapse")}>
                ${Kt({})}
              </button>
              <button class="btn btn_icon btn__second" title="full" @click=${d("full")}>
                ${Xt({})}
              </button>
            `;break;case"full":r=c.dy`
              <button class="btn btn_icon btn__first" title="minimize" @click=${d("collapse")}>
                ${te({})}
              </button>
            `}t=yield(0,c.sY)(c.dy`
          <style>${o(8608)}</style>

          ${r}

          ${i.data?c.dy`<sketch-pad style=${u.iv`
                visibility: ${"hide"!==a?"visible":"hidden"};
              `} .data=${i.data} .mode=${a}></sketch-pad>`:""}
        `,n)}}finally{l.unsubscribe()}}));const oe=String.raw,ne=(0,i.EG)({props:{label:String,value:String,isFolded:Boolean,change:{}},shadow:{mode:"open"},render:n.sY})((function(t){const[e,o]=(0,i.eJ)(t.isFolded);(0,i.d4)((()=>{o(t.isFolded)}),[t.isFolded]);const r=(0,i.I4)((()=>{o((t=>!t)),t.change(t.value,!e)}),[e,o,t]);return(0,i.d4)((()=>{const t=oe`
      :host {
        display: inline-flex;
        align-items: center;
        flex-direction: row;
        position: absolute;
        right: 100%;
        font-family: var(--font-family);
      }
      button,
      label {
        cursor: pointer;
        border: none;
        background-color: transparent;
      }
      button:focus {
        outline: 0;
      }
      .icon-tabler,
      label {
        stroke: var(--border-color);
        color: var(--border-color);
        transition: 0.2s;
      }

      :host(:hover) .icon-tabler {
        stroke: var(--dark-grey);
      }
      :host(:hover) label {
        color: var(--dark-grey);
      }
    `,e=null==this?void 0:this.shadowRoot;if(null!=e&&null!=e.adoptedStyleSheets){const o=new CSSStyleSheet;o.replaceSync(t),e.adoptedStyleSheets=[o]}}),[]),n.dy`
      <label for=${t.value}>${t.label}</label>
      <button id=${t.value} @click=${r}>
        ${n.YP`
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon icon-tabler icon-tabler-chevron-left"
            width="44"
            height="44"
            viewBox="0 0 24 24"
            stroke-width="0.5"
            stroke="#9e9e9e"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <polyline points=${e?"9 6 15 12 9 18":"6 9 12 15 18 9"} />
          </svg>        
        `}
      </button>
    `})),ie=(0,n.XM)(((t,e)=>(null!=e.current&&(e.current.setValue(t),e.current.commit()),o=>{e.current=o,e.current.setValue(t)}))),re=(0,i.NG)({render:ie})((()=>n.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file-plus" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
      <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
      <line x1="12" y1="11" x2="12" y2="17"></line>
      <line x1="9" y1="14" x2="15" y2="14"></line>
    </svg>
  `)),ae=(0,i.NG)({render:ie})((()=>n.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
      <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
      <path d="M10 12l4 4m0 -4l-4 4"></path>
    </svg>
  `)),le={CREATE_MARGIN:Symbol("[PAGE_ACTION] CREATE_MARGIN"),CREATE_MARGIN_DONE:Symbol("[PAGE_ACTION] CREATE_MARGIN_DONE"),CREATE_MARGIN_FAIL:Symbol("[PAGE_ACTION] CREATE_MARGIN_FAIL")};var se=o(4072),ce=o(5631),de=o(1410),ue=o(3068),pe=o(3507),he=o(4035),ge=o(486),fe=function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function l(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,l)}s((n=n.apply(t,e||[])).next())}))};function me(t){return t.pipe((0,ue.b)((t=>{r.Z.dispatch({type:a.PAGE_SAVE,payload:{pageId:t.pageId,draftId:t.draftId}})})),(0,pe.b)(_t.v.isDevMode?3e3:1e4),(0,ue.b)((t=>{r.Z.dispatch({type:a.PAGE_SAVING,payload:{pageId:t.pageId,draftId:t.draftId}})})),(0,he.w)((t=>(0,se.D)(function(t,e,o){return fe(this,void 0,void 0,(function*(){return yield(0,xt.G)((()=>fe(this,void 0,void 0,(function*(){try{return yield(0,b.S)().updatePageById({id:t,content:o,updated_at:(new Date).toISOString()}),{pageId:t,draftId:e,content:o}}catch(e){throw{pageId:t,error:e}}}))))}))}(t.pageId,t.draftId,t.content)).pipe((0,ue.b)((t=>{r.Z.dispatch({type:a.PAGE_SAVE_DONE,payload:t})})),(0,ge.K)((e=>(r.Z.dispatch({type:a.PAGE_SAVE_FAIL,payload:{draftId:t.draftId,pageId:t.pageId,error:e}}),ce.E)))))))}function be(t){return t.pipe((0,he.w)((t=>(0,de.P)((()=>fe(this,void 0,void 0,(function*(){return(0,xt.G)((()=>fe(this,void 0,void 0,(function*(){var e;const{insert_page_one:o,update_page:n}=yield(0,b.S)().addPageToDraft({draft_id:t.draftId,order:t.order,created_at:(new Date).toISOString()});if(null==o)throw new Error("newPage == null");const i=null!==(e=null==n?void 0:n.returning)&&void 0!==e?e:[];return{draftId:t.draftId,newPage:o,updatedPages:i}}))))})))))),(0,ue.b)((t=>{const{draftId:e,updatedPages:o,newPage:n}=t;r.Z.dispatch({type:a.DRAFT_ADD_PAGE_DONE,payload:{draftId:e,newPage:Object.assign(Object.assign({},n),{content:null==n?void 0:n.content,draftId:e}),updatedPages:o}})})))}function ve(t){return t.pipe((0,he.w)((t=>(0,de.P)((()=>fe(this,void 0,void 0,(function*(){return(0,xt.G)((()=>fe(this,void 0,void 0,(function*(){var e;const{update_page_by_pk:o,update_page:n}=yield(0,b.S)().deletePage({id:t.pageId,ended_at:(new Date).toISOString(),draft_id:t.draftId,order:t.order}),i=null!==(e=null==n?void 0:n.returning)&&void 0!==e?e:[],r={id:null==o?void 0:o.id,order:t.order};return{draftId:t.draftId,deletedPage:r,updatedPages:i}}))))})))))),(0,ue.b)((t=>{r.Z.dispatch({type:a.DRAFT_DELETE_PAGE_DONE,payload:{draftId:t.draftId,deletedPage:t.deletedPage,updatedPages:t.updatedPages}})})))}var ye=o(211),_e=o(4370);function xe(t,e){switch(e.type){case le.CREATE_MARGIN_DONE:return null!=t.data&&(t.data.margins=[{id:e.payload.marginId},...t.data.margins]),t;default:return t}}const we=(0,i.NG)({render:ie})((()=>n.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-writing" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"></path>
      <path d="M16 7h4"></path>
      <path d="M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"></path>
    </svg>
  `));function ke(t){const[e,o]=(0,i.eJ)();return(0,i.d4)((()=>{const e=new ye.xQ;return o([t(e),t=>e.next(t)]),()=>e.unsubscribe()}),[]),e}function Ae(){const[t]=(0,i.eJ)((()=>{let t;return{get current(){var e;return null===(e=null==t?void 0:t.committer)||void 0===e?void 0:e.element},ref:(0,n.XM)((()=>e=>{t=e}))}}));return t}var Ee=o(7072);const Se=(0,i.EG)({props:{editor:{},className:String,tippyOptions:{},pluginKey:{type:String,default:Ee.NM.options.pluginKey},shouldShow:{type:{},default:null}},render:n.sY})((function(t){const[e,o]=(0,i.eJ)(0),r=Ae(),[a,l]=(0,i.eJ)(null);return(0,i.d4)((()=>{console.log("useEffect bubbleMenuElement"),cancelAnimationFrame(e);const{editor:n,tippyOptions:i}=t;o(requestAnimationFrame((()=>{null!=r.current&&n.registerPlugin((0,Ee.q3)({editor:n,element:r.current,pluginKey:t.pluginKey,shouldShow:t.shouldShow}))})));const a=new ye.xQ,s=({transaction:t})=>{t.steps.length>0?l(Pe(n)):t.selection.empty?l(null):a.next()};return n.on("transaction",s),a.pipe((0,pe.b)(700)).subscribe((t=>{l(Pe(n))})),()=>{console.log("DESTROY bubbleMenuElement"),a.unsubscribe(),n.off("transaction",s),cancelAnimationFrame(e),n.unregisterPlugin(Ee.NM.options.pluginKey)}}),[r.current]),n.dy`<div .ref=${r.ref()} class=${t.className} style=${u.iv`
        visibility: 'hidden';
      `}>
      ${a}
    </div>`})),Le=["figure"],Te=["topicTitle"];function Pe(t){const e=t.state.selection;return e instanceof H.qv&&Le.includes(e.node.type.name)||e instanceof H.Bs&&(Te.includes(e.$from.parent.type.name)||Te.includes(e.$to.parent.type.name))?null:n.dy`
      <button @click=${()=>t.chain().focus().toggleBold().run()} class=${t.isActive("bold")?"is-active":""}>
        bold
      </button>
      <button @click=${()=>t.chain().focus().toggleItalic().run()} class=${t.isActive("italic")?"is-active":""}>
        italic
      </button>
      <button @click=${()=>t.chain().focus().toggleStrike().run()} class=${t.isActive("strike")?"is-active":""}>
        strike
      </button>
      <button @click=${()=>t.chain().focus().toggleHighlight().run()} class=${t.isActive("highlight")?"is-active":""}>
        highlight
      </button>
      <button @click=${()=>{var e;const o=null!==(e=window.prompt("URL"))&&void 0!==e?e:"";t.chain().focus().toggleLink({href:o}).run()}} class=${t.isActive("link")?"is-active":""}>
        link
      </button>
      <button @click=${()=>t.chain().focus().toggleBlockquote().run()} class=${t.isActive("blockquote")?"is-active":""}>
        blockquote
      </button>
      <button @click=${()=>t.chain().focus().toggleAside().run()} class=${t.isActive("aside")?"is-active":""}>
        aside
      </button>

      <button @click=${()=>t.chain().focus().toggleHeading({level:2}).run()} class=${t.isActive("heading",{level:2})?"is-active":""}>
        h2
      </button>
      <button @click=${()=>t.chain().focus().toggleHeading({level:3}).run()} class=${t.isActive("heading",{level:3})?"is-active":""}>
        h3
      </button>
      <button @click=${()=>t.chain().focus().toggleHeading({level:4}).run()} class=${t.isActive("heading",{level:4})?"is-active":""}>
        h4
      </button>
      <button @click=${()=>t.chain().focus().toggleHljsCodeBlock().run()} class=${t.isActive("hljsCodeBlock")?"is-active":""}>
        ${"<>"}
      </button>
    `}var Me=o(9303),$e=o.n(Me),Ne=o(8895),Ce=o.n(Ne),Be=o(3691),Ie=o(5039),De=o(9244),ze=o(1428),Ze=o(7443),Oe=o(2415),je=o(8952),Re=o(1812),He=o(8926),Fe=o(9731),qe=o(7466),Ue=o(9296),Ge=o(9022),We=o(6885),Ve=o(6681),Ye=o(3164),Je=o(9733),Ke=o(3881),Qe=o(3041),Xe=o(1888),to=o(5622),eo=o(3549),oo=o(6136),no=o(6301),io=o(4099);let ro=navigator.userAgent.toLowerCase(),ao=(/opera/i.test(ro)||/opr/i.test(ro),/msie/i.test(ro)&&!/opera/i.test(ro)||/trident\//i.test(ro)||/edge/i.test(ro),/edge/i.test(ro)&&/opera/i.test(ro),/firefox/i.test(ro),/chrome/i.test(ro)&&/edge/i.test(ro),!/chrome/i.test(ro)&&/webkit|safari|khtml/i.test(ro),/iphone/i.test(ro),/ipod/i.test(ro),/ipad/i.test(ro),/android/i.test(ro),/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(ro)),lo=/iphone|ipod|ipad/i.test(ro);/opera mini|opera mobi/i.test(ro),/opera mini/i.test(ro),/mac/i.test(ro);function so(t,e,o=!0){qe.LinkBlot.blotName="link",qe.LinkBlot.tagName="a",qe.LinkBlot.showLinkTooltip=e=>{t&&t.showLinkTooltip(e,e.value,(0,oo.isEdit)(),i)},qe.LinkBlot.hideLinkTooltip=()=>t&&t.hideLinkTooltip(i),Ue.MyQuill.register(qe.LinkBlot,!0),Ve.FigureBlot.blotName="blockFigure",Ve.FigureBlot.tagName="figure",Ve.FigureBlot.quillSetSelection=(t,e=0)=>i.setSelection(t,e,Ie.Z.sources.USER),Ve.FigureBlot.quillDeleteText=(t,e,o=Ie.Z.sources.USER)=>i.deleteText(t,e,o),Ve.FigureBlot.quillInsertText=(t,e)=>i.insertText(t,e,Ie.Z.sources.USER),Ve.FigureBlot.draftSave=()=>(0,oo.draftSave)(n,i),Ue.MyQuill.register(Ve.FigureBlot,!0),Ue.MyQuill.register(io.DividerBlot),Ue.MyQuill.register({"modules/syntax":to.InsSyntaxModule,"formats/bold":Je.Z,"formats/italic":Ke.Z,"formats/indent":Ze.a,"formats/list":ze.ListContinuer,"formats/list-item":De.H,"formats/code":Oe.E,"formats/strike":je.Z},!0);var n=!1;ao&&document.body.classList.add("mobile");var i=new Ue.MyQuill(e,{scrollingContainer:"html, body",readOnly:!0,modules:{syntax:{highlight:t=>no.default.highlightAuto(t).value},clipboard:{matchers:[r("h2",{blockHeader:!0}),r("h5",{blockSubheader:!0}),r("h6",{blockSubheader:!0}),["img",function(t,e){return t.src&&(0,oo.sanitize)(t.src,["http","https","data"])?(new(Ce())).insert({blockFigure:{image:t.src,caption:t.alt||""}}):new(Ce())}],["video",function(t,e){return t.src&&(0,oo.sanitize)(t.src,["http","https","data"])?(new(Ce())).insert({blockFigure:{video:t.src}}):new(Ce())}],["br",function(t,e){return console.log("modules.clipboard.matchers.br"),t.classList.contains("inline")?(new(Ce())).insert({textBreak:!0}):e}]]},keyboard:{bindings:{"required enter":{key:Re.Z.keys.ENTER,collapsed:!0,shiftKey:null,format:["blockTitle","blockDescription"],suffix:/^$/,handler:function(t,e){console.log("keyboard.bindings.required_enter.handler");let[o]=this.quill.scroll.descendant(Fe.FieldBlot,t.index);return!(o&&o.next&&o.next.domNode&&!o.next.domNode.textContent)||(this.quill.setSelection(o.next.offset(this.quill.scroll),0,Ie.Z.sources.USER),!1)}},"required tab prev":{key:Re.Z.keys.TAB,shiftKey:!0,handler:function(t,e){console.log("keyboard.bindings.required_tab_prev.handler");let o=null;if(t.length>0){let e=i.scroll.descendants(Be.ZP,t.index,t.length);if(1!=e.length)return!0;o=e[0]}else[o]=i.scroll.descendant(Be.ZP,t.index);if(null!=o&&null!=o.prev&&o.prev instanceof Fe.FieldBlot){let t=o.prev.offset(i.scroll),e=o.prev.length();return i.setSelection(t,e>1?e:0,Ie.Z.sources.USER),!1}return!0}},"required tab next":{key:Re.Z.keys.TAB,shiftKey:!1,handler:function(t,e){console.log("keyboard.bindings.required_tab_next.handler");let o=null;if(t.length>0){let e=i.scroll.descendants(Be.ZP,t.index,t.length);if(1!=e.length)return!0;o=e[0]}else[o]=i.scroll.descendant(Be.ZP,t.index);if(null!=o&&o instanceof Fe.FieldBlot&&null!=o.next){let t=o.next.offset(i.scroll);if(o.next instanceof Fe.FieldBlot){let e=o.next.length();i.setSelection(t,e>1?e:0,Ie.Z.sources.USER)}else i.setSelection(t,0,Ie.Z.sources.USER);return!1}return!0}},"no tab":{key:Re.Z.keys.TAB,shiftKey:null,handler:function(t,e){return console.log("keyboard.bindings.no_tab.handler"),!1}},"detect embed":{key:Re.Z.keys.ENTER,collapsed:!0,handler:function(e,o){console.log("keyboard.bindings.detect_embed.handler");let[n,r]=i.scroll.line(e.index);if(n){let o,a=n.domNode.textContent.substr(0,r);if(o=a.match(/(^|\s)(https?:\/\/\S+)$/)){let l=o[2];if(i.scroll.descendants(qe.LinkBlot,e.index-l.length,l.length).length||i.formatText(e.index-l.length,l.length,"link",l,Ie.Z.sources.USER),!a.substr(0,r-l.length).trim().length&&"P"==n.domNode.tagName){let e=s(l);if(e){let o=n.offset(i.scroll);return i.updateContents((new(Ce())).retain(o).delete(a.length).insert({blockFigure:e}),Ie.Z.sources.USER),t&&t.hideBlocksTooltip(),!1}}}}return!0}},"divider autofill":{key:Re.Z.keys.ENTER,collapsed:!0,prefix:/^([-*])\1{2,}$/,handler:function(t,e){console.log("keyboard.bindings.divider_autofill.handler");let[o,n]=i.scroll.line(t.index);if(o&&"P"==o.domNode.tagName){let t=o.offset(i.scroll),e=(new(Ce())).retain(t).delete(o.length()).insert({blockDivider:!0});return o.next||e.insert("\n"),i.updateContents(e,Ie.Z.sources.USER),!1}return!0}},break:{key:Re.Z.keys.ENTER,shiftKey:!0,handler:l.bind(null,!0)},enter:{key:Re.Z.keys.ENTER,handler:l.bind(null,!1)},"detect link":{key:" ",collapsed:!0,handler:function(t){console.log("detectLinkHandler",t);let[e,o]=i.scroll.line(t.index);if(e){let n,r=e.domNode.textContent.substr(0,o);if(n=r.match(/(^|\s)((?:https?|tg):\/\/\S+|www\.\S+)$/)){let e=n[2],o=e.length;"www."==e.substr(0,4)&&(e="http://"+e),i.scroll.descendants(qe.LinkBlot,t.index-o,o).length||i.formatText(t.index-o,o,"link",e,Ie.Z.sources.USER)}}return!0}},"cancel placeholder":{key:Re.Z.keys.ESCAPE,handler:function(t,e){return console.log("keyboard.bindings.cancel_placeholder.handler"),uo(),this.quill.updateSelection(Ie.Z.sources.USER),!0}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{list:!1,"code-block":!1,blockquote:!1,header:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(this.quill.scroll.query&&null==this.quill.scroll.query("list"))return!0;const{length:o}=e.prefix,[n,i]=this.quill.getLine(t.index);if(i>o)return!0;let r;switch(e.prefix.trim()){case"[]":case"[ ]":r="unchecked";break;case"[x]":r="checked";break;case"-":case"*":r="bullet";break;default:r={type:"ordered",start:Number(e.prefix.slice(0,-1))-1}}this.quill.insertText(t.index," ",Ie.Z.sources.USER),this.quill.history.cutoff(),console.log("keyboard.bindings.list_autofill.handler",t,e);const a=(new(Ce())).retain(t.index-i).delete(o+1).retain(n.length()-2-i).retain(1,{list:r,start:r.start});console.log("keyboard.bindings.list_autofill.handler",a);const l=this.quill.updateContents(a,Ie.Z.sources.USER);return console.log("keyboard.bindings.list_autofill.handler",l),this.quill.history.cutoff(),this.quill.setSelection(t.index-o,Ie.Z.sources.SILENT),!1}},"pre wrap":{key:192,collapsed:!0,format:{"code-block":!1},prefix:/^``$/,offset:2,handler:function(t,e){console.log("keyboard.bindings.pre_wrap.handler");let o=e.prefix.length,n=t.index-o;this.quill.scroll.deleteAt(n,o),this.quill.formatLine(n,1,"code-block",!0,Ie.Z.sources.USER),this.quill.setSelection(n,Ie.Z.sources.SILENT)}},code:{key:192,handler:function(t,e){if(console.log("keyboard.bindings.code.handler",!e.format),!e.collapsed){let o=i.scroll.descendants(Be.ZP,t.index,t.length);if(o.length>1||1==o.length&&o[0]instanceof eo.dn)return this.quill.format("code-block",!e.format["code-block"],Ie.Z.sources.USER),!1;if(i.scroll.descendants(He.BreakBlot,t.index,t.length).length)return this.quill.format("code-block",!e.format["code-block"],Ie.Z.sources.USER),!1}if(e.collapsed&&!e.format.code&&!/\s$/.test(e.prefix))return!0;this.quill.format("code",!e.format.code,Ie.Z.sources.USER)}},"figure delete":{key:Re.Z.keys.BACKSPACE,collapsed:!0,offset:0,handler:function(t,e){console.log("keyboard.bindings.figure_delete.handler");let[o,n]=i.scroll.line(t.index);return!(o&&o.prev&&o.prev instanceof Ve.FigureBlot)||(e.empty&&i.deleteText(t.index,1,Ie.Z.sources.USER),i.setSelection(o.prev.offset(i.scroll)),!1)}},"field backspace":{key:Re.Z.keys.BACKSPACE,collapsed:!0,offset:0,handler:function(t,e){console.log("keyboard.bindings.field_backspace.handler");let[o,n]=i.scroll.line(t.index);return!(o&&o.prev&&o.prev instanceof Fe.FieldBlot&&o.domNode.textContent.length>0)}},strikethrough:{key:"X",shortKey:!0,shiftKey:!0,handler:function(t,e){i.formatText(t,"strike",!e.format.strike)}}}}}});function r(t,e){return[t,function(t,o){return o.compose((new(Ce())).retain(o.length(),e))}]}function a(t){let e=function(t){let[e,o]=i.scroll.line(t);return i.getText(t,e.length()-o)}(t);return!e||"\n"==e}function l(t,e,o){console.log("breakHandler",t,e,o);let n,r=e.index;e.length>0&&i.scroll.deleteAt(r,e.length);let l=a(r),s=!1;return[n]=i.scroll.descendant(He.BreakBlot,r),n?(!n.prev||n.prev instanceof He.BreakBlot)&&(i.scroll.deleteAt(--r,1),s=!0):([n]=i.scroll.descendant(He.BreakBlot,r-1),n&&(i.scroll.deleteAt(--r,1),s=!0)),[n]=i.scroll.descendant(Ge.SingleLineBlot,r),n||s||!t?(i.insertText(r,"\n",Ie.Z.sources.USER),i.setSelection(++r,0,Ie.Z.sources.USER),(o.format.blockHeader||o.format.blockSubheader||o.format.blockBlockquote||o.format.blockPullquote)&&l&&i.formatLine(r,1,{blockHeader:!1,blockSubheader:!1,blockBlockquote:!1,blockPullquote:!1},Ie.Z.sources.USER)):(i.insertEmbed(r,"textBreak",!0,Ie.Z.sources.USER),[n]=i.scroll.descendant(He.BreakBlot,r),!n||n.next||n.prev&&n.prev instanceof He.BreakBlot||(i.insertEmbed(++r,"textBreak",!0,Ie.Z.sources.SILENT),i.setSelection(r,0,Ie.Z.sources.SILENT))),!1}function s(t){let e;if((e=t.match(/^(https?):\/\/(www\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/i))||(e=t.match(/^(https?):\/\/(www\.)?youtu\.be\/([a-zA-Z0-9_-]+)/i)))return{embed:"/embed/youtube?url="+encodeURIComponent(t)};if(e=t.match(/^(https?):\/\/(www\.)?vimeo\.com\/(\d+)/i))return{embed:"/embed/vimeo?url="+encodeURIComponent(t)};if(e=t.match(/^(https?):\/\/(www\.|mobile\.)?twitter\.com\/(.+)\/status\/(\d+)/i))return{embed:"/embed/twitter?url="+encodeURIComponent(t)};if(e=t.match(/^(https?):\/\/(t\.me|telegram\.me|telegram\.dog)\/([a-zA-Z0-9_]+)\/(\d+)/i))return{embed:"/embed/telegram?url="+encodeURIComponent(t)};if(e=t.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/))return"video/"==e[1].substr(0,6)?{video:t}:{image:t};if(e=t.match(/^(https?):\/\/\S+/i)){let o=document.createElement("a");if(o.href=t,o.pathname.match(/\.(jpe?g|png|gif|mp4)$/i))return"mp4"==e[1]?{video:t}:{image:t}}return!1}function c(t){t.scroll.descendants(Be.ZP,0,t.scroll.length()).forEach((t=>{if(t.domNode.hasAttribute("data-placeholder")){let e=t.domNode.textContent;t.domNode.classList.toggle("empty",!e)}}))}function d(t){if(o){let[e,o]=t.scroll.lines();if(e instanceof Be.i2)t.updateContents((new(Ce())).insert("\n",{blockTitle:!0}).insert("\n",{blockDescription:!0}),Ie.Z.sources.SILENT);else if(e instanceof We.TitleBlot||t.formatLine(0,1,{blockTitle:!0},Ie.Z.sources.SILENT),o){if(o instanceof Be.i2){let e=o.offset(t.scroll);t.updateContents((new(Ce())).retain(e).insert("\n",{blockDescription:!0}),Ie.Z.sources.SILENT)}else if(!(o instanceof Ye.DescriptionBlot)){let e=o.offset(t.scroll);t.formatLine(e,1,{blockDescription:!0},Ie.Z.sources.SILENT)}}else{let e=t.scroll.length();t.updateContents((new(Ce())).retain(e).insert("\n",{blockDescription:!0}),Ie.Z.sources.SILENT)}let[,,n]=t.scroll.lines();if(n){let e=n.offset(t.scroll),o=t.scroll.length()-e;t.scroll.descendants(Fe.FieldBlot,e,o).forEach((e=>{let o=e.offset(t.scroll),n=e.length(),i=e.constructor.blotName;t.formatText(o,n,i,!1,Ie.Z.sources.SILENT)}))}else{let e=t.scroll.length();t.insertText(e,"\n",Ie.Z.sources.SILENT)}}const n=t.scroll.lines();e.querySelectorAll("[data-placeholder]").forEach((t=>t.removeAttribute("data-placeholder")));(o?3===n.length:1===n.length)&&n.forEach(((t,e)=>{if("P"==t.domNode.tagName){(o?2===e:0==e)&&t.domNode.setAttribute("data-placeholder","The page content...")}}))}function u(t){let e=t.querySelector(".prompt_input"),o=t.querySelector(".close");e.onkeydown=null,e.onblur=null,o.onclick=null,t.style.display="",t.classList.remove("tooltip_prompt"),i.focus()}return t&&i.addContainer(t),i.on(Ie.Z.events.TEXT_CHANGE,(function(){i.getSelection();d(i),c(i),uo(),(0,oo.draftSave)(n,i)})),i.on(Ie.Z.events.SCROLL_OPTIMIZE,(function(t){t.forEach((t=>{if("childList"==t.type&&!t.addedNodes.length&&t.removedNodes.length){let e=t.previousSibling,o=t.nextSibling;if(!o&&e&&"BR"==e.tagName&&"inline"==e.className){let e=document.createElement("br");e.className="inline",t.target.appendChild(e)}else!o||!e||"BR"==e.tagName&&"inline"==e.className||"BR"!=o.tagName||"inline"!=o.className||o.nextSibling||o.parentNode&&o.parentNode.removeChild(o)}}))})),i.scroll.domNode.setAttribute("dir","auto"),document.addEventListener("click touchstart",(function(e){let o=e.target;for(;o;){if(o===i.container)return;o=o.parentNode}t&&t.hideFormatTooltip(i),t&&t.hideBlocksTooltip()})),d(i),c(i),t&&(t.$bold_button.onclick=t=>{console.log("$bold_button.onclick");let e=t.target.classList.contains("active");t.preventDefault(),console.log("$bold_button.onclick",!e),i.format("bold",!e),console.log("$bold_button.onclick",i.getSelection(!0)),i.updateSelection(Ie.Z.sources.API)}),t&&(t.$italic_button.onclick=t=>{let e=t.target.classList.contains("active");t.preventDefault(),i.format("italic",!e),i.updateSelection(Ie.Z.sources.API)}),t&&(t.$link_button.onclick=e=>{let o=e.target.classList.contains("active");e.preventDefault();var n=i.getSelection(!0);if(o){i.scroll.descendants(qe.LinkBlot,n.index,n.length).forEach((t=>{let e=t.offset(i.scroll),o=t.length();i.formatText(e,o,"link",!1)})),t&&co(n,i,t)}else t&&function(t,e,o){let n=t.querySelector(".prompt_input"),i=t.querySelector(".close");n.value="",n.setAttribute("placeholder",e),n.onkeydown=e=>{let i=e.which||e.keyCode;if(27==i)u(t);else if(13==i){let i=n.value;i&&(o&&o(i),e.preventDefault()),u(t)}},n.onblur=()=>{u(t)},i.onclick=()=>{u(t)},t.style.display="",t.classList.add("tooltip_prompt"),n.focus()}(t.$tl_tooltip,"Paste or type a link...",(function(e){"#"!=(e=e.trim()).substr(0,1)&&"/"!=e.substr(0,1)&&"http://"!=e.substr(0,7)&&"https://"!=e.substr(0,8)&&"tg://"!=e.substr(0,5)&&"mailto:"!=e.substr(0,7)&&(e=e.indexOf("@")>0?"mailto:"+e:"http://"+e),i.focus(),i.format("link",e),co(n,i,t)}))}),t&&(t.$header_button.onclick=t=>{let e=t.target.classList.contains("active");t.preventDefault();let o=i.getSelection(!0);i.format("blockHeader",!e),i.scroll.descendants(Qe.HeaderBlot,o.index,o.length).forEach((t=>{let e=t.offset(i.scroll),o=t.length();i.formatText(e,o,{bold:!1,italic:!1,code:!1},Ie.Z.sources.SILENT)})),i.updateSelection(Ie.Z.sources.API)}),t&&(t.$subheader_button.onclick=t=>{let e=t.target.classList.contains("active");t.preventDefault();let o=i.getSelection(!0);i.format("blockSubheader",!e),i.scroll.descendants(Xe.SubheaderBlot,o.index,o.length).forEach((t=>{let e=t.offset(i.scroll),o=t.length();i.formatText(e,o,{bold:!1,italic:!1,code:!1},Ie.Z.sources.SILENT)})),i.updateSelection(Ie.Z.sources.API)}),t&&(t.$quote_button.onclick=t=>{let e=t.target,o=e.classList.contains("active"),n=e.classList.contains("pullquote");t.preventDefault();i.getSelection(!0);o?i.format("blockPullquote",!n):i.format("blockBlockquote",!0),i.updateSelection(Ie.Z.sources.API)}),t&&(t.$strikeButton.onclick=t=>{let e=t.target.classList.contains("active");t.preventDefault(),i.format("strike",!e),i.updateSelection(Ie.Z.sources.API)}),t&&(t.$image_button.onclick=()=>{let t=i.container.querySelector("input.ql-image[type=file][data-status=ready]");null==t&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",lo?"image/gif, image/jpeg, image/jpg, image/png":"image/gif, image/jpeg, image/jpg, image/png, video/mp4"),t.classList.add("ql-image"),t.addEventListener("change",(()=>{if(t&&null!=t.files&&null!=t.files[0]){var e=t.files[0];const o=function(){(0,oo.showError)("File too big (up to 5 MB allowed)")},n=5242880;!function(t,e){if("image/jpg"==t.type||"image/jpeg"==t.type)return $e()(t,(o=>{if("error"===o.type)e(t);else if(o.toBlob)o.toBlob((function(t){e(t)}),t.type);else{var n=o.toDataURL(t.type),i={type:t.type,base64_data:n.split(",")[1]};e((0,oo.uploadDataToBlob)(i))}}),{canvas:!0,orientation:!0});e(t)}(e,(e=>{if(e.size>n)return o&&o();var r=new FileReader;r.onload=function(e){if(e&&null!==e.target){let o=s(e.target.result);if(o){let t=i.getSelection(!0);i.updateContents((new(Ce())).retain(t.index).delete(t.length).insert({blockFigure:o}),Ie.Z.sources.USER)}else(0,oo.showError)("Invalid file format");t.value="",t.setAttribute("data-status","ready")}},r.readAsDataURL(e)}))}})),i.container.appendChild(t)),t.setAttribute("data-status","busy"),t.click()}),t&&(t.$embed_button.onclick=e=>{let o=i.getSelection(!0),[n]=i.scroll.line(o.index);const r=n.domNode;if(n){r.textContent||(r.setAttribute("data-placeholder","Paste a YouTube, Vimeo or Twitter link, and press Enter"),r.classList.add("placeholder_once","empty"),t.hideBlocksTooltip())}}),window.addEventListener("scroll resize",(()=>{t&&t.tooltipUpdatePosition(t.$tl_tooltip,null,t.formatTTOptions,i),t&&t.tooltipUpdatePosition(t.$tl_link_tooltip,null,t.linkTTOptions,i)})),i}function co(t,e,o){let n=null==t?{}:e.getFormat(t),i=!!n.blockDescription,r=!(!n.blockHeader&&!n.blockSubheader),a=!!n["code-block"];if(o.$bold_button.classList.toggle("active",!!n.bold),o.$bold_button.classList.toggle("disabled",i||r||a),o.$italic_button.classList.toggle("active",!!n.italic),o.$italic_button.classList.toggle("disabled",i||r||a),o.$header_button.classList.toggle("active",!!n.blockHeader),o.$header_button.classList.toggle("disabled",i),o.$subheader_button.classList.toggle("active",!!n.blockSubheader),o.$subheader_button.classList.toggle("disabled",i),o.$quote_button.classList.toggle("active",!(!n.blockBlockquote&&!n.blockPullquote)),o.$quote_button.classList.toggle("pullquote",!!n.blockPullquote),o.$quote_button.classList.toggle("disabled",i),o.$strikeButton.classList.toggle("active",!!n.strike),o.$strikeButton.classList.toggle("disabled",i),null!=t){let n=e.scroll.descendants(qe.LinkBlot,t.index,t.length);o.$link_button.classList.toggle("active",!!n.length)}else o.$link_button.classList.toggle("active",!1);o.$link_button.classList.toggle("disabled",a)}function uo(){const t=document.querySelector(".placeholder_once");null!==t&&(t.removeAttribute("data-placeholder"),t.classList.remove("placeholder_once","empty"))}var po=o(8079),ho=o(9691);Se("inscriptum-redactor-bubble-menu");const go=(0,i.EG)({props:{content:{type:{},default:null},cbOnUpdateContent:{type:{},default:()=>{}},isTitle:Boolean,disable:Boolean},render:n.sY})((function(t){const[e,r]=(0,i.eJ)(0),[a,l]=(0,i.eJ)(),s=Ae();return(0,i.d4)((()=>(cancelAnimationFrame(e),r(requestAnimationFrame((()=>{const e=s.current;if(null!=e){let o=null;o=null!=t.content&&"object"==typeof t.content&&"ops"in t.content?function(t){const e=document.createElement("div"),o=document.createElement("template");o.append(e),document.body.append(o);const n=so(null,e);Fe.FieldBlot,po.BlockquoteBlot,ho.PullquoteBlot,eo.dn,De.H,We.TitleBlot,Be.ZP,n.setContents(t);const i=n.root.innerHTML;return e.remove(),o.remove(),"function"==typeof n.destroy&&n.destroy(),i}(t.content):t.content,l(function(t,e,o=!1,n){return new _.ML({element:t,content:e,onUpdate:null==n?void 0:n.onUpdate,extensions:yt(o)})}(e,o,t.isTitle,{onUpdate:({editor:e})=>{t.cbOnUpdateContent(e.getJSON())}}))}}))),()=>{var t,o;console.log("DESTROY redactorElement"),null===(o=null===(t=s.current)||void 0===t?void 0:t.firstChild)||void 0===o||o.remove(),cancelAnimationFrame(e),null!=a&&a.destroy()})),[s.current,t.content,t.isTitle,t.cbOnUpdateContent]),null!=a&&(a.setEditable(!t.disable),console.log(a,"editor?.setEditable(false)")),n.dy`<div class="redactor">
      <style>${o(5257)}</style>
      <article .ref=${s.ref()} class="redactor__article"></article>
      ${null!=a&&n.dy`<inscriptum-redactor-bubble-menu .editor=${a}></inscriptum-redactor-bubble-menu>`}
    </div>`})),fo=String.raw,mo=(go("inscriptum-redactor"),ee("inscriptum-margin"),ne("inscriptum-folding"),re()),bo=ae(),vo=we(),yo=(0,i.EG)({props:{page:{type:{}}},render:n.sY})((function(t){const[e,o]=(0,i._Y)(xe,{data:t.page,isLoading:!1});let[r,a]=(0,i.eJ)(t.page.content);const[l,s]=(0,i.eJ)(t.page.isFolded),[c,d]=(0,i.eJ)("hide"),[u,p]=ke(me),[h,g]=ke(be),[f,m]=ke(ve);(0,i.d4)((()=>{const n=function(t){const e=new ye.xQ;return(0,_e.T)(e)}(t.page.id).subscribe((t=>o(t)));return n.add(u.subscribe((t=>{null!=e.data&&(e.data.content=t.content)}))),n.add(h.subscribe()),n.add(f.subscribe()),()=>{n.unsubscribe()}}),[]),(0,i.d4)((()=>{var t;null!=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.content)&&(null==r&&null!=e.data.content&&a(e.data.content),null!=e.data.isFolded&&l!==e.data.isFolded&&(e.data.isFolded||a(e.data.content)))}),[e,r,l,a,s]);const v=(0,i.I4)((t=>{null!=e.data&&(p({pageId:e.data.id,draftId:e.data.draftId,content:t}),null!=r?r.content=t.content:r=t)}),[e,p,r]),y=(0,i.I4)((t=>()=>{var o;null!=(null===(o=e.data)||void 0===o?void 0:o.draftId)&&g({draftId:e.data.draftId,order:t})}),[e.data,p]),_=(0,i.I4)((()=>{null!=e.data&&m({draftId:e.data.draftId,pageId:e.data.id,order:e.data.order})}),[e.data]),x=(0,i.I4)((()=>{var t;null!=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.id)&&function(t,e){fe(this,void 0,void 0,(function*(){return yield(0,xt.G)((()=>fe(this,void 0,void 0,(function*(){const{insert_margin_one:o}=yield(0,b.S)().createMargin({page_id:t,created_at:(new Date).toISOString()});if(null!=(null==o?void 0:o.id))return e({type:le.CREATE_MARGIN_DONE,payload:{pageId:t,marginId:o.id}}),o;e({type:le.CREATE_MARGIN_FAIL,payload:{pageId:t,error:{massage:`Can not create a new Margin for Page ${t}!`}}})}))))}))}(e.data.id,o)}),[e]),w=(0,i.I4)((t=>{d(t.detail.mode)}),[e]);if(null!=(null==e?void 0:e.data)){const t=n.dy`<div class="page__controls">
        <div>
          <button class="btn btn_icon" title="add a new page" @click=${y(e.data.order+1)}>
            ${mo({})}
          </button>
          ${e.data.order>0?n.dy`<button class="btn btn_icon" title="delete this page" @click=${_}>
              ${bo({})}
            </button>`:null}
        </div>
        <div>
          ${l?null:n.dy`<button class="btn btn_icon" title="create new margin" @click=${x}>
              ${vo({})}
            </button>`}
        </div>
      </div>`;return n.dy`
        <inscriptum-folding .label=${e.data.order>0?String(e.data.order):""} .value=${e.data.id} .isFolded=${l} .change=${(t,e)=>s(e)}></inscriptum-folding>
        ${l?n.dy`
            <span style=${fo`
                display: flex;
                justify-content: center;
                font-size: 1.6rem;
                cursor: pointer;
              `} @click=${()=>s(!1)}>
              ...
            </span>
            ${t}
          `:n.dy`<div class="row" style=${fo`
              display: flex;
              width: 100%;
              min-height: ${e.data.margins.length>0?"100vh":"auto"};
            `}>
            <div style=${fo`
                min-width: 732px;
                padding: 1rem 0 0 0;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
              `}>
              
              <inscriptum-redactor .disable=${["expand","full"].includes(c)} .content=${r} .cbOnUpdateContent=${v} .isTitle=${0===e.data.order}></inscriptum-redactor>
              ${t}
            </div>
            ${e.data.margins.length>0?n.dy`<inscriptum-margin .marginId=${e.data.margins[0].id} @changeMarginMode=${w}></inscriptum-margin>`:null}
          </div>`}
      `}})),_o=(0,d.EG)({props:{items:d.p.req()}})((function*(t){var e,i;for(;;)t=yield(0,n.sY)(n.dy`
        <style>${o(7135)}</style>
        <nav class="toc-panel">
          <ul class="toc-panel__list">
            <li class="toc-panel__title">${null!==(i=null===(e=t.items[0])||void 0===e?void 0:e.header)&&void 0!==i?i:"In this article"}</li>
            ${t.items.slice(1).map(((t,e)=>{var o;return n.dy`<li class="toc-panel__item">
                <span class="toc-panel__page-numb">${e+1}</span>
                <a class=${"toc-panel__header "+(e+1===0?"toc-panel__header_selected":"")}>${null!==(o=null==t?void 0:t.header)&&void 0!==o?o:"..."}</a>
              </li>`}))}

            
          </ul>
        </nav>
      `,this)}));function xo(t,e){var o,n,i,r,l,s,c,d;switch(e.type){case y.LOAD:case y.LOADING:return Object.assign(Object.assign({},t),{isLoading:!0});case y.LOAD_DONE:if((null===(o=e.payload.pages)||void 0===o?void 0:o.length)!==e.payload.table_of_contents.length){e.payload.table_of_contents=[];for(const t of null!==(n=e.payload.pages)&&void 0!==n?n:[])e.payload.table_of_contents.push({header:wo(t.content),pageId:t.id});kt(e.payload.table_of_contents,e.payload.id)}return Object.assign(Object.assign({},t),{data:e.payload,isLoading:!1});case a.DRAFT_ADD_PAGE_DONE:if(null!=t.data&&null!=e.payload.newPage){const o=null!==(i=t.data.pages)&&void 0!==i?i:[];for(const t of o){const o=e.payload.updatedPages.find((e=>e.id===t.id));null!=o&&(t.order=o.order)}o.push(e.payload.newPage);const n=t.data.table_of_contents;return kt([...n.slice(0,e.payload.newPage.order),{header:"...",pageId:e.payload.newPage.id},...n.slice(e.payload.newPage.order)],t.data.id),Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{pages:o.sort(((t,e)=>t.order-e.order))})})}return t;case a.DRAFT_DELETE_PAGE_DONE:if(null!=t.data){const o=(null!==(r=t.data.pages)&&void 0!==r?r:[]).filter((t=>t.id!==e.payload.deletedPage.id));for(const t of o){const o=e.payload.updatedPages.find((e=>e.id===t.id));null!=o&&(t.order=o.order)}const n=t.data.table_of_contents;return kt([...n.slice(0,e.payload.deletedPage.order),...n.slice(e.payload.deletedPage.order+1)],t.data.id),Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{pages:o.sort(((t,e)=>t.order-e.order))})})}return t;case y.UPDATE_TOC_DONE:return null!=t.data?Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{table_of_contents:e.payload.toc})}):t;case y.UPDATE_TOC_ERROR:return console.warn(e.payload.error),t;case a.PAGE_SAVE_DONE:if(null!=t.data){const o=null!==(c=null===(s=null===(l=t.data.pages)||void 0===l?void 0:l.find((t=>t.id===e.payload.pageId)))||void 0===s?void 0:s.order)&&void 0!==c?c:-1,n=t.data.table_of_contents;let i=wo(e.payload.content);n[o]=null!==(d=n[o])&&void 0!==d?d:{},o>-1&&n[o].header!==String(i)&&(n[o]={header:String(i),pageId:e.payload.pageId},kt(n,t.data.id))}return t;case a.DRAFT_PUBLISH:return null!=t.data?At(t.data):alert("Error: the draft cannot be published. The draft state is null."),t;default:return t}}function wo(t){var e;let o="...";return null==t||("ops"in t&&(o=t.ops[0].insert),"type"in t&&Array.isArray(t.content)&&Array.isArray(t.content[0].content)&&"text"===t.content[0].content[0].type&&(o=null!==(e=t.content[0].content[0].text)&&void 0!==e?e:o)),o}const ko=String.raw,Ao=(yo("inscriptum-page"),(0,s.s)("loading-progress-bar"),_o("inscriptum-table-of-content"),g("inscriptum-controls-panel"),(0,i.EG)({props:{id:{type:String,attribute:"data-id"}},render:n.sY})((function(t){var e,s,c,d;const[u,p]=(0,i._Y)(xo,{isLoading:!1}),[h,g]=(0,i.eJ)(new f.w),[v,_]=(0,i.eJ)(0),x=(0,i.sO)(null);return(0,i.d4)((()=>{const e=function(t){const e=r.Z.$.pipe(),o=r.Z.$.pipe((0,m.h)((e=>e.type===a.PAGE_SAVE_DONE&&e.payload.draftId===t)));return(0,_e.T)(e,o)}(t.id).subscribe((t=>p(t)));return()=>{e.unsubscribe()}}),[]),(0,i.d4)((()=>{!function(t){wt(this,void 0,void 0,(function*(){return r.Z.dispatch({type:y.LOADING,payload:{id:t}}),(0,xt.G)((()=>wt(this,void 0,void 0,(function*(){const{draft:e}=yield(0,b.S)().getDraftById({id:t});null!=e&&r.Z.dispatch({type:y.LOAD_DONE,payload:{id:e.id,created_at:e.created_at,updated_at:e.updated_at,table_of_contents:e.table_of_contents,notes:e.notes,pages:e.pages.sort(((t,e)=>t.order-e.order)).map(((e,o)=>{var n;return Object.assign(Object.assign({},e),{content:e.content,draftId:t,isFolded:0!==o,margins:null!==(n=e.margins)&&void 0!==n?n:[]})}))}})}))))}))}(t.id)}),[t.id]),(0,i.d4)((()=>(cancelAnimationFrame(v),_(requestAnimationFrame((()=>{null!=x.current&&(h.unsubscribe(),g(function(t){var e,o;const n=new f.w;let i=document.title;const l=null===(e=t.current)||void 0===e?void 0:e.togglePause,s=null===(o=t.current)||void 0===o?void 0:o.generateProgress;if(null!=l&&null!=s){let t=2e3,e=!1,o=!1;n.add(r.Z.$.pipe((0,m.h)((t=>t.type===a.PAGE_SAVE))).subscribe((()=>{o||(i=document.title,document.title=`*${i}`,o=!0)}))),n.add(r.Z.$.pipe((0,m.h)((t=>t.type===a.PAGE_SAVING))).subscribe((()=>{e&&s.next(),t=2e3,e=!0;const o=s.next();void 0!==o&&1===o.value&&(setTimeout((()=>{e&&(l(!0),t-=300)}),300),setTimeout((()=>{e&&l(!1)}),1e3),setTimeout((()=>{e&&(l(!0),t-=1e3)}),2e3),setTimeout((()=>{e&&(t-=1e3)}),3e3))}))),n.add(r.Z.$.pipe((0,m.h)((t=>t.type===a.PAGE_SAVE_DONE))).subscribe((n=>{e=!1,l(!1),setTimeout((()=>{s.next()}),t>0?t:0),document.title=i,o=!1}))),n.add(r.Z.$.pipe((0,m.h)((t=>t.type===a.PAGE_SAVE_FAIL))).subscribe((()=>{e=!1,l(!1),setTimeout((()=>{s.next()}),t>0?t:0)})))}return n}(x)))}))),()=>{cancelAnimationFrame(v),h.unsubscribe()})),[x.current]),(0,i.d4)((()=>{var t;const e=null===(t=u.data)||void 0===t?void 0:t.table_of_contents[0];null!=e&&(document.title=e.header)}),[u]),n.dy`
      <style>${o(6061)}</style>
      <loading-progress-bar .ref=${x}></loading-progress-bar>

      <um-preloader .loading=${u.isLoading}>
        <div class="draft-content">
          <div style=${ko`
              display: flex;
              flex-direction: column;
              margin-right: 7rem;
              margin-left: 3rem;
              min-width: 15rem;
            `}>
            <inscriptum-controls-panel .draftId=${t.id}></inscriptum-controls-panel>
            <inscriptum-table-of-content .items=${null!==(s=null===(e=u.data)||void 0===e?void 0:e.table_of_contents)&&void 0!==s?s:[]}></inscriptum-table-of-content>
          </div>

          <div style=${ko`
              width: 100%;
            `}>
            ${(0,l.r)(null!==(d=null===(c=u.data)||void 0===c?void 0:c.pages)&&void 0!==d?d:[],(t=>`${t.id}_${t.order}`),(t=>n.dy`<inscriptum-page .page=${t} style=${ko`
                    position: relative;
                    display: block;
                    border-bottom: 1px solid #eee;
                  `}></inscriptum-page>`))}
          </div>
        </div>
      </um-preloader>
    `})))},6106:(t,e,o)=>{o.d(e,{j7:()=>c,Bc:()=>d});var n=o(6798),i=o(6136),r=o(8770),a=o(8638),l=function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function l(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,l)}s((n=n.apply(t,e||[])).next())}))};const s=/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/,c="figure",d=n.NB.create({name:c,draggable:!0,defining:!0,selectable:!0,content:()=>"text*",defaultOptions:{inline:!1,HTMLAttributes:{}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML:()=>[{tag:"figure",contentElement:"figcaption",getAttrs:t=>{const e=t.querySelector("img");return{src:null==e?void 0:e.getAttribute("src"),alt:null==e?void 0:e.getAttribute("alt"),title:null==e?void 0:e.getAttribute("title")}}},{tag:"img[src]",preserveWhitespace:!0,getContent:(t,e)=>a.HY.from(e.text(t.alt.length>0?t.alt:" ")),getAttrs:t=>({src:t.getAttribute("src")})}],renderHTML({HTMLAttributes:t}){return["figure",["img",(0,n.P1)(this.options.HTMLAttributes,t)],["figcaption",0]]},addCommands(){return{setFigure:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[(0,n.x2)(s,this.type,(t=>{const[,e,o,n]=t;return{src:o,alt:e,title:n}}))]},addNodeView(){return({node:t,HTMLAttributes:e,getPos:o,editor:n})=>{const a=document.createElement("figure");a.setAttribute("draggable","true");const s=document.createElement("div"),c=document.createElement("figcaption");s.classList.add("figure_wrapper"),s.contentEditable="false",c.classList.add("editable_text"),c.classList.add("empty"),c.setAttribute("data-placeholder","Caption (optional)");const d=t.content.firstChild;(null==d?void 0:d.isText)&&null!=d.text&&d.text.trim().length>0&&c.classList.remove("empty"),a.appendChild(s),a.appendChild(c);const p=function(t,e){const o=document.createElement("img");return o.setAttribute("src",u(t)),e.appendChild(o),o}(t.attrs.src,s);t.attrs.alt&&p.setAttribute("alt",t.attrs.alt),t.attrs.title&&p.setAttribute("title",t.attrs.title);const h=function(t){const e=t.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/);if(null!=e)return{type:e[1],base64_data:e[2]}}(t.attrs.src);if(null!=h){const t=document.createElement("div"),e=document.createElement("div");t.classList.add("file_progress"),e.classList.add("file_progress_bar"),s.classList.add("loading"),t.appendChild(e),s.appendChild(t),function(t,e,o){!function(t,e,o,n){l(this,void 0,void 0,(function*(){try{const n=yield(0,r.uploadFileService)((0,i.uploadDataToBlob)(t),e);o&&o(n)}catch(t){n&&n(t)}}))}(t,((t,e)=>{let n=0;e&&t&&(n=100*t/e,n=Math.min(100,n)),o.style.width=n+"%"}),(t=>{if(t){const o=u(t.src),n=e.querySelector("img");null!=n&&(n.src=o),e.classList.remove("loading")}}),(t=>(0,i.showError)(t)))}(h,s,e)}return p.onclick=()=>{"function"==typeof o&&this.editor.commands.setNodeSelection(o())},{dom:a,contentDOM:c,ignoreMutation:e=>"attributes"===e.type&&null!=e.attributeName&&(["src","title","alt"].includes(e.attributeName)&&(t.attrs[e.attributeName]=e.target.getAttribute(e.attributeName)),!0),update:t=>t.type===this.type&&(c.classList.toggle("empty",0===t.content.size),!0)}}}});function u(t){return function(t,e){const o=document.createElement("a");o.href=t;const n=o.href.slice(0,o.href.indexOf(":"));return e.indexOf(n)>-1}(t,["http","https","data"])?t:"//:0"}},9586:(t,e,o)=>{o.d(e,{W:()=>i,V:()=>r});var n=o(6798);const i="topicSummary",r=n.NB.create({name:i,group:"topicDoc",content:"inline*",addAttributes:()=>({"data-placeholder":{default:"Summary of the text"},"data-label":{default:"Summary"},role:{default:"definition"}}),parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",(0,n.P1)(this.options.HTMLAttributes,t),0]}})},9059:(t,e,o)=>{o.d(e,{H:()=>i,l:()=>r});var n=o(6798);const i="topicTitle",r=n.NB.create({name:i,content:"inline*",group:"topicDoc",defining:!0,selectable:!0,addAttributes:()=>({"data-placeholder":{default:"Title"},"data-label":{default:"Title"}}),parseHTML:()=>[{tag:"h1"}],renderHTML({HTMLAttributes:t}){return["h1",(0,n.P1)(this.options.HTMLAttributes,t),0]}})},4938:(t,e,o)=>{o.d(e,{X7:()=>a,Ro:()=>l,WV:()=>s,iv:()=>u,u:()=>p});var n=o(6106),i=o(9586),r=o(9059);function a(t){if(!document.getElementById(t)){var e=document.getElementsByTagName("head")[0],o=document.createElement("link");o.id=t,o.rel="stylesheet",o.type="text/css",o.href=document.location.origin+t,o.media="all",e.appendChild(o)}}function l(t){let e="<noname>",o="...",n="";if(Array.isArray(null==t?void 0:t.ops)&&t.ops.length>0){e=String(t.ops[0].insert),o=String(t.ops[2].insert);const i=t.ops.find((t=>void 0!==d(t,["insert","blockFigure","image"])));if(null!=i&&(n=d(i,["insert","blockFigure","image"])),o.length<3){for(const[e,i]of t.ops.entries())if(e>2){if(o.length>100)break;void 0!==d(i,["insert","blockFigure","image"])?n=d(i,["insert","blockFigure","image"]):o+=" "+i.insert}o+="..."}}return o=o.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/`/g,"&DiacriticalGrave;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),{title:e,description:o,image:n}}function s(t){var e,o,a;let l="<noname>",s="...",d="";if(null!=t){const u=c(t,r.H);null!=(null==u?void 0:u.content)&&(l=null!==(e=u.content[0].text)&&void 0!==e?e:l);const p=c(t,i.W);null!=(null==p?void 0:p.content)&&(s=null!==(o=p.content[0].text)&&void 0!==o?o:s);const h=c(t,n.j7);null!=(null==h?void 0:h.attrs)&&(d=null!==(a=h.attrs.src)&&void 0!==a?a:d)}return s=s.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/`/g,"&DiacriticalGrave;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),{title:l,description:s,image:d}}function c(t,e){if(t.type===e)return t;if(Array.isArray(t.content))for(const o of t.content){const t=c(o,e);if(null!=t)return t}return null}function d(t,e){return e.reduce(((t,e)=>t&&"undefined"!==t[e]?t[e]:void 0),t)}const u=String.raw;function p(t,e=!1){const o="                                            ".split(/ +/g),n="shh sh ch cz yu ya yo zh `` y' e` a b v g d e z i j k l m n o p r s t u f x `".split(/ +/g);for(let i=0;i<o.length;i++)t=(t=t.split(e?n[i]:o[i]).join(e?o[i]:n[i])).split(e?n[i].toUpperCase():o[i].toUpperCase()).join(e?o[i].toUpperCase():n[i].toUpperCase());return t}},669:(t,e,o)=>{o.d(e,{$:()=>s});var n=o(1640),i=o(8147),r=o(3255);class a extends i.s{render(t,e){return e.current=this,t}}const l=(0,r.XM)(a);function s(t,e){if(!(e.current instanceof HTMLElement))return e.current instanceof a&&e.current.setValue(t),l(t,e);(0,n.sY)(t,e.current)}},6061:t=>{t.exports='/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}.container{position:relative;width:100%;max-width:960px;margin:0 auto;padding:0 20px;box-sizing:border-box}.column,.columns{width:100%;float:left;box-sizing:border-box}@media(min-width: 400px){.container{width:85%;padding:0}}@media(min-width: 550px){.container{width:80%}.column,.columns{margin-left:4%}.column:first-child,.columns:first-child{margin-left:0}.one.column,.one.columns{width:grid-column-width(1)}.two.columns{width:grid-column-width(2)}.three.columns{width:grid-column-width(3)}.four.columns{width:grid-column-width(4)}.five.columns{width:grid-column-width(5)}.six.columns{width:grid-column-width(6)}.seven.columns{width:grid-column-width(7)}.eight.columns{width:grid-column-width(8)}.nine.columns{width:grid-column-width(9)}.ten.columns{width:grid-column-width(10)}.eleven.columns{width:grid-column-width(11)}.twelve.columns{width:100%;margin-left:0}.one-third.column{width:grid-column-width(4)}.two-thirds.column{width:grid-column-width(8)}.one-half.column{width:grid-column-width(6)}.offset-by-one.column,.offset-by-one.columns{margin-left:grid-offset-length(1)}.offset-by-two.column,.offset-by-two.columns{margin-left:grid-offset-length(2)}.offset-by-three.column,.offset-by-three.columns{margin-left:grid-offset-length(3)}.offset-by-four.column,.offset-by-four.columns{margin-left:grid-offset-length(4)}.offset-by-five.column,.offset-by-five.columns{margin-left:grid-offset-length(5)}.offset-by-six.column,.offset-by-six.columns{margin-left:grid-offset-length(6)}.offset-by-seven.column,.offset-by-seven.columns{margin-left:grid-offset-length(7)}.offset-by-eight.column,.offset-by-eight.columns{margin-left:grid-offset-length(8)}.offset-by-nine.column,.offset-by-nine.columns{margin-left:grid-offset-length(9)}.offset-by-ten.column,.offset-by-ten.columns{margin-left:grid-offset-length(10)}.offset-by-eleven.column,.offset-by-eleven.columns{margin-left:grid-offset-length(11)}.offset-by-one-third.column,.offset-by-one-third.columns{margin-left:grid-offset-length(4)}.offset-by-two-thirds.column,.offset-by-two-thirds.columns{margin-left:grid-offset-length(8)}.offset-by-one-half.column,.offset-by-one-half.column{margin-left:grid-offset-length(6)}}.container:after,.row:after,.u-cf{content:"";display:table;clear:both}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}.btn{cursor:pointer}.btn.btn_icon{background:transparent;border:none}.btn.btn_icon .icon-tabler{transition:.2s;stroke:#bbb;stroke:var(--border-color);color:#bbb;color:var(--border-color)}.btn.btn_icon .icon-tabler:hover{stroke:#333;stroke:var(--dark-grey)}.um-drafts__submenu{display:flex;flex-direction:row-reverse;padding-top:10px;border-bottom:1px solid #eee}.um-drafts__export-all{margin:0 0 10px 10px;stroke:#fff;stroke-width:30px;color:#bbb}.um-drafts__export-all:hover{color:#888;cursor:pointer}.draft-content{display:flex;flex-direction:column}@media(min-width: 400px){.draft-content{flex-direction:row}}.page__controls{display:flex;justify-content:space-between;align-items:start;opacity:.3;transition:.2s}.page__controls:hover{opacity:1}'},8608:t=>{t.exports=":root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}.btn{cursor:pointer}.btn.btn_icon{background:transparent;border:none}.btn.btn_icon .icon-tabler{transition:.2s;stroke:#bbb;stroke:var(--border-color);color:#bbb;color:var(--border-color)}.btn.btn_icon .icon-tabler:hover{stroke:#333;stroke:var(--dark-grey)}:host{position:relative;width:100%;display:flex;flex-direction:row;border-left:solid 1px #e1e1e1;user-select:none;-webkit-user-select:none}sketch-pad{width:100%;display:block}.sketch-pad_frame{flex-grow:1;position:absolute;height:100%;width:100%;overflow:auto;user-select:none;-webkit-user-select:none}.signature-pad{position:absolute;user-select:none;-webkit-user-select:none}.fab-container{display:inline-flex;align-items:flex-end;justify-content:flex-end}.fab-container_main{position:sticky;top:calc(100vh - 20px);left:20px;display:flex;margin:1em;flex-direction:row;height:0}.fab-container_main>*:not(:last-child){opacity:0;margin-left:0;transform:translateX(10px)}.fab-container_main:hover{height:50px;top:calc(100vh - 70px)}.fab-container_main:hover>*{display:flex;opacity:1;transform:none;margin-left:10px}.fab-container [tooltip]:before{bottom:115%;border-radius:2px;background:rgba(88,88,88,.16);content:attr(tooltip);font-size:12px;visibility:hidden;opacity:0;padding:5px 7px;margin-right:12px;position:absolute;white-space:nowrap}.fab-container [tooltip]:hover:before,.fab-container [tooltip]:hover:after{visibility:visible;opacity:1}.fab-container_horizontal{flex-direction:row;position:relative;margin:0;display:none}.fab-container_horizontal>*:not(:last-child){opacity:0;margin-left:0;transform:translateX(10px)}.fab-container_horizontal:hover>*{display:inherit;opacity:1;transform:none;margin-left:10px}.fab-container_vertical{flex-direction:column;position:relative;margin:0;display:none}.fab-container_vertical>*:not(:last-child){opacity:0;margin-top:0;transform:translateY(10px)}.fab-container_vertical:hover>*{opacity:1;margin-top:10px;transform:none}.fab-container:nth-last-child(1){transition-delay:25ms;background-size:contain}.fab-container:not(:last-child):nth-last-child(2){transition-delay:20ms;background-size:contain}.fab-container:not(:last-child):nth-last-child(3){transition-delay:40ms;background-size:contain}.fab-container:not(:last-child):nth-last-child(4){transition-delay:60ms;background-size:contain}.fab-button{border:none;background-color:#fff;cursor:pointer;box-shadow:2px 2px 2px 0px rgba(0,0,0,.18),0px 4px 7px -7px rgba(0,0,0,.15);border-radius:50%;display:block;width:40px;height:40px;margin:5px;position:relative;transition:all .1s ease-out;text-decoration:none;display:flex;justify-content:center;align-items:center;color:#bbb}.fab-button:active,.fab-button:focus,.fab-button:hover{box-shadow:3px 2px 2px rgba(0,0,0,.14),0 4px 8px rgba(0,0,0,.28);color:#bbb}.fab-button_lg{width:50px;height:50px;margin:0}.btn__first{position:absolute;z-index:2}.btn__second{position:absolute;z-index:2;left:2rem}.btn__third{position:absolute;z-index:2;left:4rem}.alpha-setter{display:block;position:absolute;background:#fff;border:1px solid #eee;border-radius:4px;filter:drop-shadow(0 0 6px rgba(0, 0, 0, 0.1))}.alpha-setter__back{position:relative;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==)}"},5257:t=>{t.exports='pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{background:#23241f;color:#f8f8f2}.hljs-subst,.hljs-tag{color:#f8f8f2}.hljs-emphasis,.hljs-strong{color:#a8a8a2}.hljs-bullet,.hljs-link,.hljs-literal,.hljs-number,.hljs-quote,.hljs-regexp{color:#ae81ff}.hljs-code,.hljs-section,.hljs-selector-class,.hljs-title{color:#a6e22e}.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}.hljs-attr,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#f92672}.hljs-attribute,.hljs-symbol{color:#66d9ef}.hljs-class .hljs-title,.hljs-params,.hljs-title.class_{color:#f8f8f2}.hljs-addition,.hljs-built_in,.hljs-selector-attr,.hljs-selector-id,.hljs-selector-pseudo,.hljs-string,.hljs-template-variable,.hljs-type,.hljs-variable{color:#e6db74}.hljs-comment,.hljs-deletion,.hljs-meta{color:#75715e}.redactor{max-width:732px;margin:0 auto}.redactor__article{font-family:Georgia,Times,Times New Roman,serif;font-weight:400;font-style:normal;font-size:18px;line-height:1.58;color:rgba(12,10,10,.8);padding:0;margin:0}.redactor__article .ProseMirror{outline:0}.redactor__article .ProseMirror>*+*{margin-top:.75em}.redactor__article .ProseMirror>::selection,.redactor__article .ProseMirror>:not(pre) ::selection{background:#5f5f5f2f}.redactor__article .ProseMirror h1,.redactor__article .ProseMirror h2,.redactor__article .ProseMirror h3,.redactor__article .ProseMirror h4{font-family:Inter,sans-serif;font-weight:600;font-style:normal;letter-spacing:initial}.redactor__article .ProseMirror h1{font-size:32px;margin:21px 21px 12px;line-height:34px}.redactor__article .ProseMirror h2{font-size:30px;margin:21px 21px 12px;line-height:34px}.redactor__article .ProseMirror h3{font-size:28px;margin:18px 21px 9px}.redactor__article .ProseMirror h4{font-size:24px;margin:18px 21px 7px}.redactor__article .ProseMirror p{margin:0 21px 12px;word-wrap:break-word;white-space:pre-wrap}.redactor__article .ProseMirror blockquote{margin:18px 21px 16px 0;padding-left:15px;position:relative;font-style:italic;word-wrap:break-word;border-left:3px solid #000}.redactor__article .ProseMirror aside{font-size:21px;color:rgba(0,0,0,.6);margin:18px 21px 16px;padding:0 18px;text-align:center;font-style:italic}.redactor__article .ProseMirror hr{width:50%;margin:30px auto;border:none;font-size:2px;text-align:right;overflow:visible}.redactor__article .ProseMirror hr:after{content:"";display:block;border-top:1px solid #c9cdd1;margin:0 3px;position:relative;top:1px}.redactor__article .ProseMirror [contenteditable=false]{white-space:normal}.redactor__article .ProseMirror ul[data-type=taskList]{list-style:none;padding:0;margin:0 21px 12px}.redactor__article .ProseMirror ul[data-type=taskList] li{display:block}.redactor__article .ProseMirror ul[data-type=taskList] li>label{float:left;margin-right:.5rem}.redactor__article .ProseMirror ul[data-type=taskList] li>div{display:contents}.redactor__article .ProseMirror ul[data-type=taskList] li p{margin:0}.redactor__article .ProseMirror mark{background-color:#faf594b4}.redactor__article .ProseMirror :not(pre)>code{background-color:rgba(97,97,97,.1);color:#616161;font-family:JetBrainsMono,monospace;font-variant-ligatures:normal;padding:.1rem .3rem;border-radius:.4rem;font-size:.9rem}.redactor__article .ProseMirror a[href]{text-decoration:none;transition:all .2s ease-in-out;color:rgba(0,0,0,.8);border-bottom:.1rem rgba(0,0,0,.425) solid}.redactor__article .ProseMirror a[href]:hover,.redactor__article .ProseMirror a[href]:focus{border-bottom:.1rem rgba(0,0,0,.8) solid}.redactor__article .ProseMirror *[data-placeholder].empty{position:relative}.redactor__article .ProseMirror *[data-placeholder].empty:before{position:absolute;left:0;right:0;content:attr(data-placeholder);color:rgba(0,0,0,.44);font-weight:normal;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;pointer-events:none}.redactor__article .ProseMirror *[data-label]{position:relative}.redactor__article .ProseMirror *[data-label]:after{position:absolute;content:attr(data-label);color:rgba(0,0,0,.44);border-right:1px solid rgba(0,0,0,.15);right:100%;top:-6px;bottom:-6px;padding:6px 12px;font-weight:normal;margin:0 21px;opacity:0;visibility:hidden;transition:opacity .15s ease}.redactor__article .ProseMirror .focused *[data-label].empty:after{position:absolute;content:attr(data-label);color:rgba(0,0,0,.44);border-right:1px solid rgba(0,0,0,.15);right:100%;top:-6px;bottom:-6px;padding:6px 12px;font-weight:normal;margin:0 21px;opacity:0;visibility:hidden;transition:opacity .15s ease}.redactor__article .ProseMirror *[data-label].focused:after{opacity:1;visibility:visible}.redactor__article .ProseMirror *[role=definition]{font-family:Inter,sans-serif;font-size:15px;line-height:18px;color:#79828b;margin:12px 21px;font-style:normal}.redactor__article .ProseMirror *[role=definition] a{color:#79828b}.redactor__article .ProseMirror *[role=definition] a[href]{border-bottom:none;border-bottom:.1em solid rgba(0,0,0,.4)}.redactor__article .ProseMirror *[role=definition].empty{display:block}.redactor__article .ProseMirror *[role=definition] time:before{content:"";padding:0 7px}.redactor__article .ProseMirror img{max-width:100%;vertical-align:top}.redactor__article .ProseMirror .iframe_wrap{max-width:100%;vertical-align:top;max-width:100%;vertical-align:top;position:relative}.redactor__article .ProseMirror .iframe_wrap iframe{position:absolute;width:1px;height:1px;min-width:100%;min-height:100%;*width:100%;*height:100%;top:0;left:0}.redactor__article .ProseMirror figure{margin:0 21px 16px;padding:0;text-align:center;position:relative;user-select:inherit}.redactor__article .ProseMirror figure.ProseMirror-selectednode img{box-shadow:0 0 0 3px rgba(0,0,0,.4)}.redactor__article .ProseMirror figure.ProseMirror-selectednode img:hover{box-shadow:0 0 0 3px rgba(0,0,0,.4)}.redactor__article .ProseMirror figure img:hover{box-shadow:0 0 0 3px rgba(0,0,0,.2)}.redactor__article .ProseMirror figcaption{font-family:Inter,sans-serif;font-size:15px;color:#79828b;padding:12px 21px 0;line-height:18px;vertical-align:top;text-align:center}.redactor__article .ProseMirror .figure_wrapper{position:relative}.redactor__article .ProseMirror .figure_wrapper img{opacity:1;transition:opacity .15s ease;max-height:690px}.redactor__article .ProseMirror .figure_wrapper.loading img{opacity:.3}.redactor__article .ProseMirror .figure_wrapper .file_progress{position:absolute;z-index:1;bottom:0;left:0;right:0;padding:3px;background-color:rgba(255,255,255,.7);transition:opacity .15s ease;visibility:hidden;opacity:0}.redactor__article .ProseMirror .figure_wrapper.loading .file_progress{visibility:visible;opacity:1}.redactor__article .ProseMirror .figure_wrapper .file_progress_bar{height:2px;background-color:#333;transition:width .1s linear;width:0}.redactor__article .ProseMirror figcaption[data-placeholder].empty{position:relative;overflow:hidden;width:calc(100% - 170px)}.redactor__article .ProseMirror figcaption[data-placeholder].empty:before{display:none}.redactor__article .ProseMirror figcaption[data-placeholder].empty:after{position:absolute;content:attr(data-placeholder);color:rgba(0,0,0,.44);font-weight:normal;font-style:italic;top:0px;padding-top:12px}.redactor__article .ProseMirror pre{background:#232b2b;border-radius:.3rem;box-shadow:0 .5rem 1rem rgba(0,0,0,.4);border-left:6px solid #516363;margin:1rem auto;white-space:pre-wrap;color:#c7d3de;counter-reset:step;counter-increment:step 0;position:relative;font-family:JetBrainsMono,monospace;font-variant-ligatures:normal;font-size:.9rem;padding:.75rem 1rem}.redactor__article .ProseMirror pre code{font-family:JetBrainsMono,monospace;font-variant-ligatures:normal;white-space:pre-wrap;margin-left:2.5rem;display:block}.redactor__article .ProseMirror pre ::selection{background:#dbdbdb2d}.redactor__article .ProseMirror pre div.l:before{color:#516363;position:absolute;left:15px;content:counter(step);counter-increment:step}@media(max-width: 960px){.redactor__article .ProseMirror *[data-label]:after{display:none}}.is-active{background:#000;color:#fff}'},7135:t=>{t.exports='/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:2rem;font-weight:300}h1{font-size:4rem;line-height:1.2;letter-spacing:-0.1rem}h2{font-size:3.6rem;line-height:1.25;letter-spacing:-0.1rem}h3{font-size:3rem;line-height:1.3;letter-spacing:-0.1rem}h4{font-size:2.4rem;line-height:1.35;letter-spacing:-0.08rem}h5{font-size:1.8rem;line-height:1.5;letter-spacing:-0.05rem}h6{font-size:1.5rem;line-height:1.6;letter-spacing:0}@media(min-width: 550px){h1{font-size:5rem}h2{font-size:4.2rem}h3{font-size:3.6rem}h4{font-size:3rem}h5{font-size:2.4rem}h6{font-size:1.5rem}}p{margin-top:0}.toc-panel{--toc-border-width: 1px;--color-contrast-low: hsl(240, 1%, 83%);--color-contrast-medium: hsl(240, 1%, 48%);--color-contrast-high: hsl(240, 4%, 20%);--text-unit: 1em;--text-scale-ratio: 1.2;--text-xs: calc((1em / 1.2) / 1.2);--text-xs: calc((var(--text-unit) / var(--text-scale-ratio)) / var(--text-scale-ratio));--text-sm: calc(calc((1em / 1.2) / 1.2) * 1.2);--text-sm: calc(var(--text-xs) * var(--text-scale-ratio));box-shadow:inset 1px 0 0 hsl(240, 1%, 83%);box-shadow:inset var(--toc-border-width) 0 0 var(--color-contrast-low);font-family:"Inter",sans-serif;position:sticky;top:1.25rem;max-height:calc(100vh - 1.25rem);overflow:visible}.toc-panel ol,.toc-panel ul{list-style:none;margin:0;padding:0;border:0}.toc-panel .toc-panel__list{position:relative}.toc-panel .toc-panel__list .toc-panel__list .toc-panel__header{padding-left:calc(1.25rem * 2)}.toc-panel .toc-panel__title{padding:.25rem 1.25rem;text-transform:uppercase;letter-spacing:.1em;font-size:calc(calc((1em / 1.2) / 1.2) * 1.2);font-size:var(--text-sm)}.toc-panel .toc-panel__header{padding:.25rem 1.25rem;position:relative;display:inline-flex;color:hsl(240, 1%, 48%);color:var(--color-contrast-medium);text-decoration:none;overflow:hidden;text-overflow:ellipsis}.toc-panel .toc-panel__header::before{content:"";width:1px;width:var(--toc-border-width);height:100%;position:absolute;left:0;top:0}.toc-panel .toc-panel__header:hover{color:hsl(240, 4%, 20%);color:var(--color-contrast-high)}.toc-panel .toc-panel__header_selected{color:#2a6df4}.toc-panel .toc-panel__header_selected::before{background-color:#2a6df4}.toc-panel .toc-panel__page-numb{width:2rem;text-align:right;padding-top:.25rem;padding-right:.5rem;flex-shrink:0;white-space:nowrap}.toc-panel .toc-panel__item{display:flex;margin-left:-2.5rem;color:hsl(240, 1%, 48%);color:var(--color-contrast-medium)}.toc-panel .toc-panel__item:hover{color:hsl(240, 4%, 20%);color:var(--color-contrast-high)}'}}]);