"use strict";(self.webpackChunkinscriptum=self.webpackChunkinscriptum||[]).push([[2188,8079,8926,3164,4099,9731,3041,9296,9691,9022,1888,6885,6301],{8079:(e,t,o)=>{o.r(t),o.d(t,{BlockquoteBlot:()=>r});var n=o(5039),i=o(3691);class r extends i.ZP{}r.blotName="blockBlockquote",r.tagName="blockquote",n.Z.register(r)},8926:(e,t,o)=>{o.r(t),o.d(t,{BreakBlot:()=>r});var n=o(5039),i=o(3691);class r extends i.i2{}r.blotName="textBreak",r.tagName="br",r.className="inline",n.Z.register(r)},3164:(e,t,o)=>{o.r(t),o.d(t,{DescriptionBlot:()=>r});var n=o(5039),i=o(9731);class r extends i.FieldBlot{static create(e){console.log("DescriptionBlot create ",e);let t=super.create(e);return t.setAttribute("data-placeholder","Summary of the text"),t.setAttribute("data-label","Description"),t}formatAt(e,t,o,n){console.log("DescriptionBlot formatAt ",e,t,o,n),o===r.blotName?super.formatAt(e,t,o,n):"link"===o&&super.formatAt(0,this.length(),o,n)}format(e,t){console.log("DescriptionBlot format ",e,t),super.format(e,t)}replace(e){console.log("DescriptionBlot replace ",e),super.replace(e)}insertAt(e,t,o){console.log("DescriptionBlot insertAt ",e,t,o),super.insertAt(e,t,o)}}r.blotName="blockDescription",r.tagName="address",n.Z.register(r)},4099:(e,t,o)=>{o.r(t),o.d(t,{DividerBlot:()=>i});var n=o(3691);class i extends n.i2{}i.blotName="blockDivider",i.tagName="hr"},9731:(e,t,o)=>{o.r(t),o.d(t,{FieldBlot:()=>i});var n=o(9022);class i extends n.SingleLineBlot{}},3041:(e,t,o)=>{o.r(t),o.d(t,{HeaderBlot:()=>r});var n=o(5039),i=o(9022);class r extends i.SingleLineBlot{optimize(e){super.optimize(e);let t=this.domNode.innerText;t=t.replace(/[\s_]+/g,"-"),t=t.replace(/(^-+|-+$)/g,""),this.domNode.id!==t&&this.domNode.setAttribute("id",t)}formatAt(e,t,o,n){("bold"!==o&&"italic"!==o&&"code"!==o||!n)&&super.formatAt(e,t,o,n)}}r.blotName="blockHeader",r.tagName="h3",n.Z.register(r)},5622:(e,t,o)=>{o.r(t),o.d(t,{CodeEndLineFlag:()=>a,InsSyntaxCodeBlock:()=>l,InsSyntaxModule:()=>s});var n=o(5039),i=o(1154),r=o(3549);class a extends i.Z{static formats(){return{}}}a.blotName="code-end",a.className="l",a.tagName="SPAN",n.Z.register(a);class l extends r.dn{highlight(e){let t=this.domNode.textContent||"";if(this.cachedText!==t){if(t.trim().length>0||null==this.cachedText){let o="";const n=e(t).split("\n");for(let e=0;e<n.length-1;e++)o+=`<span class="l">${n[e]||" "}</span>\n`;o+=`<span class="l">${n[n.length-1]}</span>`,this.domNode.innerHTML=`<code class="hljs">${o}</code>`}this.cachedText=t}}}class s extends r.ZP{static register(){n.Z.register(r.GW,!0),n.Z.register(l,!0)}highlight(){if(this.quill.selection.composing)return;this.quill.update(n.Z.sources.USER);let e=this.quill.getSelection();this.quill.scroll.descendants(l).forEach((e=>{e.highlight(this.options.highlight)})),this.quill.update(n.Z.sources.SILENT),null!=e&&document.activeElement===this.quill.container.querySelector("[contenteditable]")&&this.quill.setSelection(e,n.Z.sources.SILENT)}}},7466:(e,t,o)=>{o.r(t),o.d(t,{LinkBlot:()=>r});var n=o(1154),i=o(6136);class r extends n.Z{constructor(e,t){super(e),this.value=t,e.addEventListener("mouseover",r.showLinkTooltip.bind(this,this),!1),e.addEventListener("mouseout",r.hideLinkTooltip,!1)}static create(e){let t=super.create(e);e=this.sanitize(e),t.setAttribute("href",e);var o=e.substr(0,1);return"/"!=o&&"#"!=o&&"tg://"!=e.substr(0,5)&&"mailto:"!=e.substr(0,7)&&t.setAttribute("target","_blank"),t}static formats(e){return e.getAttribute("href")}static sanitize(e){const t=r.relativeUrl(e);return(0,i.sanitize)(e,["http","https","tg","mailto"])?t:"about:blank"}detach(){this.domNode.removeEventListener("mouseover",r.showLinkTooltip.bind(this,this),!1),this.domNode.removeEventListener("mouseout",r.hideLinkTooltip,!1),super.detach(),r.hideLinkTooltip()}format(e,t){if(e!==this.statics.blotName||!t)return super.format(e,t);t=r.sanitize(t),this.domNode.setAttribute("href",t),this.domNode.setAttribute("data-title",t)}static relativeUrl(e){let t=location,o=document.createElement("a");return o.href=e,t.origin!==o.origin?o.href:t.pathname!==o.pathname||t.search!==o.search?o.pathname+o.search+o.hash:t.href===o.href?o.hash||o.pathname+o.search+o.hash:o.hash}}},1428:(e,t,o)=>{o.r(t),o.d(t,{ListContinuer:()=>i});var n=o(9244);class i extends n.Z{static create(e){let t;return"string"==typeof e?t=super.create(e):(t=super.create(e.type),void 0!==e.start&&(t.setAttribute("start",e.start),t.style["counter-reset"]=`list-0 ${e.start}`)),t}static formats(e){let t=super.formats(e);return console.log("MyList-static.formats",t,e.getAttribute("start")),{type:t,start:e.getAttribute("start")}}}},9296:(e,t,o)=>{o.r(t),o.d(t,{MyQuill:()=>i});var n=o(5039);class i extends n.Z{formatLine(...e){super.formatLine(...e),this.updateSelection()}formatText(...e){super.formatText(...e),this.updateSelection()}updateSelection(e){if(this.hasFocus()){e=e||i.sources.SILENT;let t=this.getSelection(!0);this.setSelection(++t.index,t.length,e),this.setSelection(--t.index,t.length,e)}}}},9691:(e,t,o)=>{o.r(t),o.d(t,{PullquoteBlot:()=>r});var n=o(5039),i=o(3691);class r extends i.ZP{}r.blotName="blockPullquote",r.tagName="aside",n.Z.register(r)},9022:(e,t,o)=>{o.r(t),o.d(t,{SingleLineBlot:()=>l});var n=o(3691),i=o(8926),r=o(347),a=o.n(r);class l extends n.ZP{replace(e){e.children.forEach((e=>{e instanceof i.BreakBlot&&e.replaceWith(a().create("text"," "))})),super.replace(e)}insertAt(e,t,o){void 0!==o&&"textBreak"==t?super.insertAt(e,"\n"):super.insertAt(e,t,o)}}},1888:(e,t,o)=>{o.r(t),o.d(t,{SubheaderBlot:()=>r});var n=o(5039),i=o(3041);class r extends i.HeaderBlot{}r.blotName="blockSubheader",r.tagName="h4",n.Z.register(r)},6885:(e,t,o)=>{o.r(t),o.d(t,{TitleBlot:()=>r});var n=o(5039),i=o(9731);class r extends i.FieldBlot{static create(e){let t=super.create(e);return t.setAttribute("data-placeholder","Title"),t.setAttribute("data-label","Title"),t}formatAt(e,t,o,n){o===r.blotName&&super.formatAt(e,t,o,n)}}r.blotName="blockTitle",r.tagName="h1",n.Z.register(r)},6301:(e,t,o)=>{o.r(t),o.d(t,{default:()=>u});var n=o(637),i=o(9622),r=o(2247),a=o(4085),l=o(1042),s=o(836),d=o(6167),c=o(5688);n.Z.registerLanguage("javascript",i.Z),n.Z.registerLanguage("typescript",r.Z),n.Z.registerLanguage("sql",a.Z),n.Z.registerLanguage("xml",l.Z),n.Z.registerLanguage("css",s.Z),n.Z.registerLanguage("bash",d.Z),n.Z.registerLanguage("yaml",c.Z);const u=n.Z},2188:(e,t,o)=>{o.r(t),o.d(t,{draftElement:()=>fn});var n=o(3445),i=o(78),r=o(211);const a="AUTH_ACTION",l={AUTH:Symbol(`[${a}] AUTH`),AUTH_DONE:Symbol(`[${a}] AUTH_DONE`),AUTH_FAIL:Symbol(`[${a}] AUTH_FAIL`)};const s=new r.xQ;const d={$:s.asObservable(),dispatch:function(e){console.log(e),function(e){var t,o;"error"in e.payload&&Array.isArray(null===(o=null===(t=e.payload.error)||void 0===t?void 0:t.response)||void 0===o?void 0:o.errors)&&e.payload.error.response.errors.some((e=>{var t;return null===(t=e.message)||void 0===t?void 0:t.startWith("Could not verify JWT: JWTExpired")}))&&d.dispatch({type:l.AUTH,payload:{redirectUri:`${document.location.origin}/drafts`}})}(e),s.next(e)}},c={PAGE_SAVE:Symbol("[HUB_ACTION] PAGE_SAVE"),PAGE_SAVING:Symbol("[HUB_ACTION] PAGE_SAVING"),PAGE_SAVE_DONE:Symbol("[HUB_ACTION] PAGE_SAVE_DONE"),PAGE_SAVE_FAIL:Symbol("[HUB_ACTION] PAGE_SAVE_FAIL"),DRAFT_ADD_PAGE_DONE:Symbol("[HUB_ACTION] DRAFT_ADD_PAGE_DONE"),DRAFT_DELETE_PAGE_DONE:Symbol("[HUB_ACTION] DRAFT_DELETE_PAGE_DONE"),DRAFT_PUBLISH:Symbol("[HUB_ACTION] DRAFT_PUBLISH")};var u=o(7157),p=o(7012),g=o(1640),h=o(3584),f=o(4938),m=o(8147),b=o(3255);class _ extends m.s{render(e,t){return t.current=this,e}}const y=(0,b.XM)(_);function v(e,t){if(!(t.current instanceof HTMLElement))return t.current instanceof _&&t.current.setValue(e),y(e,t);(0,g.sY)(e,t.current)}const w=(0,h.NG)((function*(){for(;;)yield v(g.YP`
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-download" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"></path>
          <polyline points="7 11 12 16 17 11"></polyline>
          <line x1="12" y1="4" x2="12" y2="16"></line>
        </svg>
    `,this)}))(),k=(0,h.EG)({props:{draftId:h.p.req("draft-id")}})((function*(e){function t(){d.dispatch({type:c.DRAFT_PUBLISH,payload:{draftId:e.draftId}})}for(;;)yield(0,g.sY)(g.dy`<div style=${f.iv`
          margin: 1rem 0;
          display: flex;
          flex-direction: row;
        `}>
        <button class="btn btn_icon" @click=${t}>
          ${w({})}
        </button>
      </div>`,this)}));var x=o(8760),A=o(6008),T=o(8687),E=o(8170),S=o(4035),$=o(5709),L=o(486),P=o(5550),N=o(1244);function I(e){var t;const o=new P.ZP.WebAuth({domain:"inscriptum.auth0.com",clientID:"sSGAFDwnRqJUsJw7v12KV8SAeuYtl3Cd",redirectUri:e,responseType:"token id_token",scope:"openid email",audience:"https://inscriptum.js.org"}),n=null!==(t=sessionStorage.windowLocationHash)&&void 0!==t?t:window.location.hash;return null!=n&&n.length>0?function(e){var t;const o=null!==(t=sessionStorage.windowLocationHash)&&void 0!==t?t:window.location.hash;return new N.y((t=>{e.parseHash({hash:o},((e,o)=>{const n=M(e,o);t.next(n)}))}))}(o):function(e,t){return new N.y((o=>{e.checkSession({},((n,i)=>{try{const e=M(n,i);o.next(e)}catch(n){e.authorize({redirectUri:t}),o.error(n)}}))}))}(o,e)}function M(e,t){var o;if(null!=(null==t?void 0:t.accessToken)&&null!=(null==t?void 0:t.idToken)){localStorage.setItem("isLoggedIn","true");const e=Number(JSON.stringify(1e3*(null!==(o=t.expiresIn)&&void 0!==o?o:1)+(new Date).getTime())),n=t.accessToken,i=t.idToken;null==t.idTokenPayload&&alert("idTokenPayload is undefined");return{accessToken:n,expiresAt:e,idToken:i,userInfo:{auth0Id:t.idTokenPayload["https://hasura.io/jwt/claims"]["x-hasura-user-id"],email:t.idTokenPayload.email}}}{let t="";throw e&&(t="Error: "+e.error+". Check the console for further details.",console.warn(t)),Error(t)}}const O=d.$.pipe((0,A.h)((e=>l.AUTH===e.type)),(0,S.w)((e=>I(e.payload.redirectUri).pipe((0,$.U)((e=>({type:l.AUTH_DONE,payload:e}))),(0,L.K)((e=>(0,E.of)({type:l.AUTH_FAIL,payload:e})))))));var C=o(4370),B=o(1993),D=o(2807),j=o(4181),z=o(9857),Z=o(3018);function H(e){return(0,A.h)((t=>Object.values(e).includes(t.type)))}const R=(0,C.T)(d.$,O).pipe(H(l),(0,B.O)({isLoading:!1}),(0,D.R)((function(e,t){switch(t.type){case l.AUTH:return Object.assign(Object.assign({},e),{error:null,isLoading:!0});case l.AUTH_DONE:return Object.assign(Object.assign({},e),{data:t.payload,isLoading:!1});case l.AUTH_FAIL:return Object.assign(Object.assign({},e),{error:t.payload,isLoading:!1});default:return e}})),(0,j.E)(),(0,z._)(1),(0,Z.x)());var q,U,F,G,V,W,J,Y,K,Q,X,ee,te,oe,ne,ie,re,ae=o(9514),le=o(2972);!function(e){e.AuthorAuth0UserIdKey="author_auth0UserId_key",e.AuthorPkey="author_pkey"}(q||(q={})),function(e){e.Auth0Id="auth0_id",e.CreatedAt="created_at",e.Email="email",e.Id="id",e.LastSeen="last_seen",e.Name="name"}(U||(U={})),function(e){e.Auth0Id="auth0_id",e.CreatedAt="created_at",e.Email="email",e.Id="id",e.LastSeen="last_seen",e.Name="name"}(F||(F={})),function(e){e.DraftPkey="draft_pkey"}(G||(G={})),function(e){e.AuthorId="author_id",e.CreatedAt="created_at",e.EndedAt="ended_at",e.Id="id",e.TableOfContents="table_of_contents",e.UpdatedAt="updated_at"}(V||(V={})),function(e){e.AuthorId="author_id",e.CreatedAt="created_at",e.EndedAt="ended_at",e.Id="id",e.TableOfContents="table_of_contents",e.UpdatedAt="updated_at"}(W||(W={})),function(e){e.MarginPkey="margin_pkey"}(J||(J={})),function(e){e.CreatedAt="created_at",e.EndedAt="ended_at",e.Id="id",e.Img="img",e.Name="name",e.Options="options",e.PageId="page_id",e.UpdatedAt="updated_at"}(Y||(Y={})),function(e){e.CreatedAt="created_at",e.EndedAt="ended_at",e.Id="id",e.Img="img",e.Name="name",e.Options="options",e.PageId="page_id",e.UpdatedAt="updated_at"}(K||(K={})),function(e){e.NotePkey="note_pkey",e.UqNoteDraftIdEndedAt="uq_note_draft_id_ended_at"}(Q||(Q={})),function(e){e.AuthorId="author_id",e.CreatedAt="created_at",e.DraftId="draft_id",e.EndedAt="ended_at",e.Id="id",e.Name="name",e.Preview="preview",e.StaticLink="static_link",e.UpdatedAt="updated_at"}(X||(X={})),function(e){e.AuthorId="author_id",e.CreatedAt="created_at",e.DraftId="draft_id",e.EndedAt="ended_at",e.Id="id",e.Name="name",e.Preview="preview",e.StaticLink="static_link",e.UpdatedAt="updated_at"}(ee||(ee={})),function(e){e.LastSeen="last_seen",e.Name="name"}(te||(te={})),function(e){e.Asc="asc",e.AscNullsFirst="asc_nulls_first",e.AscNullsLast="asc_nulls_last",e.Desc="desc",e.DescNullsFirst="desc_nulls_first",e.DescNullsLast="desc_nulls_last"}(oe||(oe={})),function(e){e.PagePkey="page_pkey"}(ne||(ne={})),function(e){e.Content="content",e.CreatedAt="created_at",e.DraftId="draft_id",e.EndedAt="ended_at",e.Id="id",e.Order="order",e.UpdatedAt="updated_at"}(ie||(ie={})),function(e){e.Content="content",e.CreatedAt="created_at",e.DraftId="draft_id",e.EndedAt="ended_at",e.Id="id",e.Order="order",e.UpdatedAt="updated_at"}(re||(re={}));const se=le.ZP`
    query findAuthorByAuth0($auth0_id: String!) {
  author(where: {auth0_id: {_eq: $auth0_id}}) {
    id
    email
    name
    last_seen
    created_at
  }
}
    `,de=le.ZP`
    query getDraftById($id: uuid!) {
  draft: draft_by_pk(id: $id) {
    id
    created_at
    updated_at
    table_of_contents
    notes(order_by: {created_at: asc}, where: {ended_at: {_is_null: true}}) {
      id
    }
    pages(order_by: {created_at: asc}, where: {ended_at: {_is_null: true}}) {
      id
      content
      order
      margins(order_by: {created_at: asc}, where: {ended_at: {_is_null: true}}) {
        id
        name
      }
    }
  }
}
    `,ce=le.ZP`
    mutation updateDraftTOC($id: uuid!, $table_of_contents: jsonb!, $updated_at: timestamptz!) {
  update_draft_by_pk(
    pk_columns: {id: $id}
    _set: {table_of_contents: $table_of_contents, updated_at: $updated_at}
  ) {
    table_of_contents
    updated_at
    id
  }
}
    `,ue=le.ZP`
    query getMarginById($id: uuid!) {
  margin: margin_by_pk(id: $id) {
    id
    pageId: page_id
    img
    imgBase64
    options
  }
}
    `,pe=le.ZP`
    mutation createMargin($page_id: uuid!, $created_at: timestamptz!) {
  insert_margin_one(object: {page_id: $page_id, created_at: $created_at}) {
    id
  }
}
    `,ge=le.ZP`
    mutation saveMargin($id: uuid!, $updated_at: timestamptz!, $options: jsonb!, $img: bytea!, $name: String) {
  update_margin_by_pk(
    pk_columns: {id: $id}
    _set: {updated_at: $updated_at, options: $options, img: $img, name: $name}
  ) {
    updated_at
    id
  }
}
    `,he=le.ZP`
    query getAllNotes {
  notes: note(order_by: {created_at: desc}, where: {ended_at: {_is_null: true}}) {
    id
    name
    preview
    draft_id
    static_link
    updated_at
    created_at
    author {
      id
      name
      email
    }
  }
}
    `,fe=le.ZP`
    mutation createNode($author_id: uuid!, $created_at: timestamptz, $draft_id: uuid!, $ended_at: timestamptz, $name: String!, $preview: jsonb, $static_link: String) {
  insert_note_one(
    object: {author_id: $author_id, created_at: $created_at, draft_id: $draft_id, ended_at: $ended_at, name: $name, preview: $preview, static_link: $static_link}
  ) {
    id
    updated_at
    created_at
  }
}
    `,me=le.ZP`
    mutation updateNode($id: uuid!, $ended_at: timestamptz, $name: String, $preview: jsonb, $static_link: String, $updated_at: timestamptz!) {
  update_note_by_pk(
    pk_columns: {id: $id}
    _set: {ended_at: $ended_at, name: $name, preview: $preview, static_link: $static_link, updated_at: $updated_at}
  ) {
    id
    updated_at
    created_at
  }
}
    `,be=le.ZP`
    mutation updatePageById($id: uuid!, $content: jsonb!, $updated_at: timestamptz!) {
  update_page_by_pk(
    pk_columns: {id: $id}
    _set: {content: $content, updated_at: $updated_at}
  ) {
    id
  }
}
    `,_e=le.ZP`
    mutation addPageToDraft($created_at: timestamptz!, $draft_id: uuid!, $order: Int!) {
  update_page(
    where: {draft_id: {_eq: $draft_id}, ended_at: {_is_null: true}, order: {_gte: $order}}
    _inc: {order: 1}
  ) {
    returning {
      id
      order
    }
  }
  insert_page_one(
    object: {created_at: $created_at, draft_id: $draft_id, order: $order}
  ) {
    id
    order
    content
    margins {
      id
    }
  }
}
    `,ye=le.ZP`
    mutation deletePage($id: uuid!, $ended_at: timestamptz!, $draft_id: uuid!, $order: Int!) {
  update_page_by_pk(pk_columns: {id: $id}, _set: {ended_at: $ended_at}) {
    id
  }
  update_page(
    where: {draft_id: {_eq: $draft_id}, ended_at: {_is_null: true}, order: {_gte: $order}}
    _inc: {order: -1}
  ) {
    returning {
      id
      order
    }
  }
}
    `,ve=(e,t)=>e();const we="https://inscriptum-hasura.herokuapp.com/v1/graphql";let ke={credentials:"include",mode:"cors",cache:"no-cache",method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}},xe=new T.GraphQLClient(we,ke);R.pipe((0,ae.P)((e=>{var t;return null!=(null===(t=e.data)||void 0===t?void 0:t.idToken)&&!e.isLoading}))).subscribe((e=>{var t;console.log("API AUTH_ACTION.AUTH_DONE"),ke=Object.assign(Object.assign({},ke),{headers:Object.assign(Object.assign({},ke.headers),{Authorization:`Bearer ${null===(t=e.data)||void 0===t?void 0:t.idToken}`})}),xe=new T.GraphQLClient(we,ke)}));const Ae=()=>function(e,t=ve){return{findAuthorByAuth0:(o,n)=>t((t=>e.request(se,o,Object.assign(Object.assign({},n),t))),"findAuthorByAuth0"),getDraftById:(o,n)=>t((t=>e.request(de,o,Object.assign(Object.assign({},n),t))),"getDraftById"),updateDraftTOC:(o,n)=>t((t=>e.request(ce,o,Object.assign(Object.assign({},n),t))),"updateDraftTOC"),getMarginById:(o,n)=>t((t=>e.request(ue,o,Object.assign(Object.assign({},n),t))),"getMarginById"),createMargin:(o,n)=>t((t=>e.request(pe,o,Object.assign(Object.assign({},n),t))),"createMargin"),saveMargin:(o,n)=>t((t=>e.request(ge,o,Object.assign(Object.assign({},n),t))),"saveMargin"),getAllNotes:(o,n)=>t((t=>e.request(he,o,Object.assign(Object.assign({},n),t))),"getAllNotes"),createNode:(o,n)=>t((t=>e.request(fe,o,Object.assign(Object.assign({},n),t))),"createNode"),updateNode:(o,n)=>t((t=>e.request(me,o,Object.assign(Object.assign({},n),t))),"updateNode"),updatePageById:(o,n)=>t((t=>e.request(be,o,Object.assign(Object.assign({},n),t))),"updatePageById"),addPageToDraft:(o,n)=>t((t=>e.request(_e,o,Object.assign(Object.assign({},n),t))),"addPageToDraft"),deletePage:(o,n)=>t((t=>e.request(ye,o,Object.assign(Object.assign({},n),t))),"deletePage")}}(xe),Te={LOAD:Symbol("[DRAFT_ACTION] LOAD"),LOADING:Symbol("[DRAFT_ACTION] LOADING"),LOAD_DONE:Symbol("[DRAFT_ACTION] LOAD_DONE"),UPDATE_TOC_DONE:Symbol("[DRAFT_ACTION] UPDATE_TOC_DONE"),UPDATE_TOC_ERROR:Symbol("[DRAFT_ACTION] UPDATE_TOC_ERROR")};var Ee=o(6798),Se=o(8481),$e=o(6856),Le=o(128),Pe=o(7082),Ne=o(54),Ie=o(9302),Me=o(4334),Oe=o(7191),Ce=o(1769),Be=o(732),De=o(6829),je=o(9802),ze=o(3427),Ze=o(5961),He=o(9457),Re=o(3418),qe=o(9068),Ue=o(4746),Fe=o(6667),Ge=o(4524),Ve=o(6106),We=o(6922),Je=o(8757);const Ye=Ee.NB.create({name:"topicDoc",topNode:!0,content:"topicTitle topicSummary topicFirstLine block*",addProseMirrorPlugins:()=>[new We.Sy({key:new We.H$("TopicDoc Decorations"),props:{decorations:({doc:e,selection:t})=>{const o=[],n=e.content.child(0),i=e.content.child(1),r=e.content.child(2);return 0===n.content.size?o.push(Je.p.node(0,n.nodeSize,{class:"empty"})):t.to<=n.nodeSize+i.nodeSize&&o.push(Je.p.node(0,n.nodeSize,{class:"focused"})),0===i.content.size?o.push(Je.p.node(n.nodeSize,n.nodeSize+i.nodeSize,{class:"empty"})):t.to<=n.nodeSize+i.nodeSize&&o.push(Je.p.node(n.nodeSize,n.nodeSize+i.nodeSize,{class:"focused"})),e.content.lastChild===r&&0===r.content.size&&o.push(Je.p.node(n.nodeSize+i.nodeSize,n.nodeSize+i.nodeSize+r.nodeSize,{class:"empty"})),Je.EH.create(e,o)}}})]});var Ke=o(9059),Qe=o(9586);const Xe=Ee.NB.create({name:"topicFirstLine",group:"topicDoc",content:"inline*",addAttributes:()=>({"data-placeholder":{default:"Take a notes"}}),parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",(0,Ee.P1)(this.options.HTMLAttributes,e),0]}});const et=o(8802).rU.extend({renderHTML(e){return"function"==typeof this.options.onRenderHTML&&this.options.onRenderHTML(e),["a",(0,Ee.P1)(this.options.HTMLAttributes,e.HTMLAttributes),0]}});var tt=o(3861);const ot=Ee.NB.create({name:"aside",defaultOptions:{HTMLAttributes:{}},content:"block*",group:"block",defining:!0,parseHTML:()=>[{tag:"aside"}],renderHTML({HTMLAttributes:e}){return["aside",(0,Ee.P1)(this.options.HTMLAttributes,e),0]},addCommands:()=>({setAside:()=>({commands:e})=>e.wrapIn("aside"),toggleAside:()=>({commands:e})=>e.toggleWrap("aside"),unsetAside:()=>({commands:e})=>e.lift("aside")})});var nt=o(8638);const it=o(9889).dn.extend({name:"hljsCodeBlock",content:"hljsCodeBlockRow+",topNode:!0,parseHTML:()=>[{preserveWhitespace:"full",tag:"pre"}],renderHTML({HTMLAttributes:e}){return["pre",this.options.HTMLAttributes,["code",e,0]]}}),rt=Ee.vc.create({name:"hljsMark",spanning:!1,group:"hljsCodeBlock hljsCodeBlockRow",defaultOptions:{HTMLAttributes:{}},addAttributes:()=>({class:{default:void 0}}),parseHTML:()=>[{tag:"span",preserveWhitespace:!0}],renderHTML({HTMLAttributes:e}){return["span",(0,Ee.P1)(this.options.HTMLAttributes,e),0]}}),at=Ee.NB.create({name:"hljsCodeBlockRow",defaultOptions:{HTMLAttributes:{}},group:"hljsCodeBlock",content:"inline*",marks:"hljsMark",addAttributes:()=>({class:{default:"l"}}),parseHTML:()=>[{tag:"div.l",preserveWhitespace:"full",attrs:{class:"l"}}],renderHTML({HTMLAttributes:e,node:t}){return["div",(0,Ee.P1)(this.options.HTMLAttributes,e),0]}});var lt=o(896),st=o(837),dt=o(9622),ct=o(2247),ut=o(4085),pt=o(1042),gt=o(836),ht=o(6167),ft=o(5688);st.Z.registerLanguage("javascript",dt.Z),st.Z.registerLanguage("typescript",ct.Z),st.Z.registerLanguage("sql",ut.Z),st.Z.registerLanguage("xml",pt.Z),st.Z.registerLanguage("css",gt.Z),st.Z.registerLanguage("bash",ht.Z),st.Z.registerLanguage("yaml",ft.Z);const mt=["javascript","typescript","sql","xml","css","bash","yaml"];function bt(e){const t=st.Z.highlightAuto(e,mt).value.split("\n");let o="";const n=[it,qe.Z,at,rt],i=document.createElement("pre");for(const e of t)o+=`<div class="l">${e||""}</div>`;i.innerHTML=o;const r=function(e,t){const o=(0,Ee.J1)(t);return nt.aw.fromSchema(o).parse(e,{preserveWhitespace:"full"})}(i,n);return i.remove(),n.length=0,r.toJSON()}function _t(e,t,o){return new lt.VK(e,((e,n,i,r)=>{const a=o instanceof Function?o(n):o,{tr:l}=e;return n[0]&&(l.replaceWith(i-1,r,t.create(a,e.schema.node("hljsCodeBlockRow"))),l.setSelection(We.Bs.create(l.doc,r-1))),l}))}function yt(e){let t="";return e.content.forEach(((o,n)=>{t+=o.textContent,n+o.nodeSize<e.nodeSize-2&&(t+="\n")})),t}const vt=/^```(?<language>[a-z]*)? $/,wt=/^~~~(?<language>[a-z]*)? $/,kt=Ee.NB.create({name:"hljsCodeBlock",content:"(hljsCodeBlockRow|paragraph?)+",isolating:!0,defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{},printContentAsHTML:!1},marks:"",group:"block",defining:!0,addAttributes(){return{autocomplete:{default:"off"},autocorrect:{default:"off"},autocapitalize:{default:"off"},spellcheck:{default:"false"},language:{default:null,parseHTML:e=>{var t;const o=null===(t=e.firstElementChild)||void 0===t?void 0:t.getAttribute("class");if(!o)return null;const n=new RegExp(`^(${this.options.languageClassPrefix})`);return{language:o.replace(n,"")}},renderHTML:e=>e.language?{class:this.options.languageClassPrefix+e.language}:null}}},parseHTML:()=>[{preserveWhitespace:"full",tag:"pre",getContent(e,t){let o="";e.childNodes.forEach((e=>{o+=e.textContent,"BR"===e.nodeName&&(o+="\n")}));const n=bt(o);return t.nodeFromJSON(n).content}},{tag:"div",preserveWhitespace:"full",getAttrs:e=>"pre"===e.style.whiteSpace&&null,getContent(e,t){let o="";e.childNodes.forEach((e=>{o+=e.textContent+"\n"}));const n=bt(o);return t.nodeFromJSON(n).content}}],renderHTML({HTMLAttributes:e,node:t}){const o=this.options.printContentAsHTML?0:yt(t);return["pre",this.options.HTMLAttributes,["code",e,o]]},addCommands(){return{setHljsCodeBlock:e=>t=>{const o=t.state.selection.content();let n="";o.content.forEach(((e,t)=>{n+=e.textContent,t+e.nodeSize<o.content.size-2&&(n+="\n")}));const i=bt(n),r=t.editor.schema.nodeFromJSON(i).content.toJSON()||[];return t.chain().insertContent({type:this.name,attrs:e,content:r}).setTextSelection(t.state.selection.$to.end()-1).run()},toggleHljsCodeBlock:e=>t=>{const o=t.state.selection.content().content;if(null!=o.firstChild&&o.firstChild.type===this.type){let e="";return o.forEach(((t,n)=>{t.type===this.type?e+=yt(t):e+=t.textContent,n+t.nodeSize<o.size-2&&(e+="\n")})),t.chain().deleteRange({from:t.state.selection.from-2,to:t.state.selection.to}).insertContent({type:"paragraph",content:[{type:"text",text:e}]}).setTextSelection(t.state.selection.$to.end()).run()}return t.commands.setHljsCodeBlock(e)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleHljsCodeBlock(),"Mod-Enter":()=>{const{$anchor:e}=this.editor.state.selection;if("hljsCodeBlockRow"!==e.parent.type.name)return!1;const{tr:t}=this.editor.state;return this.editor.view.dispatch(t.insert(e.pos,this.editor.schema.node("paragraph",{})).split(e.pos+1,1).replaceWith(e.pos+2,e.pos+4,this.editor.schema.node("paragraph",{})).setSelection(We.Bs.create(t.doc,e.pos+2))),!0},Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,o=this.editor.state.doc.nodeAt(t.pos-2);return!((null==o?void 0:o.type)!==this.type||1!==o.content.childCount||!e)&&this.editor.commands.insertContentAt({from:t.pos-2,to:t.pos-2+o.nodeSize},{type:"paragraph"})}}},addInputRules(){return[_t(vt,this.type,(({groups:e})=>e)),_t(wt,this.type,(({groups:e})=>e))]},addNodeView(){return({editor:e,node:t,getPos:o})=>{const n=document.createElement("pre"),i=document.createElement("code");for(const e in t.attrs)i.setAttribute(e,t.attrs[e]);return 0===t.content.size&&"function"==typeof o&&requestAnimationFrame((()=>{e.view.dispatch(e.view.state.tr.insert(o()+1,e.schema.node("hljsCodeBlockRow")))})),n.appendChild(i),{dom:n,contentDOM:i,update:t=>{if(t.type!==this.type)return!1;const o=bt(yt(t)),n=e.schema.nodeFromJSON(o);t.content=n.content}}}}}),xt=Ee.NB.create({name:"codeBlock",defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{}},content:"text*",marks:"",group:"block",code:!0,defining:!0,parseHTML:()=>[{preserveWhitespace:"full",tag:"pre"}],renderHTML({HTMLAttributes:e}){return["pre",this.options.HTMLAttributes,["code",e,0]]},addNodeView:()=>({editor:e,node:t,getPos:o})=>{const n=t.content.firstChild;if(1===t.content.childCount&&null!=n&&"function"==typeof o)return requestAnimationFrame((()=>{const i=bt(n.text||""),r=e.schema.nodeFromJSON(i);e.view.dispatch(e.view.state.tr.deleteRange(o(),o()+t.nodeSize-1).insert(o(),r))})),{ignoreMutation:!0,update:!1};{const e=document.createElement("pre"),t=document.createElement("code");return e.appendChild(t),{dom:e,contentDOM:t}}}});function At(e,t=!1){return(0,Ee.ar)(e,Tt(t,!0))}function Tt(e=!1,t=!1){return[...e?[Ye,Ke.l,Qe.V,Xe]:[Se.Z],He.Z,qe.Z,Le.ZP,je.ZP,Ne.ZP,Re.ZP,Oe.Z,Ce.Z,$e.ZP,Pe.ZP,Ze.ZP,ze.Z,De.Z,Be.Z,Ie.Z,Me.Z,Ue.Z,Fe.ZP,Ge.ZP,kt.configure({printContentAsHTML:t}),rt,at,xt,Ve.Bc,ot,et.configure({onRenderHTML:()=>{setTimeout((()=>{document.querySelectorAll("a[href]").forEach((e=>{null==e._tippy&&(0,tt.ZP)(e,{delay:[300,200],placement:"bottom",content:e=>e.href})}))}),1)}})]}var Et=o(3135),St=o(4217),$t=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};function Lt(e,t=`${document.location.origin}/drafts`){return $t(this,void 0,void 0,(function*(){return new Promise((o=>{R.pipe((0,St.q)(1)).subscribe((e=>{var o;null!=(null===(o=e.data)||void 0===o?void 0:o.idToken)||e.isLoading||d.dispatch({type:l.AUTH,payload:{redirectUri:t}})})),R.pipe((0,ae.P)((e=>null!=e.data&&!e.isLoading))).subscribe((t=>{console.log("authorizedWork AUTH_ACTION.AUTH_DONE"),o(e(t.data))}))}))}))}var Pt=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};function Nt(e,t){return Pt(this,void 0,void 0,(function*(){return Lt((()=>Pt(this,void 0,void 0,(function*(){try{const{update_draft_by_pk:o}=yield Ae().updateDraftTOC({id:t,table_of_contents:e,updated_at:(new Date).toISOString()});null!=o&&d.dispatch({type:Te.UPDATE_TOC_DONE,payload:{id:t,toc:o.table_of_contents}})}catch(e){d.dispatch({type:Te.UPDATE_TOC_ERROR,payload:{id:t,error:e}})}}))))}))}function It(e){return Pt(this,void 0,void 0,(function*(){Lt((t=>Pt(this,void 0,void 0,(function*(){var o,n;const i="Title is too small",r="Content cannot be empty",a="Title was not found",l="Author was not found";let s,d="",c="",u="";for(const t of e.pages||[]){const e=0===t.order,o=t.content;if(null==o.content)throw alert(r),new Error(r);u+=`<section>${At(o,e)}</section>`,e&&(s=(0,f.WV)(o),d=s.title.trim(),c=(0,f.u)(d).replace(/[^a-zA-Z0-9-_]/g,"-"))}if(null==s)throw alert(a),new Error(a);if(d.length<2)throw alert(i),new Error(i);const p=(yield Ae().findAuthorByAuth0({auth0_id:t.userInfo.auth0Id})).author[0];if(null==p)throw alert(l),new Error(l);const g={created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};if(null!=e.notes&&e.notes.length>0){const t=e.notes[0],o=(yield Ae().updateNode({id:t.id,name:c,preview:s,static_link:`note/${c}`,updated_at:g.updated_at})).update_note_by_pk;g.created_at=null==o?void 0:o.created_at,g.created_at=null==o?void 0:o.created_at}else{const t=(yield Ae().createNode({draft_id:e.id,author_id:p.id,name:c,preview:s,static_link:`note/${c}`,created_at:(new Date).toISOString()})).insert_note_one;g.created_at=null==t?void 0:t.created_at,g.created_at=null==t?void 0:t.created_at}const h=(yield Ae().getAllNotes()).notes;!function(e){const t=document.createElement("a");e.forEach((e=>{const o=new Blob([e.content],{type:e.type||"application/octet-stream"});t.href=window.URL.createObjectURL(o),t.download=e.name,t.click()})),t.remove()}([{content:`  \n    <html>\n      <head>\n        <meta charset="utf-8">\n        <title>${d}</title>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">\n        <meta name="format-detection" content="telephone=no">\n        <meta http-equiv="X-UA-Compatible" content="IE=edge">\n        <meta name="MobileOptimized" content="176">\n        <meta name="HandheldFriendly" content="True">\n        <meta name="robots" content="index, follow">\n        <meta name="description" content="${s.description}">\n        <meta property="og:site_name" content="inscriptum">\n        <meta property="og:type" content="article">\n        <meta property="og:title" content="${d}">\n        <meta property="og:description" content="${s.description}">\n        <meta property="og:image" content="${s.image}">\n        <meta property="article:published_time" content="${g.created_at}">\n        <meta property="article:modified_time" content="${g.updated_at}">\n        <meta property="article:author" content="${p.name||p.email}">\n        <meta name="twitter:card" content="summary">\n        <meta name="twitter:title" content="${d}">\n        <meta name="twitter:description" content="${s.description}">\n        <meta name="twitter:image" content="${s.image}">\n        ${(null===(n=null===(o=document.styleSheets.item(0))||void 0===o?void 0:o.ownerNode)||void 0===n?void 0:n.outerHTML)||""}\n        <link rel="shortcut icon" type="image/png" href="favicon.png">\n        <link href="/css/note.css" rel="stylesheet">\n        <link href="/css/custom_editor_fonts.css" rel="stylesheet">\n      </head>\n      <body>\n        <article>\n          ${u}\n        </article>\n      </body>\n      <script type="text/javascript" src="/js/note.js"><\/script>\n    </html>`,name:`${c}.html`},{content:JSON.stringify(h,null,2),name:Et.v.nodeListFileName}])}))))}))}const Mt={LOAD_DONE:Symbol("[MARGIN_ACTION] LOAD_DONE"),LOAD_FAIL:Symbol("[MARGIN_ACTION] LOAD_FAIL"),SAVE_DONE:Symbol("[MARGIN_ACTION] SAVE_DONE"),SAVE_FAIL:Symbol("[MARGIN_ACTION] SAVE_FAIL")};var Ot=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};const Ct={data:void 0,isLoading:!1};function Bt(e,t){switch(t.type){case Mt.LOAD_DONE:return{data:t.payload,isLoading:!1,error:null};case Mt.LOAD_FAIL:return Object.assign(Object.assign({},e),{isLoading:!1,error:t.payload.error});case Mt.SAVE_FAIL:return Object.assign(Object.assign({},e),{error:t.payload.error});default:return e}}var Dt=o(9491),jt=o(7672);const zt=(0,h.NG)((function*(){for(;;)yield v(g.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file-download" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
        <line x1="12" y1="11" x2="12" y2="17"></line>
        <polyline points="9 14 12 17 15 14"></polyline>
      </svg>
    `,this)})),Zt=(0,h.NG)((function*(){for(;;)yield v(g.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-eraser" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M19 19h-11l-4 -4a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9 9"></path>
        <line x1="18" y1="12.3" x2="11.7" y2="6"></line>
      </svg>
    `,this)})),Ht=(0,h.NG)((function*(){for(;;)yield v(g.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-device-floppy" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"></path>
        <circle cx="12" cy="14" r="2"></circle>
        <polyline points="14 4 14 8 8 8 8 4"></polyline>
      </svg>
    `,this)})),Rt=(0,h.NG)((function*(){for(;;)yield v(g.YP`
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
      </svg>
    `,this)})),qt=(0,h.NG)((function*(e={strokeWidth:"1"}){for(;;)e=yield v(g.YP`
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        class="icon icon-tabler icon-tabler-ripple" 
        width="24" 
        height="24" 
        viewBox="0 0 24 24" 
        stroke-width=${e.strokeWidth} 
        stroke="currentColor" 
        fill="none" 
        stroke-linecap="round" 
        stroke-linejoin="round"
      >
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M3 12c3 -2 6 -2 9 0s6 2 9 0"></path>
      </svg>
    `,this)})),Ut=zt(),Ft=Ht(),Gt=Zt(),Vt=Rt(),Wt=qt(),Jt=((0,h.EG)({props:{data:h.p.req()}})((function*(e){const t=(0,Dt.V)();let o,n,i=e.data;const r=()=>{const e=this,i=t.value;if(null==e||null==i)return void console.warn("Can not find a canvas element!");const r=i.getContext("2d");if(null==o){const t=Math.max(window.devicePixelRatio||1,1);let r=e.getBoundingClientRect().height;r=r>window.innerHeight?r:window.innerHeight;const a=e.getBoundingClientRect().width;function l(){var e;if(null!=i){var t=Math.max(window.devicePixelRatio||1,1);i.width=i.offsetWidth*t,i.height=i.offsetHeight*t,null===(e=i.getContext("2d"))||void 0===e||e.scale(t,t)}}i.height=r,i.width=a,i.style.height=`${r}px`,i.style.width=`${a}px`,this.style.height=`${r}px`,n={height:r,width:a,ratio:t},o=new jt.Z(i,{backgroundColor:"rgb(255, 255, 255)",minDistance:1}),window.onresize=l,l(),this.next()}else null!=r&&(console.log(r.globalCompositeOperation),r.globalCompositeOperation="source-over")},a=()=>{if(null==o||o.isEmpty())return alert("Please provide a signature first.");null!=(null==i?void 0:i.id)&&null!=n&&function(e,t,o){Ot(this,void 0,void 0,(function*(){const[n,i]=t.split(",");return yield Lt((()=>Ot(this,void 0,void 0,(function*(){const{update_margin_by_pk:t}=yield Ae().saveMargin({id:e,options:Object.assign(Object.assign({},o),{type:n}),img:i,updated_at:(new Date).toISOString()});if(null!=t)return d.dispatch({type:Mt.SAVE_DONE,payload:t}),t;d.dispatch({type:Mt.SAVE_FAIL,payload:{id:e,error:{message:`The Margin ${e} has not been saved!`}}})}))))}))}(i.id,o.toDataURL(),n)},l=()=>{if(null!=o&&null!=n&&null!=(null==i?void 0:i.imgBase64)&&null!=(null==i?void 0:i.options)){const e=i.options,t=`${e.type},${i.imgBase64}`;n.width<e.width?o.fromDataURL(t,{height:e.height*n.width/e.width,width:n.width,ratio:n.ratio}):o.fromDataURL(t,{height:e.height,width:e.width,ratio:n.ratio})}};function s(){const e=t.value;if(null==this||null==e)return void console.warn("Can not find a canvas element!");const o=e.getContext("2d");null!=o&&(o.globalCompositeOperation="destination-out")}function c(){null!=o&&o.clear()}function u(e,t){return()=>{null!=o&&(o.minWidth=e,o.maxWidth=t,console.log(e,t))}}function p(e){if(null!=(null==e?void 0:e.currentTarget)&&null!=o){const t=e.currentTarget;console.log(t.value),o.penColor=t.value}}for(l();;)i!==e.data&&(i=e.data,l()),e=yield(0,g.sY)(g.dy`
        <canvas .ref=${(0,Dt.i)(t)} id="signature-pad" class="signature-pad"></canvas>
        <div class="fab-container fab-container_main">
          <button class="fab-button">
            <input type="color" id=${`${i.id}_colorPicker`} name="colorPicker" style=${f.iv`
                cursor: pointer;
              `} @change=${p}>
          </button>
          <div class="fab-container fab-container_vertical">
            <button class="fab-button" @click=${u(6,8)}>
              ${Wt({strokeWidth:"6"})}
            </button>
            <button class="fab-button" @click=${u(2.5,4)}>
              ${Wt({strokeWidth:"4"})}
            </button>
            <button class="fab-button" @click=${u(.3,1)}>
              ${Wt({strokeWidth:"1"})}
            </button>
            <button class="fab-button fab-button_lg" @click=${u(.5,2.5)}>
              ${Wt({strokeWidth:"2"})}
            </button>
          </div>
          <div class="fab-container fab-container_vertical">
          <button class="fab-button" @click=${c}>
            ${Vt({})}
          </button>
          <button class="fab-button fab-button_lg" @click=${s}>
            ${Gt({})}
          </button>
        </div>
        <div class="fab-container fab-container_vertical">
          <button class="fab-button" @click=${l}>
            ${Ut({})}
          </button>
          <button class="fab-button fab-button_lg" @click=${a}>
            ${Ft({})}
          </button>
        </div>
          <button class="fab-button fab-button_lg" @click=${r}>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4"></path>
              <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
            </svg>
          </button>
        </div>
      `,this)}))("sketch-pad"),(0,i.EG)({props:{marginId:String,pageId:String},render:n.sY,shadow:{mode:"open"}})((function(e){const[t,r]=(0,i._Y)(Bt,Ct);return(0,i.d4)((()=>{const t=(o=e.marginId,d.$.pipe(H(Mt),(0,A.h)((e=>e.payload.id===o)))).subscribe((e=>r(e)));var o;return null!=e.marginId&&function(e){Ot(this,void 0,void 0,(function*(){return yield Lt((()=>Ot(this,void 0,void 0,(function*(){const{margin:t}=yield Ae().getMarginById({id:e});if(null!=t)return d.dispatch({type:Mt.LOAD_DONE,payload:t}),t;throw d.dispatch({type:Mt.LOAD_FAIL,payload:{id:e,error:{message:`The Margin ${e} not found!`}}}),new Error(`The Margin ${e} not found!`)}))))}))}(e.marginId),()=>{t.unsubscribe()}}),[e.marginId]),n.dy`
      <style>${o(8608)}</style>
      ${t.data?n.dy`<sketch-pad style=${f.iv`
            width: 100%;
          `} .data=${t.data}></sketch-pad>`:""}
    `}))),Yt=String.raw,Kt=(0,i.EG)({props:{label:String,value:String,isFolded:Boolean,change:{}},shadow:{mode:"open"},render:n.sY})((function(e){const[t,o]=(0,i.eJ)(e.isFolded);(0,i.d4)((()=>{o(e.isFolded)}),[e.isFolded]);const r=(0,i.I4)((()=>{o((e=>!e)),e.change(e.value,!t)}),[t,o,e]);return(0,i.d4)((()=>{const e=Yt`
      :host {
        display: inline-flex;
        align-items: center;
        flex-direction: row;
        position: absolute;
        right: 100%;
        font-family: var(--font-family);
      }
      button,
      label {
        cursor: pointer;
        border: none;
        background-color: transparent;
      }
      button:focus {
        outline: 0;
      }
      .icon-tabler,
      label {
        stroke: var(--border-color);
        color: var(--border-color);
        transition: 0.2s;
      }

      :host(:hover) .icon-tabler {
        stroke: var(--dark-grey);
      }
      :host(:hover) label {
        color: var(--dark-grey);
      }
    `,t=null==this?void 0:this.shadowRoot;if(null!=t&&null!=t.adoptedStyleSheets){const o=new CSSStyleSheet;o.replaceSync(e),t.adoptedStyleSheets=[o]}}),[]),n.dy`
      <label for=${e.value}>${e.label}</label>
      <button id=${e.value} @click=${r}>
        ${n.YP`
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon icon-tabler icon-tabler-chevron-left"
            width="44"
            height="44"
            viewBox="0 0 24 24"
            stroke-width="0.5"
            stroke="#9e9e9e"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <polyline points=${t?"9 6 15 12 9 18":"6 9 12 15 18 9"} />
          </svg>        
        `}
      </button>
    `})),Qt=(0,n.XM)(((e,t)=>(null!=t.current&&(t.current.setValue(e),t.current.commit()),o=>{t.current=o,t.current.setValue(e)}))),Xt=(0,i.NG)({render:Qt})((()=>n.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file-plus" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
      <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
      <line x1="12" y1="11" x2="12" y2="17"></line>
      <line x1="9" y1="14" x2="15" y2="14"></line>
    </svg>
  `)),eo=(0,i.NG)({render:Qt})((()=>n.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-file-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M14 3v4a1 1 0 0 0 1 1h4"></path>
      <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"></path>
      <path d="M10 12l4 4m0 -4l-4 4"></path>
    </svg>
  `)),to={CREATE_MARGIN:Symbol("[PAGE_ACTION] CREATE_MARGIN"),CREATE_MARGIN_DONE:Symbol("[PAGE_ACTION] CREATE_MARGIN_DONE"),CREATE_MARGIN_FAIL:Symbol("[PAGE_ACTION] CREATE_MARGIN_FAIL")};var oo=o(4072),no=o(5631),io=o(1410),ro=o(3068),ao=o(3507),lo=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};function so(e){return e.pipe((0,ro.b)((e=>{d.dispatch({type:c.PAGE_SAVE,payload:{pageId:e.pageId,draftId:e.draftId}})})),(0,ao.b)(Et.v.isDevMode?3e3:1e4),(0,ro.b)((e=>{d.dispatch({type:c.PAGE_SAVING,payload:{pageId:e.pageId,draftId:e.draftId}})})),(0,S.w)((e=>(0,oo.D)(function(e,t,o){return lo(this,void 0,void 0,(function*(){return yield Lt((()=>lo(this,void 0,void 0,(function*(){try{return yield Ae().updatePageById({id:e,content:o,updated_at:(new Date).toISOString()}),{pageId:e,draftId:t,content:o}}catch(t){throw{pageId:e,error:t}}}))))}))}(e.pageId,e.draftId,e.content)).pipe((0,ro.b)((e=>{d.dispatch({type:c.PAGE_SAVE_DONE,payload:e})})),(0,L.K)((t=>(d.dispatch({type:c.PAGE_SAVE_FAIL,payload:{draftId:e.draftId,pageId:e.pageId,error:t}}),no.E)))))))}function co(e){return e.pipe((0,S.w)((e=>(0,io.P)((()=>lo(this,void 0,void 0,(function*(){return Lt((()=>lo(this,void 0,void 0,(function*(){var t;const{insert_page_one:o,update_page:n}=yield Ae().addPageToDraft({draft_id:e.draftId,order:e.order,created_at:(new Date).toISOString()});if(null==o)throw new Error("newPage == null");const i=null!==(t=null==n?void 0:n.returning)&&void 0!==t?t:[];return{draftId:e.draftId,newPage:o,updatedPages:i}}))))})))))),(0,ro.b)((e=>{const{draftId:t,updatedPages:o,newPage:n}=e;d.dispatch({type:c.DRAFT_ADD_PAGE_DONE,payload:{draftId:t,newPage:Object.assign(Object.assign({},n),{content:null==n?void 0:n.content,draftId:t}),updatedPages:o}})})))}function uo(e){return e.pipe((0,S.w)((e=>(0,io.P)((()=>lo(this,void 0,void 0,(function*(){return Lt((()=>lo(this,void 0,void 0,(function*(){var t;const{update_page_by_pk:o,update_page:n}=yield Ae().deletePage({id:e.pageId,ended_at:(new Date).toISOString(),draft_id:e.draftId,order:e.order}),i=null!==(t=null==n?void 0:n.returning)&&void 0!==t?t:[],r={id:null==o?void 0:o.id,order:e.order};return{draftId:e.draftId,deletedPage:r,updatedPages:i}}))))})))))),(0,ro.b)((e=>{d.dispatch({type:c.DRAFT_DELETE_PAGE_DONE,payload:{draftId:e.draftId,deletedPage:e.deletedPage,updatedPages:e.updatedPages}})})))}function po(e,t){switch(t.type){case to.CREATE_MARGIN_DONE:return null!=e.data&&(e.data.margins=[{id:t.payload.marginId},...e.data.margins]),e;default:return e}}const go=(0,i.NG)({render:Qt})((()=>n.YP`
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-writing" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"></path>
      <path d="M16 7h4"></path>
      <path d="M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"></path>
    </svg>
  `));function ho(e){const[t,o]=(0,i.eJ)();return(0,i.d4)((()=>{const t=new r.xQ;return o([e(t),e=>t.next(e)]),()=>t.unsubscribe()}),[]),t}function fo(){const[e]=(0,i.eJ)((()=>{let e;return{get current(){var t;return null===(t=null==e?void 0:e.committer)||void 0===t?void 0:t.element},ref:(0,n.XM)((()=>t=>{e=t}))}}));return e}var mo=o(7072);const bo=(0,i.EG)({props:{editor:{},className:String,tippyOptions:{},pluginKey:{type:String,default:mo.NM.options.pluginKey},shouldShow:{type:{},default:null}},render:n.sY})((function(e){const[t,o]=(0,i.eJ)(0),a=fo(),[l,s]=(0,i.eJ)(null);return(0,i.d4)((()=>{console.log("useEffect bubbleMenuElement"),cancelAnimationFrame(t);const{editor:n,tippyOptions:i}=e;o(requestAnimationFrame((()=>{null!=a.current&&n.registerPlugin((0,mo.q3)({editor:n,element:a.current,pluginKey:e.pluginKey,shouldShow:e.shouldShow}))})));const l=new r.xQ,d=({transaction:e})=>{e.steps.length>0?s(vo(n)):e.selection.empty?s(null):l.next()};return n.on("transaction",d),l.pipe((0,ao.b)(700)).subscribe((e=>{s(vo(n))})),()=>{console.log("DESTROY bubbleMenuElement"),l.unsubscribe(),n.off("transaction",d),cancelAnimationFrame(t),n.unregisterPlugin(mo.NM.options.pluginKey)}}),[a.current]),n.dy`<div .ref=${a.ref()} class=${e.className} style=${f.iv`
        visibility: 'hidden';
      `}>
      ${l}
    </div>`})),_o=["figure"],yo=["topicTitle"];function vo(e){const t=e.state.selection;return t instanceof We.qv&&_o.includes(t.node.type.name)||t instanceof We.Bs&&(yo.includes(t.$from.parent.type.name)||yo.includes(t.$to.parent.type.name))?null:n.dy`
      <button @click=${()=>e.chain().focus().toggleBold().run()} class=${e.isActive("bold")?"is-active":""}>
        bold
      </button>
      <button @click=${()=>e.chain().focus().toggleItalic().run()} class=${e.isActive("italic")?"is-active":""}>
        italic
      </button>
      <button @click=${()=>e.chain().focus().toggleStrike().run()} class=${e.isActive("strike")?"is-active":""}>
        strike
      </button>
      <button @click=${()=>e.chain().focus().toggleHighlight().run()} class=${e.isActive("highlight")?"is-active":""}>
        highlight
      </button>
      <button @click=${()=>{var t;const o=null!==(t=window.prompt("URL"))&&void 0!==t?t:"";e.chain().focus().toggleLink({href:o}).run()}} class=${e.isActive("link")?"is-active":""}>
        link
      </button>
      <button @click=${()=>e.chain().focus().toggleBlockquote().run()} class=${e.isActive("blockquote")?"is-active":""}>
        blockquote
      </button>
      <button @click=${()=>e.chain().focus().toggleAside().run()} class=${e.isActive("aside")?"is-active":""}>
        aside
      </button>

      <button @click=${()=>e.chain().focus().toggleHeading({level:2}).run()} class=${e.isActive("heading",{level:2})?"is-active":""}>
        h2
      </button>
      <button @click=${()=>e.chain().focus().toggleHeading({level:3}).run()} class=${e.isActive("heading",{level:3})?"is-active":""}>
        h3
      </button>
      <button @click=${()=>e.chain().focus().toggleHeading({level:4}).run()} class=${e.isActive("heading",{level:4})?"is-active":""}>
        h4
      </button>
      <button @click=${()=>e.chain().focus().toggleHljsCodeBlock().run()} class=${e.isActive("hljsCodeBlock")?"is-active":""}>
        ${"<>"}
      </button>
    `}var wo=o(9303),ko=o.n(wo),xo=o(8895),Ao=o.n(xo),To=o(3691),Eo=o(5039),So=o(9244),$o=o(1428),Lo=o(7443),Po=o(2415),No=o(8952),Io=o(1812),Mo=o(8926),Oo=o(9731),Co=o(7466),Bo=o(9296),Do=o(9022),jo=o(6885),zo=o(6681),Zo=o(3164),Ho=o(9733),Ro=o(3881),qo=o(3041),Uo=o(1888),Fo=o(5622),Go=o(3549),Vo=o(6136),Wo=o(6301),Jo=o(4099);let Yo=navigator.userAgent.toLowerCase(),Ko=(/opera/i.test(Yo)||/opr/i.test(Yo),/msie/i.test(Yo)&&!/opera/i.test(Yo)||/trident\//i.test(Yo)||/edge/i.test(Yo),/edge/i.test(Yo)&&/opera/i.test(Yo),/firefox/i.test(Yo),/chrome/i.test(Yo)&&/edge/i.test(Yo),!/chrome/i.test(Yo)&&/webkit|safari|khtml/i.test(Yo),/iphone/i.test(Yo),/ipod/i.test(Yo),/ipad/i.test(Yo),/android/i.test(Yo),/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(Yo)),Qo=/iphone|ipod|ipad/i.test(Yo);/opera mini|opera mobi/i.test(Yo),/opera mini/i.test(Yo),/mac/i.test(Yo);function Xo(e,t,o=!0){Co.LinkBlot.blotName="link",Co.LinkBlot.tagName="a",Co.LinkBlot.showLinkTooltip=t=>{e&&e.showLinkTooltip(t,t.value,(0,Vo.isEdit)(),i)},Co.LinkBlot.hideLinkTooltip=()=>e&&e.hideLinkTooltip(i),Bo.MyQuill.register(Co.LinkBlot,!0),zo.FigureBlot.blotName="blockFigure",zo.FigureBlot.tagName="figure",zo.FigureBlot.quillSetSelection=(e,t=0)=>i.setSelection(e,t,Eo.Z.sources.USER),zo.FigureBlot.quillDeleteText=(e,t,o=Eo.Z.sources.USER)=>i.deleteText(e,t,o),zo.FigureBlot.quillInsertText=(e,t)=>i.insertText(e,t,Eo.Z.sources.USER),zo.FigureBlot.draftSave=()=>(0,Vo.draftSave)(n,i),Bo.MyQuill.register(zo.FigureBlot,!0),Bo.MyQuill.register(Jo.DividerBlot),Bo.MyQuill.register({"modules/syntax":Fo.InsSyntaxModule,"formats/bold":Ho.Z,"formats/italic":Ro.Z,"formats/indent":Lo.a,"formats/list":$o.ListContinuer,"formats/list-item":So.H,"formats/code":Po.E,"formats/strike":No.Z},!0);var n=!1;Ko&&document.body.classList.add("mobile");var i=new Bo.MyQuill(t,{scrollingContainer:"html, body",readOnly:!0,modules:{syntax:{highlight:e=>Wo.default.highlightAuto(e).value},clipboard:{matchers:[r("h2",{blockHeader:!0}),r("h5",{blockSubheader:!0}),r("h6",{blockSubheader:!0}),["img",function(e,t){return e.src&&(0,Vo.sanitize)(e.src,["http","https","data"])?(new(Ao())).insert({blockFigure:{image:e.src,caption:e.alt||""}}):new(Ao())}],["video",function(e,t){return e.src&&(0,Vo.sanitize)(e.src,["http","https","data"])?(new(Ao())).insert({blockFigure:{video:e.src}}):new(Ao())}],["br",function(e,t){return console.log("modules.clipboard.matchers.br"),e.classList.contains("inline")?(new(Ao())).insert({textBreak:!0}):t}]]},keyboard:{bindings:{"required enter":{key:Io.Z.keys.ENTER,collapsed:!0,shiftKey:null,format:["blockTitle","blockDescription"],suffix:/^$/,handler:function(e,t){console.log("keyboard.bindings.required_enter.handler");let[o]=this.quill.scroll.descendant(Oo.FieldBlot,e.index);return!(o&&o.next&&o.next.domNode&&!o.next.domNode.textContent)||(this.quill.setSelection(o.next.offset(this.quill.scroll),0,Eo.Z.sources.USER),!1)}},"required tab prev":{key:Io.Z.keys.TAB,shiftKey:!0,handler:function(e,t){console.log("keyboard.bindings.required_tab_prev.handler");let o=null;if(e.length>0){let t=i.scroll.descendants(To.ZP,e.index,e.length);if(1!=t.length)return!0;o=t[0]}else[o]=i.scroll.descendant(To.ZP,e.index);if(null!=o&&null!=o.prev&&o.prev instanceof Oo.FieldBlot){let e=o.prev.offset(i.scroll),t=o.prev.length();return i.setSelection(e,t>1?t:0,Eo.Z.sources.USER),!1}return!0}},"required tab next":{key:Io.Z.keys.TAB,shiftKey:!1,handler:function(e,t){console.log("keyboard.bindings.required_tab_next.handler");let o=null;if(e.length>0){let t=i.scroll.descendants(To.ZP,e.index,e.length);if(1!=t.length)return!0;o=t[0]}else[o]=i.scroll.descendant(To.ZP,e.index);if(null!=o&&o instanceof Oo.FieldBlot&&null!=o.next){let e=o.next.offset(i.scroll);if(o.next instanceof Oo.FieldBlot){let t=o.next.length();i.setSelection(e,t>1?t:0,Eo.Z.sources.USER)}else i.setSelection(e,0,Eo.Z.sources.USER);return!1}return!0}},"no tab":{key:Io.Z.keys.TAB,shiftKey:null,handler:function(e,t){return console.log("keyboard.bindings.no_tab.handler"),!1}},"detect embed":{key:Io.Z.keys.ENTER,collapsed:!0,handler:function(t,o){console.log("keyboard.bindings.detect_embed.handler");let[n,r]=i.scroll.line(t.index);if(n){let o,a=n.domNode.textContent.substr(0,r);if(o=a.match(/(^|\s)(https?:\/\/\S+)$/)){let l=o[2];if(i.scroll.descendants(Co.LinkBlot,t.index-l.length,l.length).length||i.formatText(t.index-l.length,l.length,"link",l,Eo.Z.sources.USER),!a.substr(0,r-l.length).trim().length&&"P"==n.domNode.tagName){let t=s(l);if(t){let o=n.offset(i.scroll);return i.updateContents((new(Ao())).retain(o).delete(a.length).insert({blockFigure:t}),Eo.Z.sources.USER),e&&e.hideBlocksTooltip(),!1}}}}return!0}},"divider autofill":{key:Io.Z.keys.ENTER,collapsed:!0,prefix:/^([-*])\1{2,}$/,handler:function(e,t){console.log("keyboard.bindings.divider_autofill.handler");let[o,n]=i.scroll.line(e.index);if(o&&"P"==o.domNode.tagName){let e=o.offset(i.scroll),t=(new(Ao())).retain(e).delete(o.length()).insert({blockDivider:!0});return o.next||t.insert("\n"),i.updateContents(t,Eo.Z.sources.USER),!1}return!0}},break:{key:Io.Z.keys.ENTER,shiftKey:!0,handler:l.bind(null,!0)},enter:{key:Io.Z.keys.ENTER,handler:l.bind(null,!1)},"detect link":{key:" ",collapsed:!0,handler:function(e){console.log("detectLinkHandler",e);let[t,o]=i.scroll.line(e.index);if(t){let n,r=t.domNode.textContent.substr(0,o);if(n=r.match(/(^|\s)((?:https?|tg):\/\/\S+|www\.\S+)$/)){let t=n[2],o=t.length;"www."==t.substr(0,4)&&(t="http://"+t),i.scroll.descendants(Co.LinkBlot,e.index-o,o).length||i.formatText(e.index-o,o,"link",t,Eo.Z.sources.USER)}}return!0}},"cancel placeholder":{key:Io.Z.keys.ESCAPE,handler:function(e,t){return console.log("keyboard.bindings.cancel_placeholder.handler"),tn(),this.quill.updateSelection(Eo.Z.sources.USER),!0}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{list:!1,"code-block":!1,blockquote:!1,header:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(e,t){if(this.quill.scroll.query&&null==this.quill.scroll.query("list"))return!0;const{length:o}=t.prefix,[n,i]=this.quill.getLine(e.index);if(i>o)return!0;let r;switch(t.prefix.trim()){case"[]":case"[ ]":r="unchecked";break;case"[x]":r="checked";break;case"-":case"*":r="bullet";break;default:r={type:"ordered",start:Number(t.prefix.slice(0,-1))-1}}this.quill.insertText(e.index," ",Eo.Z.sources.USER),this.quill.history.cutoff(),console.log("keyboard.bindings.list_autofill.handler",e,t);const a=(new(Ao())).retain(e.index-i).delete(o+1).retain(n.length()-2-i).retain(1,{list:r,start:r.start});console.log("keyboard.bindings.list_autofill.handler",a);const l=this.quill.updateContents(a,Eo.Z.sources.USER);return console.log("keyboard.bindings.list_autofill.handler",l),this.quill.history.cutoff(),this.quill.setSelection(e.index-o,Eo.Z.sources.SILENT),!1}},"pre wrap":{key:192,collapsed:!0,format:{"code-block":!1},prefix:/^``$/,offset:2,handler:function(e,t){console.log("keyboard.bindings.pre_wrap.handler");let o=t.prefix.length,n=e.index-o;this.quill.scroll.deleteAt(n,o),this.quill.formatLine(n,1,"code-block",!0,Eo.Z.sources.USER),this.quill.setSelection(n,Eo.Z.sources.SILENT)}},code:{key:192,handler:function(e,t){if(console.log("keyboard.bindings.code.handler",!t.format),!t.collapsed){let o=i.scroll.descendants(To.ZP,e.index,e.length);if(o.length>1||1==o.length&&o[0]instanceof Go.dn)return this.quill.format("code-block",!t.format["code-block"],Eo.Z.sources.USER),!1;if(i.scroll.descendants(Mo.BreakBlot,e.index,e.length).length)return this.quill.format("code-block",!t.format["code-block"],Eo.Z.sources.USER),!1}if(t.collapsed&&!t.format.code&&!/\s$/.test(t.prefix))return!0;this.quill.format("code",!t.format.code,Eo.Z.sources.USER)}},"figure delete":{key:Io.Z.keys.BACKSPACE,collapsed:!0,offset:0,handler:function(e,t){console.log("keyboard.bindings.figure_delete.handler");let[o,n]=i.scroll.line(e.index);return!(o&&o.prev&&o.prev instanceof zo.FigureBlot)||(t.empty&&i.deleteText(e.index,1,Eo.Z.sources.USER),i.setSelection(o.prev.offset(i.scroll)),!1)}},"field backspace":{key:Io.Z.keys.BACKSPACE,collapsed:!0,offset:0,handler:function(e,t){console.log("keyboard.bindings.field_backspace.handler");let[o,n]=i.scroll.line(e.index);return!(o&&o.prev&&o.prev instanceof Oo.FieldBlot&&o.domNode.textContent.length>0)}},strikethrough:{key:"X",shortKey:!0,shiftKey:!0,handler:function(e,t){i.formatText(e,"strike",!t.format.strike)}}}}}});function r(e,t){return[e,function(e,o){return o.compose((new(Ao())).retain(o.length(),t))}]}function a(e){let t=function(e){let[t,o]=i.scroll.line(e);return i.getText(e,t.length()-o)}(e);return!t||"\n"==t}function l(e,t,o){console.log("breakHandler",e,t,o);let n,r=t.index;t.length>0&&i.scroll.deleteAt(r,t.length);let l=a(r),s=!1;return[n]=i.scroll.descendant(Mo.BreakBlot,r),n?(!n.prev||n.prev instanceof Mo.BreakBlot)&&(i.scroll.deleteAt(--r,1),s=!0):([n]=i.scroll.descendant(Mo.BreakBlot,r-1),n&&(i.scroll.deleteAt(--r,1),s=!0)),[n]=i.scroll.descendant(Do.SingleLineBlot,r),n||s||!e?(i.insertText(r,"\n",Eo.Z.sources.USER),i.setSelection(++r,0,Eo.Z.sources.USER),(o.format.blockHeader||o.format.blockSubheader||o.format.blockBlockquote||o.format.blockPullquote)&&l&&i.formatLine(r,1,{blockHeader:!1,blockSubheader:!1,blockBlockquote:!1,blockPullquote:!1},Eo.Z.sources.USER)):(i.insertEmbed(r,"textBreak",!0,Eo.Z.sources.USER),[n]=i.scroll.descendant(Mo.BreakBlot,r),!n||n.next||n.prev&&n.prev instanceof Mo.BreakBlot||(i.insertEmbed(++r,"textBreak",!0,Eo.Z.sources.SILENT),i.setSelection(r,0,Eo.Z.sources.SILENT))),!1}function s(e){let t;if((t=e.match(/^(https?):\/\/(www\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/i))||(t=e.match(/^(https?):\/\/(www\.)?youtu\.be\/([a-zA-Z0-9_-]+)/i)))return{embed:"/embed/youtube?url="+encodeURIComponent(e)};if(t=e.match(/^(https?):\/\/(www\.)?vimeo\.com\/(\d+)/i))return{embed:"/embed/vimeo?url="+encodeURIComponent(e)};if(t=e.match(/^(https?):\/\/(www\.|mobile\.)?twitter\.com\/(.+)\/status\/(\d+)/i))return{embed:"/embed/twitter?url="+encodeURIComponent(e)};if(t=e.match(/^(https?):\/\/(t\.me|telegram\.me|telegram\.dog)\/([a-zA-Z0-9_]+)\/(\d+)/i))return{embed:"/embed/telegram?url="+encodeURIComponent(e)};if(t=e.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/))return"video/"==t[1].substr(0,6)?{video:e}:{image:e};if(t=e.match(/^(https?):\/\/\S+/i)){let o=document.createElement("a");if(o.href=e,o.pathname.match(/\.(jpe?g|png|gif|mp4)$/i))return"mp4"==t[1]?{video:e}:{image:e}}return!1}function d(e){e.scroll.descendants(To.ZP,0,e.scroll.length()).forEach((e=>{if(e.domNode.hasAttribute("data-placeholder")){let t=e.domNode.textContent;e.domNode.classList.toggle("empty",!t)}}))}function c(e){if(o){let[t,o]=e.scroll.lines();if(t instanceof To.i2)e.updateContents((new(Ao())).insert("\n",{blockTitle:!0}).insert("\n",{blockDescription:!0}),Eo.Z.sources.SILENT);else if(t instanceof jo.TitleBlot||e.formatLine(0,1,{blockTitle:!0},Eo.Z.sources.SILENT),o){if(o instanceof To.i2){let t=o.offset(e.scroll);e.updateContents((new(Ao())).retain(t).insert("\n",{blockDescription:!0}),Eo.Z.sources.SILENT)}else if(!(o instanceof Zo.DescriptionBlot)){let t=o.offset(e.scroll);e.formatLine(t,1,{blockDescription:!0},Eo.Z.sources.SILENT)}}else{let t=e.scroll.length();e.updateContents((new(Ao())).retain(t).insert("\n",{blockDescription:!0}),Eo.Z.sources.SILENT)}let[,,n]=e.scroll.lines();if(n){let t=n.offset(e.scroll),o=e.scroll.length()-t;e.scroll.descendants(Oo.FieldBlot,t,o).forEach((t=>{let o=t.offset(e.scroll),n=t.length(),i=t.constructor.blotName;e.formatText(o,n,i,!1,Eo.Z.sources.SILENT)}))}else{let t=e.scroll.length();e.insertText(t,"\n",Eo.Z.sources.SILENT)}}const n=e.scroll.lines();t.querySelectorAll("[data-placeholder]").forEach((e=>e.removeAttribute("data-placeholder")));(o?3===n.length:1===n.length)&&n.forEach(((e,t)=>{if("P"==e.domNode.tagName){(o?2===t:0==t)&&e.domNode.setAttribute("data-placeholder","The page content...")}}))}function u(e){let t=e.querySelector(".prompt_input"),o=e.querySelector(".close");t.onkeydown=null,t.onblur=null,o.onclick=null,e.style.display="",e.classList.remove("tooltip_prompt"),i.focus()}return e&&i.addContainer(e),i.on(Eo.Z.events.TEXT_CHANGE,(function(){i.getSelection();c(i),d(i),tn(),(0,Vo.draftSave)(n,i)})),i.on(Eo.Z.events.SCROLL_OPTIMIZE,(function(e){e.forEach((e=>{if("childList"==e.type&&!e.addedNodes.length&&e.removedNodes.length){let t=e.previousSibling,o=e.nextSibling;if(!o&&t&&"BR"==t.tagName&&"inline"==t.className){let t=document.createElement("br");t.className="inline",e.target.appendChild(t)}else!o||!t||"BR"==t.tagName&&"inline"==t.className||"BR"!=o.tagName||"inline"!=o.className||o.nextSibling||o.parentNode&&o.parentNode.removeChild(o)}}))})),i.scroll.domNode.setAttribute("dir","auto"),document.addEventListener("click touchstart",(function(t){let o=t.target;for(;o;){if(o===i.container)return;o=o.parentNode}e&&e.hideFormatTooltip(i),e&&e.hideBlocksTooltip()})),c(i),d(i),e&&(e.$bold_button.onclick=e=>{console.log("$bold_button.onclick");let t=e.target.classList.contains("active");e.preventDefault(),console.log("$bold_button.onclick",!t),i.format("bold",!t),console.log("$bold_button.onclick",i.getSelection(!0)),i.updateSelection(Eo.Z.sources.API)}),e&&(e.$italic_button.onclick=e=>{let t=e.target.classList.contains("active");e.preventDefault(),i.format("italic",!t),i.updateSelection(Eo.Z.sources.API)}),e&&(e.$link_button.onclick=t=>{let o=t.target.classList.contains("active");t.preventDefault();var n=i.getSelection(!0);if(o){i.scroll.descendants(Co.LinkBlot,n.index,n.length).forEach((e=>{let t=e.offset(i.scroll),o=e.length();i.formatText(t,o,"link",!1)})),e&&en(n,i,e)}else e&&function(e,t,o){let n=e.querySelector(".prompt_input"),i=e.querySelector(".close");n.value="",n.setAttribute("placeholder",t),n.onkeydown=t=>{let i=t.which||t.keyCode;if(27==i)u(e);else if(13==i){let i=n.value;i&&(o&&o(i),t.preventDefault()),u(e)}},n.onblur=()=>{u(e)},i.onclick=()=>{u(e)},e.style.display="",e.classList.add("tooltip_prompt"),n.focus()}(e.$tl_tooltip,"Paste or type a link...",(function(t){"#"!=(t=t.trim()).substr(0,1)&&"/"!=t.substr(0,1)&&"http://"!=t.substr(0,7)&&"https://"!=t.substr(0,8)&&"tg://"!=t.substr(0,5)&&"mailto:"!=t.substr(0,7)&&(t=t.indexOf("@")>0?"mailto:"+t:"http://"+t),i.focus(),i.format("link",t),en(n,i,e)}))}),e&&(e.$header_button.onclick=e=>{let t=e.target.classList.contains("active");e.preventDefault();let o=i.getSelection(!0);i.format("blockHeader",!t),i.scroll.descendants(qo.HeaderBlot,o.index,o.length).forEach((e=>{let t=e.offset(i.scroll),o=e.length();i.formatText(t,o,{bold:!1,italic:!1,code:!1},Eo.Z.sources.SILENT)})),i.updateSelection(Eo.Z.sources.API)}),e&&(e.$subheader_button.onclick=e=>{let t=e.target.classList.contains("active");e.preventDefault();let o=i.getSelection(!0);i.format("blockSubheader",!t),i.scroll.descendants(Uo.SubheaderBlot,o.index,o.length).forEach((e=>{let t=e.offset(i.scroll),o=e.length();i.formatText(t,o,{bold:!1,italic:!1,code:!1},Eo.Z.sources.SILENT)})),i.updateSelection(Eo.Z.sources.API)}),e&&(e.$quote_button.onclick=e=>{let t=e.target,o=t.classList.contains("active"),n=t.classList.contains("pullquote");e.preventDefault();i.getSelection(!0);o?i.format("blockPullquote",!n):i.format("blockBlockquote",!0),i.updateSelection(Eo.Z.sources.API)}),e&&(e.$strikeButton.onclick=e=>{let t=e.target.classList.contains("active");e.preventDefault(),i.format("strike",!t),i.updateSelection(Eo.Z.sources.API)}),e&&(e.$image_button.onclick=()=>{let e=i.container.querySelector("input.ql-image[type=file][data-status=ready]");null==e&&(e=document.createElement("input"),e.setAttribute("type","file"),e.setAttribute("accept",Qo?"image/gif, image/jpeg, image/jpg, image/png":"image/gif, image/jpeg, image/jpg, image/png, video/mp4"),e.classList.add("ql-image"),e.addEventListener("change",(()=>{if(e&&null!=e.files&&null!=e.files[0]){var t=e.files[0];const o=function(){(0,Vo.showError)("File too big (up to 5 MB allowed)")},n=5242880;!function(e,t){if("image/jpg"==e.type||"image/jpeg"==e.type)return ko()(e,(o=>{if("error"===o.type)t(e);else if(o.toBlob)o.toBlob((function(e){t(e)}),e.type);else{var n=o.toDataURL(e.type),i={type:e.type,base64_data:n.split(",")[1]};t((0,Vo.uploadDataToBlob)(i))}}),{canvas:!0,orientation:!0});t(e)}(t,(t=>{if(t.size>n)return o&&o();var r=new FileReader;r.onload=function(t){if(t&&null!==t.target){let o=s(t.target.result);if(o){let e=i.getSelection(!0);i.updateContents((new(Ao())).retain(e.index).delete(e.length).insert({blockFigure:o}),Eo.Z.sources.USER)}else(0,Vo.showError)("Invalid file format");e.value="",e.setAttribute("data-status","ready")}},r.readAsDataURL(t)}))}})),i.container.appendChild(e)),e.setAttribute("data-status","busy"),e.click()}),e&&(e.$embed_button.onclick=t=>{let o=i.getSelection(!0),[n]=i.scroll.line(o.index);const r=n.domNode;if(n){r.textContent||(r.setAttribute("data-placeholder","Paste a YouTube, Vimeo or Twitter link, and press Enter"),r.classList.add("placeholder_once","empty"),e.hideBlocksTooltip())}}),window.addEventListener("scroll resize",(()=>{e&&e.tooltipUpdatePosition(e.$tl_tooltip,null,e.formatTTOptions,i),e&&e.tooltipUpdatePosition(e.$tl_link_tooltip,null,e.linkTTOptions,i)})),i}function en(e,t,o){let n=null==e?{}:t.getFormat(e),i=!!n.blockDescription,r=!(!n.blockHeader&&!n.blockSubheader),a=!!n["code-block"];if(o.$bold_button.classList.toggle("active",!!n.bold),o.$bold_button.classList.toggle("disabled",i||r||a),o.$italic_button.classList.toggle("active",!!n.italic),o.$italic_button.classList.toggle("disabled",i||r||a),o.$header_button.classList.toggle("active",!!n.blockHeader),o.$header_button.classList.toggle("disabled",i),o.$subheader_button.classList.toggle("active",!!n.blockSubheader),o.$subheader_button.classList.toggle("disabled",i),o.$quote_button.classList.toggle("active",!(!n.blockBlockquote&&!n.blockPullquote)),o.$quote_button.classList.toggle("pullquote",!!n.blockPullquote),o.$quote_button.classList.toggle("disabled",i),o.$strikeButton.classList.toggle("active",!!n.strike),o.$strikeButton.classList.toggle("disabled",i),null!=e){let n=t.scroll.descendants(Co.LinkBlot,e.index,e.length);o.$link_button.classList.toggle("active",!!n.length)}else o.$link_button.classList.toggle("active",!1);o.$link_button.classList.toggle("disabled",a)}function tn(){const e=document.querySelector(".placeholder_once");null!==e&&(e.removeAttribute("data-placeholder"),e.classList.remove("placeholder_once","empty"))}var on=o(8079),nn=o(9691);bo("inscriptum-redactor-bubble-menu");const rn=(0,i.EG)({props:{content:{type:{},default:null},cbOnUpdateContent:{type:{},default:()=>{}},isTitle:Boolean},render:n.sY})((function(e){const[t,r]=(0,i.eJ)(0),[a,l]=(0,i.eJ)(),s=fo();return(0,i.d4)((()=>(cancelAnimationFrame(t),r(requestAnimationFrame((()=>{const t=s.current;if(null!=t){let o=null;o=null!=e.content&&"object"==typeof e.content&&"ops"in e.content?function(e){const t=document.createElement("div"),o=document.createElement("template");o.append(t),document.body.append(o);const n=Xo(null,t);Oo.FieldBlot,on.BlockquoteBlot,nn.PullquoteBlot,Go.dn,So.H,jo.TitleBlot,To.ZP,n.setContents(e);const i=n.root.innerHTML;return t.remove(),o.remove(),"function"==typeof n.destroy&&n.destroy(),i}(e.content):e.content,l(function(e,t,o=!1,n){return new Ee.ML({element:e,content:t,onUpdate:null==n?void 0:n.onUpdate,extensions:Tt(o)})}(t,o,e.isTitle,{onUpdate:({editor:t})=>{e.cbOnUpdateContent(t.getJSON())}}))}}))),()=>{var e,o;console.log("DESTROY redactorElement"),null===(o=null===(e=s.current)||void 0===e?void 0:e.firstChild)||void 0===o||o.remove(),cancelAnimationFrame(t),null!=a&&a.destroy()})),[s.current,e.content,e.isTitle,e.cbOnUpdateContent]),n.dy`<div class="redactor">
      <style>${o(5257)}</style>
      <article .ref=${s.ref()} class="redactor__article"></article>
      ${null!=a&&n.dy`<inscriptum-redactor-bubble-menu .editor=${a}></inscriptum-redactor-bubble-menu>`}
    </div>`})),an=String.raw,ln=(rn("inscriptum-redactor"),Jt("inscriptum-margin"),Kt("inscriptum-folding"),Xt()),sn=eo(),dn=go(),cn=(0,i.EG)({props:{page:{type:{}}},render:n.sY})((function(e){const[t,o]=(0,i._Y)(po,{data:e.page,isLoading:!1});let[a,l]=(0,i.eJ)(e.page.content);const[s,d]=(0,i.eJ)(e.page.isFolded),[c,u]=ho(so),[p,g]=ho(co),[h,f]=ho(uo);(0,i.d4)((()=>{const n=function(e){const t=new r.xQ;return(0,C.T)(t)}(e.page.id).subscribe((e=>o(e)));return n.add(c.subscribe((e=>{null!=t.data&&(t.data.content=e.content)}))),n.add(p.subscribe()),n.add(h.subscribe()),()=>{n.unsubscribe()}}),[]),(0,i.d4)((()=>{var e;null!=(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.content)&&(null==a&&null!=t.data.content&&l(t.data.content),null!=t.data.isFolded&&s!==t.data.isFolded&&(t.data.isFolded||l(t.data.content)))}),[t,a,s,l,d]);const m=(0,i.I4)((e=>{null!=t.data&&(u({pageId:t.data.id,draftId:t.data.draftId,content:e}),null!=a?a.content=e.content:a=e)}),[t,u,a]),b=(0,i.I4)((e=>()=>{var o;null!=(null===(o=t.data)||void 0===o?void 0:o.draftId)&&g({draftId:t.data.draftId,order:e})}),[t.data,u]),_=(0,i.I4)((()=>{null!=t.data&&f({draftId:t.data.draftId,pageId:t.data.id,order:t.data.order})}),[t.data]),y=(0,i.I4)((()=>{var e;null!=(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.id)&&function(e,t){lo(this,void 0,void 0,(function*(){return yield Lt((()=>lo(this,void 0,void 0,(function*(){const{insert_margin_one:o}=yield Ae().createMargin({page_id:e,created_at:(new Date).toISOString()});if(null!=(null==o?void 0:o.id))return t({type:to.CREATE_MARGIN_DONE,payload:{pageId:e,marginId:o.id}}),o;t({type:to.CREATE_MARGIN_FAIL,payload:{pageId:e,error:{massage:`Can not create a new Margin for Page ${e}!`}}})}))))}))}(t.data.id,o)}),[t]);if(null!=(null==t?void 0:t.data)){const e=n.dy`<div class="page__controls">
        <div>
          <button class="btn btn_icon" title="add a new page" @click=${b(t.data.order+1)}>
            ${ln({})}
          </button>
          ${t.data.order>0?n.dy`<button class="btn btn_icon" title="delete this page" @click=${_}>
              ${sn({})}
            </button>`:null}
        </div>
        <div>
          ${s?null:n.dy`<button class="btn btn_icon" title="create new margin" @click=${y}>
              ${dn({})}
            </button>`}
        </div>
      </div>`;return n.dy`
        <inscriptum-folding .label=${t.data.order>0?String(t.data.order):""} .value=${t.data.id} .isFolded=${s} .change=${(e,t)=>d(t)}></inscriptum-folding>
        ${s?n.dy`
            <span style=${an`
                display: flex;
                justify-content: center;
                font-size: 1.6rem;
                cursor: pointer;
              `} @click=${()=>d(!1)}>
              ...
            </span>
            ${e}
          `:n.dy`<div class="row" style=${an`
              display: flex;
              width: 100%;
            `}>
            <div style=${an`
                min-width: 732px;
                padding: 1rem 0 0 0;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
              `}>
              
              <inscriptum-redactor .content=${a} .cbOnUpdateContent=${m} .isTitle=${0===t.data.order}></inscriptum-redactor>
              ${e}
            </div>
            ${t.data.margins.length>0?n.dy`<inscriptum-margin .pageId=${t.data.id} .marginId=${t.data.margins[0].id}></inscriptum-margin>`:null}
          </div>`}
      `}})),un=(0,h.EG)({props:{items:h.p.req()}})((function*(e){var t,i;for(;;)e=yield(0,n.sY)(n.dy`
        <style>${o(7135)}</style>
        <nav class="toc-panel">
          <ul class="toc-panel__list">
            <li class="toc-panel__title">${null!==(i=null===(t=e.items[0])||void 0===t?void 0:t.header)&&void 0!==i?i:"In this article"}</li>
            ${e.items.slice(1).map(((e,t)=>{var o;return n.dy`<li class="toc-panel__item">
                <span class="toc-panel__page-numb">${t+1}</span>
                <a class=${"toc-panel__header "+(t+1===0?"toc-panel__header_selected":"")}>${null!==(o=null==e?void 0:e.header)&&void 0!==o?o:"..."}</a>
              </li>`}))}

            
          </ul>
        </nav>
      `,this)}));function pn(e,t){var o,n,i,r,a,l,s,d;switch(t.type){case Te.LOAD:case Te.LOADING:return Object.assign(Object.assign({},e),{isLoading:!0});case Te.LOAD_DONE:if((null===(o=t.payload.pages)||void 0===o?void 0:o.length)!==t.payload.table_of_contents.length){t.payload.table_of_contents=[];for(const e of null!==(n=t.payload.pages)&&void 0!==n?n:[])t.payload.table_of_contents.push({header:gn(e.content),pageId:e.id});Nt(t.payload.table_of_contents,t.payload.id)}return Object.assign(Object.assign({},e),{data:t.payload,isLoading:!1});case c.DRAFT_ADD_PAGE_DONE:if(null!=e.data&&null!=t.payload.newPage){const o=null!==(i=e.data.pages)&&void 0!==i?i:[];for(const e of o){const o=t.payload.updatedPages.find((t=>t.id===e.id));null!=o&&(e.order=o.order)}o.push(t.payload.newPage);const n=e.data.table_of_contents;return Nt([...n.slice(0,t.payload.newPage.order),{header:"...",pageId:t.payload.newPage.id},...n.slice(t.payload.newPage.order)],e.data.id),Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{pages:o.sort(((e,t)=>e.order-t.order))})})}return e;case c.DRAFT_DELETE_PAGE_DONE:if(null!=e.data){const o=(null!==(r=e.data.pages)&&void 0!==r?r:[]).filter((e=>e.id!==t.payload.deletedPage.id));for(const e of o){const o=t.payload.updatedPages.find((t=>t.id===e.id));null!=o&&(e.order=o.order)}const n=e.data.table_of_contents;return Nt([...n.slice(0,t.payload.deletedPage.order),...n.slice(t.payload.deletedPage.order+1)],e.data.id),Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{pages:o.sort(((e,t)=>e.order-t.order))})})}return e;case Te.UPDATE_TOC_DONE:return null!=e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{table_of_contents:t.payload.toc})}):e;case Te.UPDATE_TOC_ERROR:return console.warn(t.payload.error),e;case c.PAGE_SAVE_DONE:if(null!=e.data){const o=null!==(s=null===(l=null===(a=e.data.pages)||void 0===a?void 0:a.find((e=>e.id===t.payload.pageId)))||void 0===l?void 0:l.order)&&void 0!==s?s:-1,n=e.data.table_of_contents;let i=gn(t.payload.content);n[o]=null!==(d=n[o])&&void 0!==d?d:{},o>-1&&n[o].header!==String(i)&&(n[o]={header:String(i),pageId:t.payload.pageId},Nt(n,e.data.id))}return e;case c.DRAFT_PUBLISH:return null!=e.data?It(e.data):alert("Error: the draft cannot be published. The draft state is null."),e;default:return e}}function gn(e){var t;let o="...";return null==e||("ops"in e&&(o=e.ops[0].insert),"type"in e&&Array.isArray(e.content)&&Array.isArray(e.content[0].content)&&"text"===e.content[0].content[0].type&&(o=null!==(t=e.content[0].content[0].text)&&void 0!==t?t:o)),o}const hn=String.raw,fn=(cn("inscriptum-page"),(0,p.s)("loading-progress-bar"),un("inscriptum-table-of-content"),k("inscriptum-controls-panel"),(0,i.EG)({props:{id:{type:String,attribute:"data-id"}},render:n.sY})((function(e){var t,r,a,l;const[s,p]=(0,i._Y)(pn,{isLoading:!1}),[g,h]=(0,i.eJ)(new x.w),[f,m]=(0,i.eJ)(0),b=(0,i.sO)(null);return(0,i.d4)((()=>{const t=function(e){const t=d.$.pipe(),o=d.$.pipe((0,A.h)((t=>t.type===c.PAGE_SAVE_DONE&&t.payload.draftId===e)));return(0,C.T)(t,o)}(e.id).subscribe((e=>p(e)));return()=>{t.unsubscribe()}}),[]),(0,i.d4)((()=>{!function(e){Pt(this,void 0,void 0,(function*(){return d.dispatch({type:Te.LOADING,payload:{id:e}}),Lt((()=>Pt(this,void 0,void 0,(function*(){const{draft:t}=yield Ae().getDraftById({id:e});null!=t&&d.dispatch({type:Te.LOAD_DONE,payload:{id:t.id,created_at:t.created_at,updated_at:t.updated_at,table_of_contents:t.table_of_contents,notes:t.notes,pages:t.pages.sort(((e,t)=>e.order-t.order)).map(((t,o)=>{var n;return Object.assign(Object.assign({},t),{content:t.content,draftId:e,isFolded:0!==o,margins:null!==(n=t.margins)&&void 0!==n?n:[]})}))}})}))))}))}(e.id)}),[e.id]),(0,i.d4)((()=>(cancelAnimationFrame(f),m(requestAnimationFrame((()=>{null!=b.current&&(g.unsubscribe(),h(function(e){var t,o;const n=new x.w;let i=document.title;const r=null===(t=e.current)||void 0===t?void 0:t.togglePause,a=null===(o=e.current)||void 0===o?void 0:o.generateProgress;if(null!=r&&null!=a){let e=2e3,t=!1,o=!1;n.add(d.$.pipe((0,A.h)((e=>e.type===c.PAGE_SAVE))).subscribe((()=>{o||(i=document.title,document.title=`*${i}`,o=!0)}))),n.add(d.$.pipe((0,A.h)((e=>e.type===c.PAGE_SAVING))).subscribe((()=>{t&&a.next(),e=2e3,t=!0;const o=a.next();void 0!==o&&1===o.value&&(setTimeout((()=>{t&&(r(!0),e-=300)}),300),setTimeout((()=>{t&&r(!1)}),1e3),setTimeout((()=>{t&&(r(!0),e-=1e3)}),2e3),setTimeout((()=>{t&&(e-=1e3)}),3e3))}))),n.add(d.$.pipe((0,A.h)((e=>e.type===c.PAGE_SAVE_DONE))).subscribe((n=>{t=!1,r(!1),setTimeout((()=>{a.next()}),e>0?e:0),document.title=i,o=!1}))),n.add(d.$.pipe((0,A.h)((e=>e.type===c.PAGE_SAVE_FAIL))).subscribe((()=>{t=!1,r(!1),setTimeout((()=>{a.next()}),e>0?e:0)})))}return n}(b)))}))),()=>{cancelAnimationFrame(f),g.unsubscribe()})),[b.current]),(0,i.d4)((()=>{var e;const t=null===(e=s.data)||void 0===e?void 0:e.table_of_contents[0];null!=t&&(document.title=t.header)}),[s]),n.dy`
      <style>${o(6061)}</style>
      <loading-progress-bar .ref=${b}></loading-progress-bar>

      <um-preloader .loading=${s.isLoading}>
        <div class="draft-content">
          <div style=${hn`
              display: flex;
              flex-direction: column;
              margin-right: 7rem;
              margin-left: 3rem;
              min-width: 15rem;
            `}>
            <inscriptum-controls-panel .draftId=${e.id}></inscriptum-controls-panel>
            <inscriptum-table-of-content .items=${null!==(r=null===(t=s.data)||void 0===t?void 0:t.table_of_contents)&&void 0!==r?r:[]}></inscriptum-table-of-content>
          </div>

          <div style=${hn`
              width: 100%;
            `}>
            ${(0,u.r)(null!==(l=null===(a=s.data)||void 0===a?void 0:a.pages)&&void 0!==l?l:[],(e=>`${e.id}_${e.order}`),(e=>n.dy`<inscriptum-page .page=${e} style=${hn`
                    position: relative;
                    display: block;
                    border-bottom: 1px solid #eee;
                  `}></inscriptum-page>`))}
          </div>
        </div>
      </um-preloader>
    `})))},6106:(e,t,o)=>{o.d(t,{j7:()=>d,Bc:()=>c});var n=o(6798),i=o(6136),r=o(8770),a=o(8638),l=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};const s=/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/,d="figure",c=n.NB.create({name:d,draggable:!0,defining:!0,selectable:!0,content:()=>"text*",defaultOptions:{inline:!1,HTMLAttributes:{}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML:()=>[{tag:"figure",contentElement:"figcaption",getAttrs:e=>{const t=e.querySelector("img");return{src:null==t?void 0:t.getAttribute("src"),alt:null==t?void 0:t.getAttribute("alt"),title:null==t?void 0:t.getAttribute("title")}}},{tag:"img[src]",preserveWhitespace:!0,getContent:(e,t)=>a.HY.from(t.text(e.alt.length>0?e.alt:" ")),getAttrs:e=>({src:e.getAttribute("src")})}],renderHTML({HTMLAttributes:e}){return["figure",["img",(0,n.P1)(this.options.HTMLAttributes,e)],["figcaption",0]]},addCommands(){return{setFigure:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[(0,n.x2)(s,this.type,(e=>{const[,t,o,n]=e;return{src:o,alt:t,title:n}}))]},addNodeView(){return({node:e,HTMLAttributes:t,getPos:o,editor:n})=>{const a=document.createElement("figure");a.setAttribute("draggable","true");const s=document.createElement("div"),d=document.createElement("figcaption");s.classList.add("figure_wrapper"),s.contentEditable="false",d.classList.add("editable_text"),d.classList.add("empty"),d.setAttribute("data-placeholder","Caption (optional)");const c=e.content.firstChild;(null==c?void 0:c.isText)&&null!=c.text&&c.text.trim().length>0&&d.classList.remove("empty"),a.appendChild(s),a.appendChild(d);const p=function(e,t){const o=document.createElement("img");return o.setAttribute("src",u(e)),t.appendChild(o),o}(e.attrs.src,s);e.attrs.alt&&p.setAttribute("alt",e.attrs.alt),e.attrs.title&&p.setAttribute("title",e.attrs.title);const g=function(e){const t=e.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/);if(null!=t)return{type:t[1],base64_data:t[2]}}(e.attrs.src);if(null!=g){const e=document.createElement("div"),t=document.createElement("div");e.classList.add("file_progress"),t.classList.add("file_progress_bar"),s.classList.add("loading"),e.appendChild(t),s.appendChild(e),function(e,t,o){!function(e,t,o,n){l(this,void 0,void 0,(function*(){try{const n=yield(0,r.uploadFileService)((0,i.uploadDataToBlob)(e),t);o&&o(n)}catch(e){n&&n(e)}}))}(e,((e,t)=>{let n=0;t&&e&&(n=100*e/t,n=Math.min(100,n)),o.style.width=n+"%"}),(e=>{if(e){const o=u(e.src),n=t.querySelector("img");null!=n&&(n.src=o),t.classList.remove("loading")}}),(e=>(0,i.showError)(e)))}(g,s,t)}return p.onclick=()=>{"function"==typeof o&&this.editor.commands.setNodeSelection(o())},{dom:a,contentDOM:d,ignoreMutation:t=>"attributes"===t.type&&null!=t.attributeName&&(["src","title","alt"].includes(t.attributeName)&&(e.attrs[t.attributeName]=t.target.getAttribute(t.attributeName)),!0),update:e=>e.type===this.type&&(d.classList.toggle("empty",0===e.content.size),!0)}}}});function u(e){return function(e,t){const o=document.createElement("a");o.href=e;const n=o.href.slice(0,o.href.indexOf(":"));return t.indexOf(n)>-1}(e,["http","https","data"])?e:"//:0"}},9586:(e,t,o)=>{o.d(t,{W:()=>i,V:()=>r});var n=o(6798);const i="topicSummary",r=n.NB.create({name:i,group:"topicDoc",content:"inline*",addAttributes:()=>({"data-placeholder":{default:"Summary of the text"},"data-label":{default:"Summary"},role:{default:"definition"}}),parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",(0,n.P1)(this.options.HTMLAttributes,e),0]}})},9059:(e,t,o)=>{o.d(t,{H:()=>i,l:()=>r});var n=o(6798);const i="topicTitle",r=n.NB.create({name:i,content:"inline*",group:"topicDoc",defining:!0,selectable:!0,addAttributes:()=>({"data-placeholder":{default:"Title"},"data-label":{default:"Title"}}),parseHTML:()=>[{tag:"h1"}],renderHTML({HTMLAttributes:e}){return["h1",(0,n.P1)(this.options.HTMLAttributes,e),0]}})},3135:(e,t,o)=>{o.d(t,{v:()=>n});const n=Object.freeze({isDevMode:!1,nodeListFileName:"list.json"})},4938:(e,t,o)=>{o.d(t,{X7:()=>a,Ro:()=>l,WV:()=>s,iv:()=>u,u:()=>p});var n=o(6106),i=o(9586),r=o(9059);function a(e){if(!document.getElementById(e)){var t=document.getElementsByTagName("head")[0],o=document.createElement("link");o.id=e,o.rel="stylesheet",o.type="text/css",o.href=document.location.origin+e,o.media="all",t.appendChild(o)}}function l(e){let t="<noname>",o="...",n="";if(Array.isArray(null==e?void 0:e.ops)&&e.ops.length>0){t=String(e.ops[0].insert),o=String(e.ops[2].insert);const i=e.ops.find((e=>void 0!==c(e,["insert","blockFigure","image"])));if(null!=i&&(n=c(i,["insert","blockFigure","image"])),o.length<3){for(const[t,i]of e.ops.entries())if(t>2){if(o.length>100)break;void 0!==c(i,["insert","blockFigure","image"])?n=c(i,["insert","blockFigure","image"]):o+=" "+i.insert}o+="..."}}return o=o.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/`/g,"&DiacriticalGrave;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),{title:t,description:o,image:n}}function s(e){var t,o,a;let l="<noname>",s="...",c="";if(null!=e){const u=d(e,r.H);null!=(null==u?void 0:u.content)&&(l=null!==(t=u.content[0].text)&&void 0!==t?t:l);const p=d(e,i.W);null!=(null==p?void 0:p.content)&&(s=null!==(o=p.content[0].text)&&void 0!==o?o:s);const g=d(e,n.j7);null!=(null==g?void 0:g.attrs)&&(c=null!==(a=g.attrs.src)&&void 0!==a?a:c)}return s=s.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/`/g,"&DiacriticalGrave;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),{title:l,description:s,image:c}}function d(e,t){if(e.type===t)return e;if(Array.isArray(e.content))for(const o of e.content){const e=d(o,t);if(null!=e)return e}return null}function c(e,t){return t.reduce(((e,t)=>e&&"undefined"!==e[t]?e[t]:void 0),e)}const u=String.raw;function p(e,t=!1){const o="щ   ш  ч  ц  ю  я  ё  ж  ъ  ы  э  а б в г д е з и й к л м н о п р с т у ф х ь".split(/ +/g),n="shh sh ch cz yu ya yo zh `` y' e` a b v g d e z i j k l m n o p r s t u f x `".split(/ +/g);for(let i=0;i<o.length;i++)e=(e=e.split(t?n[i]:o[i]).join(t?o[i]:n[i])).split(t?n[i].toUpperCase():o[i].toUpperCase()).join(t?o[i].toUpperCase():n[i].toUpperCase());return e}},6061:e=>{e.exports='/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}.container{position:relative;width:100%;max-width:960px;margin:0 auto;padding:0 20px;box-sizing:border-box}.column,.columns{width:100%;float:left;box-sizing:border-box}@media(min-width: 400px){.container{width:85%;padding:0}}@media(min-width: 550px){.container{width:80%}.column,.columns{margin-left:4%}.column:first-child,.columns:first-child{margin-left:0}.one.column,.one.columns{width:grid-column-width(1)}.two.columns{width:grid-column-width(2)}.three.columns{width:grid-column-width(3)}.four.columns{width:grid-column-width(4)}.five.columns{width:grid-column-width(5)}.six.columns{width:grid-column-width(6)}.seven.columns{width:grid-column-width(7)}.eight.columns{width:grid-column-width(8)}.nine.columns{width:grid-column-width(9)}.ten.columns{width:grid-column-width(10)}.eleven.columns{width:grid-column-width(11)}.twelve.columns{width:100%;margin-left:0}.one-third.column{width:grid-column-width(4)}.two-thirds.column{width:grid-column-width(8)}.one-half.column{width:grid-column-width(6)}.offset-by-one.column,.offset-by-one.columns{margin-left:grid-offset-length(1)}.offset-by-two.column,.offset-by-two.columns{margin-left:grid-offset-length(2)}.offset-by-three.column,.offset-by-three.columns{margin-left:grid-offset-length(3)}.offset-by-four.column,.offset-by-four.columns{margin-left:grid-offset-length(4)}.offset-by-five.column,.offset-by-five.columns{margin-left:grid-offset-length(5)}.offset-by-six.column,.offset-by-six.columns{margin-left:grid-offset-length(6)}.offset-by-seven.column,.offset-by-seven.columns{margin-left:grid-offset-length(7)}.offset-by-eight.column,.offset-by-eight.columns{margin-left:grid-offset-length(8)}.offset-by-nine.column,.offset-by-nine.columns{margin-left:grid-offset-length(9)}.offset-by-ten.column,.offset-by-ten.columns{margin-left:grid-offset-length(10)}.offset-by-eleven.column,.offset-by-eleven.columns{margin-left:grid-offset-length(11)}.offset-by-one-third.column,.offset-by-one-third.columns{margin-left:grid-offset-length(4)}.offset-by-two-thirds.column,.offset-by-two-thirds.columns{margin-left:grid-offset-length(8)}.offset-by-one-half.column,.offset-by-one-half.column{margin-left:grid-offset-length(6)}}.container:after,.row:after,.u-cf{content:"";display:table;clear:both}.um-drafts__submenu{display:flex;flex-direction:row-reverse;padding-top:10px;border-bottom:1px solid #eee}.um-drafts__export-all{margin:0 0 10px 10px;stroke:#fff;stroke-width:30px;color:#bbb}.um-drafts__export-all:hover{color:#888;cursor:pointer}.draft-content{display:flex;flex-direction:column}@media(min-width: 400px){.draft-content{flex-direction:row}}.page__controls{display:flex;justify-content:space-between;align-items:start;opacity:.3;transition:.2s}.page__controls:hover{opacity:1}.btn{cursor:pointer}.btn.btn_icon{background:transparent;border:none}.btn.btn_icon .icon-tabler{transition:.2s;stroke:#bbb;stroke:var(--border-color);color:#bbb;color:var(--border-color)}.btn.btn_icon .icon-tabler:hover{stroke:#333;stroke:var(--dark-grey)}'},8608:e=>{e.exports=":root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}:host{position:relative;width:100%;user-select:none;display:flex;flex-direction:row;border-left:solid 1px #e1e1e1}.signature-pad{position:absolute}.fab-container{display:inline-flex;align-items:flex-end;justify-content:flex-end}.fab-container_main{position:sticky;top:calc(100vh - 20px);display:flex;margin:1em;flex-direction:row;height:0}.fab-container_main>*:not(:last-child){opacity:0;margin-left:0;transform:translateX(10px)}.fab-container_main:hover{height:50px;top:calc(100vh - 70px)}.fab-container_main:hover>*{display:flex;opacity:1;transform:none;margin-left:10px}.fab-container [tooltip]:before{bottom:115%;border-radius:2px;background:rgba(88,88,88,.16);content:attr(tooltip);font-size:12px;visibility:hidden;opacity:0;padding:5px 7px;margin-right:12px;position:absolute;white-space:nowrap}.fab-container [tooltip]:hover:before,.fab-container [tooltip]:hover:after{visibility:visible;opacity:1}.fab-container_horizontal{flex-direction:row;position:relative;margin:0;display:none}.fab-container_horizontal>*:not(:last-child){opacity:0;margin-left:0;transform:translateX(10px)}.fab-container_horizontal:hover>*{display:inherit;opacity:1;transform:none;margin-left:10px}.fab-container_vertical{flex-direction:column;position:relative;margin:0;display:none}.fab-container_vertical>*:not(:last-child){opacity:0;margin-top:0;transform:translateY(10px)}.fab-container_vertical:hover>*{opacity:1;margin-top:10px;transform:none}.fab-container:nth-last-child(1){transition-delay:25ms;background-size:contain}.fab-container:not(:last-child):nth-last-child(2){transition-delay:20ms;background-size:contain}.fab-container:not(:last-child):nth-last-child(3){transition-delay:40ms;background-size:contain}.fab-container:not(:last-child):nth-last-child(4){transition-delay:60ms;background-size:contain}.fab-button{border:none;background-color:#fff;cursor:pointer;box-shadow:2px 2px 2px 0px rgba(0,0,0,.18),0px 4px 7px -7px rgba(0,0,0,.15);border-radius:50%;display:block;width:40px;height:40px;margin:5px;position:relative;transition:all .1s ease-out;text-decoration:none;display:flex;justify-content:center;align-items:center;color:#bbb}.fab-button:active,.fab-button:focus,.fab-button:hover{box-shadow:3px 2px 2px rgba(0,0,0,.14),0 4px 8px rgba(0,0,0,.28);color:#bbb}.fab-button_lg{width:50px;height:50px;margin:0}"},5257:e=>{e.exports='pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{background:#23241f;color:#f8f8f2}.hljs-subst,.hljs-tag{color:#f8f8f2}.hljs-emphasis,.hljs-strong{color:#a8a8a2}.hljs-bullet,.hljs-link,.hljs-literal,.hljs-number,.hljs-quote,.hljs-regexp{color:#ae81ff}.hljs-code,.hljs-section,.hljs-selector-class,.hljs-title{color:#a6e22e}.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}.hljs-attr,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#f92672}.hljs-attribute,.hljs-symbol{color:#66d9ef}.hljs-class .hljs-title,.hljs-params,.hljs-title.class_{color:#f8f8f2}.hljs-addition,.hljs-built_in,.hljs-selector-attr,.hljs-selector-id,.hljs-selector-pseudo,.hljs-string,.hljs-template-variable,.hljs-type,.hljs-variable{color:#e6db74}.hljs-comment,.hljs-deletion,.hljs-meta{color:#75715e}.redactor{max-width:732px;margin:0 auto}.redactor__article{font-family:Georgia,Times,Times New Roman,serif;font-weight:400;font-style:normal;font-size:18px;line-height:1.58;color:rgba(12,10,10,.8);padding:0;margin:0}.redactor__article .ProseMirror{outline:0}.redactor__article .ProseMirror>*+*{margin-top:.75em}.redactor__article .ProseMirror>::selection,.redactor__article .ProseMirror>:not(pre) ::selection{background:#5f5f5f2f}.redactor__article .ProseMirror h1,.redactor__article .ProseMirror h2,.redactor__article .ProseMirror h3,.redactor__article .ProseMirror h4{font-family:Inter,sans-serif;font-weight:600;font-style:normal;letter-spacing:initial}.redactor__article .ProseMirror h1{font-size:32px;margin:21px 21px 12px;line-height:34px}.redactor__article .ProseMirror h2{font-size:30px;margin:21px 21px 12px;line-height:34px}.redactor__article .ProseMirror h3{font-size:28px;margin:18px 21px 9px}.redactor__article .ProseMirror h4{font-size:24px;margin:18px 21px 7px}.redactor__article .ProseMirror p{margin:0 21px 12px;word-wrap:break-word;white-space:pre-wrap}.redactor__article .ProseMirror blockquote{margin:18px 21px 16px 0;padding-left:15px;position:relative;font-style:italic;word-wrap:break-word;border-left:3px solid #000}.redactor__article .ProseMirror aside{font-size:21px;color:rgba(0,0,0,.6);margin:18px 21px 16px;padding:0 18px;text-align:center;font-style:italic}.redactor__article .ProseMirror hr{width:50%;margin:30px auto;border:none;font-size:2px;text-align:right;overflow:visible}.redactor__article .ProseMirror hr:after{content:"";display:block;border-top:1px solid #c9cdd1;margin:0 3px;position:relative;top:1px}.redactor__article .ProseMirror [contenteditable=false]{white-space:normal}.redactor__article .ProseMirror ul[data-type=taskList]{list-style:none;padding:0;margin:0 21px 12px}.redactor__article .ProseMirror ul[data-type=taskList] li{display:block}.redactor__article .ProseMirror ul[data-type=taskList] li>label{float:left;margin-right:.5rem}.redactor__article .ProseMirror ul[data-type=taskList] li>div{display:contents}.redactor__article .ProseMirror ul[data-type=taskList] li p{margin:0}.redactor__article .ProseMirror mark{background-color:#faf594b4}.redactor__article .ProseMirror :not(pre)>code{background-color:rgba(97,97,97,.1);color:#616161;font-family:JetBrainsMono,monospace;font-variant-ligatures:normal;padding:.1rem .3rem;border-radius:.4rem;font-size:.9rem}.redactor__article .ProseMirror a[href]{text-decoration:none;transition:all .2s ease-in-out;color:rgba(0,0,0,.8);border-bottom:.1rem rgba(0,0,0,.425) solid}.redactor__article .ProseMirror a[href]:hover,.redactor__article .ProseMirror a[href]:focus{border-bottom:.1rem rgba(0,0,0,.8) solid}.redactor__article .ProseMirror *[data-placeholder].empty{position:relative}.redactor__article .ProseMirror *[data-placeholder].empty:before{position:absolute;left:0;right:0;content:attr(data-placeholder);color:rgba(0,0,0,.44);font-weight:normal;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;pointer-events:none}.redactor__article .ProseMirror *[data-label]{position:relative}.redactor__article .ProseMirror *[data-label]:after{position:absolute;content:attr(data-label);color:rgba(0,0,0,.44);border-right:1px solid rgba(0,0,0,.15);right:100%;top:-6px;bottom:-6px;padding:6px 12px;font-weight:normal;margin:0 21px;opacity:0;visibility:hidden;transition:opacity .15s ease}.redactor__article .ProseMirror .focused *[data-label].empty:after{position:absolute;content:attr(data-label);color:rgba(0,0,0,.44);border-right:1px solid rgba(0,0,0,.15);right:100%;top:-6px;bottom:-6px;padding:6px 12px;font-weight:normal;margin:0 21px;opacity:0;visibility:hidden;transition:opacity .15s ease}.redactor__article .ProseMirror *[data-label].focused:after{opacity:1;visibility:visible}.redactor__article .ProseMirror *[role=definition]{font-family:Inter,sans-serif;font-size:15px;line-height:18px;color:#79828b;margin:12px 21px;font-style:normal}.redactor__article .ProseMirror *[role=definition] a{color:#79828b}.redactor__article .ProseMirror *[role=definition] a[href]{border-bottom:none;border-bottom:.1em solid rgba(0,0,0,.4)}.redactor__article .ProseMirror *[role=definition].empty{display:block}.redactor__article .ProseMirror *[role=definition] time:before{content:"•";padding:0 7px}.redactor__article .ProseMirror img{max-width:100%;vertical-align:top}.redactor__article .ProseMirror .iframe_wrap{max-width:100%;vertical-align:top;max-width:100%;vertical-align:top;position:relative}.redactor__article .ProseMirror .iframe_wrap iframe{position:absolute;width:1px;height:1px;min-width:100%;min-height:100%;*width:100%;*height:100%;top:0;left:0}.redactor__article .ProseMirror figure{margin:0 21px 16px;padding:0;text-align:center;position:relative;user-select:inherit}.redactor__article .ProseMirror figure.ProseMirror-selectednode img{box-shadow:0 0 0 3px rgba(0,0,0,.4)}.redactor__article .ProseMirror figure.ProseMirror-selectednode img:hover{box-shadow:0 0 0 3px rgba(0,0,0,.4)}.redactor__article .ProseMirror figure img:hover{box-shadow:0 0 0 3px rgba(0,0,0,.2)}.redactor__article .ProseMirror figcaption{font-family:Inter,sans-serif;font-size:15px;color:#79828b;padding:12px 21px 0;line-height:18px;vertical-align:top;text-align:center}.redactor__article .ProseMirror .figure_wrapper{position:relative}.redactor__article .ProseMirror .figure_wrapper img{opacity:1;transition:opacity .15s ease;max-height:690px}.redactor__article .ProseMirror .figure_wrapper.loading img{opacity:.3}.redactor__article .ProseMirror .figure_wrapper .file_progress{position:absolute;z-index:1;bottom:0;left:0;right:0;padding:3px;background-color:rgba(255,255,255,.7);transition:opacity .15s ease;visibility:hidden;opacity:0}.redactor__article .ProseMirror .figure_wrapper.loading .file_progress{visibility:visible;opacity:1}.redactor__article .ProseMirror .figure_wrapper .file_progress_bar{height:2px;background-color:#333;transition:width .1s linear;width:0}.redactor__article .ProseMirror figcaption[data-placeholder].empty{position:relative;overflow:hidden;width:calc(100% - 170px)}.redactor__article .ProseMirror figcaption[data-placeholder].empty:before{display:none}.redactor__article .ProseMirror figcaption[data-placeholder].empty:after{position:absolute;content:attr(data-placeholder);color:rgba(0,0,0,.44);font-weight:normal;font-style:italic;top:0px;padding-top:12px}.redactor__article .ProseMirror pre{background:#232b2b;border-radius:.3rem;box-shadow:0 .5rem 1rem rgba(0,0,0,.4);border-left:6px solid #516363;margin:1rem auto;white-space:pre-wrap;color:#c7d3de;counter-reset:step;counter-increment:step 0;position:relative;font-family:JetBrainsMono,monospace;font-variant-ligatures:normal;font-size:.9rem;padding:.75rem 1rem}.redactor__article .ProseMirror pre code{font-family:JetBrainsMono,monospace;font-variant-ligatures:normal;white-space:pre-wrap;margin-left:2.5rem;display:block}.redactor__article .ProseMirror pre ::selection{background:#dbdbdb2d}.redactor__article .ProseMirror pre div.l:before{color:#516363;position:absolute;left:15px;content:counter(step);counter-increment:step}@media(max-width: 960px){.redactor__article .ProseMirror *[data-label]:after{display:none}}.is-active{background:#000;color:#fff}'},7135:e=>{e.exports='/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--light-grey: #e1e1e1;--dark-grey: #333;--primary-color: #33c3f0;--secondary-color: #555555;--border-color: #bbb;--link-color: #1eaedb;--font-color: #222;--font-family: Inter, sans-serif}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:2rem;font-weight:300}h1{font-size:4rem;line-height:1.2;letter-spacing:-0.1rem}h2{font-size:3.6rem;line-height:1.25;letter-spacing:-0.1rem}h3{font-size:3rem;line-height:1.3;letter-spacing:-0.1rem}h4{font-size:2.4rem;line-height:1.35;letter-spacing:-0.08rem}h5{font-size:1.8rem;line-height:1.5;letter-spacing:-0.05rem}h6{font-size:1.5rem;line-height:1.6;letter-spacing:0}@media(min-width: 550px){h1{font-size:5rem}h2{font-size:4.2rem}h3{font-size:3.6rem}h4{font-size:3rem}h5{font-size:2.4rem}h6{font-size:1.5rem}}p{margin-top:0}.toc-panel{--toc-border-width: 1px;--color-contrast-low: hsl(240, 1%, 83%);--color-contrast-medium: hsl(240, 1%, 48%);--color-contrast-high: hsl(240, 4%, 20%);--text-unit: 1em;--text-scale-ratio: 1.2;--text-xs: calc((1em / 1.2) / 1.2);--text-xs: calc((var(--text-unit) / var(--text-scale-ratio)) / var(--text-scale-ratio));--text-sm: calc(calc((1em / 1.2) / 1.2) * 1.2);--text-sm: calc(var(--text-xs) * var(--text-scale-ratio));box-shadow:inset 1px 0 0 hsl(240, 1%, 83%);box-shadow:inset var(--toc-border-width) 0 0 var(--color-contrast-low);font-family:"Inter",sans-serif;position:sticky;top:1.25rem;max-height:calc(100vh - 1.25rem);overflow:visible}.toc-panel ol,.toc-panel ul{list-style:none;margin:0;padding:0;border:0}.toc-panel .toc-panel__list{position:relative}.toc-panel .toc-panel__list .toc-panel__list .toc-panel__header{padding-left:calc(1.25rem * 2)}.toc-panel .toc-panel__title{padding:.25rem 1.25rem;text-transform:uppercase;letter-spacing:.1em;font-size:calc(calc((1em / 1.2) / 1.2) * 1.2);font-size:var(--text-sm)}.toc-panel .toc-panel__header{padding:.25rem 1.25rem;position:relative;display:inline-flex;color:hsl(240, 1%, 48%);color:var(--color-contrast-medium);text-decoration:none;overflow:hidden;text-overflow:ellipsis}.toc-panel .toc-panel__header::before{content:"";width:1px;width:var(--toc-border-width);height:100%;position:absolute;left:0;top:0}.toc-panel .toc-panel__header:hover{color:hsl(240, 4%, 20%);color:var(--color-contrast-high)}.toc-panel .toc-panel__header_selected{color:#2a6df4}.toc-panel .toc-panel__header_selected::before{background-color:#2a6df4}.toc-panel .toc-panel__page-numb{width:2rem;text-align:right;padding-top:.25rem;padding-right:.5rem;flex-shrink:0;white-space:nowrap}.toc-panel .toc-panel__item{display:flex;margin-left:-2.5rem;color:hsl(240, 1%, 48%);color:var(--color-contrast-medium)}.toc-panel .toc-panel__item:hover{color:hsl(240, 4%, 20%);color:var(--color-contrast-high)}'}}]);