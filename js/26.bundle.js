(window.webpackJsonp=window.webpackJsonp||[]).push([[26,11,38,39,40,44,45,46,57,58,60,62,63],{560:function(t,e,o){"use strict";o.r(e),o.d(e,"BreakBlot",function(){return n});var i=o(530),l=o(532);class n extends l.a{}n.blotName="textBreak",n.tagName="br",n.className="inline",i.a.register(n)},561:function(t,e,o){"use strict";o.r(e),o.d(e,"SingleLineBlot",function(){return r});o(202),o(201);var i=o(532),l=o(560),n=o(534),s=o.n(n);class r extends i.c{replace(t){t.children.forEach(t=>{t instanceof l.BreakBlot&&t.replaceWith(s.a.create("text"," "))}),super.replace(t)}insertAt(t,e,o){void 0!==o&&"textBreak"==e?super.insertAt(t,"\n"):super.insertAt(t,e,o)}}},573:function(t,e,o){"use strict";o.r(e),o.d(e,"FieldBlot",function(){return l});var i=o(561);class l extends i.SingleLineBlot{}},574:function(t,e,o){"use strict";o.r(e),o.d(e,"T",function(){return n}),o.d(e,"draftSave",function(){return s}),o.d(e,"getPageContent",function(){return r}),o.d(e,"isEdit",function(){return a}),o.d(e,"updateEditableText",function(){return c}),o.d(e,"sanitize",function(){return u}),o.d(e,"uploadDataToBlob",function(){return h}),o.d(e,"showError",function(){return p});o(201),o(572);var i=o(643),l=o.n(i);let n={apiUrl:"https://inscriptum.js.org",datetime:0,pageId:0};function s(t,e){if(!t)return!1;if(!n.pageId){var o=r(!0,e);if(t!=o)return t=o,function(t,e){try{return localStorage.setItem(t,e),!!localStorage.getItem(t)}catch(t){return!1}}("draft",o)}return!1}function r(t,e){let o=e.scroll.domNode;o.querySelectorAll("textarea,input").forEach(t=>{t.setAttribute("data-value",t.value)});let i=o.cloneNode(!0);return o.querySelectorAll("textarea,input").forEach(t=>{t.removeAttribute("data-value")}),i.querySelectorAll("textarea,input").forEach(t=>{t.value=t.getAttribute("data-value")||"",t.removeAttribute("data-value")}),c(i,!1),i.querySelectorAll("[contenteditable]").forEach(t=>t.removeAttribute("contenteditable")),i.querySelectorAll("[data-placeholder]").forEach(t=>t.removeAttribute("data-placeholder")),i.querySelectorAll("[data-label]").forEach(t=>t.removeAttribute("data-label")),i.querySelectorAll("[data-title]").forEach(t=>t.removeAttribute("data-title")),i.querySelectorAll(".editable_text").forEach(t=>t.classList.remove("editable_text")),i.querySelectorAll(".focus").forEach(t=>t.classList.remove("focus")),i.querySelectorAll(".empty").forEach(t=>t.classList.remove("empty")),i.querySelectorAll('[class=""]').forEach(t=>t.removeAttribute("class")),i.querySelectorAll(".file_progress").forEach(t=>t.remove()),i.querySelectorAll(".cursor_wrapper").forEach(t=>t.remove()),t?(i.querySelectorAll("h1").forEach(t=>{t.querySelector("br")||t.append(document.createElement("br"))}),i.querySelectorAll("address").forEach(t=>{t.querySelector("br")||t.append(document.createElement("br"))}),i.innerHTML):(i.querySelector("h1,address").remove(),i.querySelector("br.inline").replaceWith("\n"),{data:JSON.stringify(d(i).children),length:i.innerHTML.length})}function a(){return document.getElementsByClassName("tl_article_edit").length>0}function c(t,e){void 0===e&&(e=a()),e?t.querySelectorAll(".editable_text").forEach(t=>{let e=!1;if(t.childNodes.forEach(t=>{!e&&t&&t.classList&&(e=t.classList.contains("editable_input"))}),!e){let e=t.textContent||"",o=document.createElement("textarea");o.classList.add("editable_input"),o.setAttribute("tabindex","-1"),o.setAttribute("rows","1"),o.value=e,e||t.classList.add("empty"),t.innerHTML="",t.append(o),l()(o)}}):t.querySelectorAll(".editable_text > .editable_input").forEach(t=>{let e=t.value,o=t.parentNode;o.innerHTML="",o.textContent=e})}function d(t){if(!t.tagName)return t.data;let e={tag:t.tagName.toLowerCase()};if(t.attributes.length){e.attrs={};for(var o=0;o<t.attributes.length;o++){let i=t.attributes[o];e.attrs[i.name]=i.value}}if(t.childNodes.length){e.children=[];for(o=0;o<t.childNodes.length;o++)e.children.push(d(t.childNodes[o]))}return e}function u(t,e){let o=document.createElement("a");o.href=t;let i=o.href.slice(0,o.href.indexOf(":"));return e.indexOf(i)>-1}function h(t){for(var e=atob(t.base64_data),o=[],i=0;i<e.length;i++)o.push(e.charCodeAt(i));return new Blob([new Uint8Array(o)],{type:t.type})}function p(t){let e=document.querySelector("#_error_msg");e.textContent=t,clearTimeout(e.to),e.classList.add("shown"),e.to=setTimeout(()=>{e.classList.remove("shown")},3e3)}!function(){var t=document.querySelector("time");if(t&&n.datetime){var e=new Date(1e3*n.datetime);let o="January February March April May June July August September October November December".split(" ")[e.getMonth()],i=e.getDate();t.textContent=o+" "+(10>i?"0":"")+i+", "+e.getFullYear()}}()},637:function(t,e,o){"use strict";o.r(e),o.d(e,"HeaderBlot",function(){return n});o(202);var i=o(530),l=o(561);class n extends l.SingleLineBlot{optimize(t){super.optimize(t);let e=this.domNode.innerText;e=(e=e.replace(/[\s_]+/g,"-")).replace(/(^-+|-+$)/g,""),this.domNode.id!==e&&this.domNode.setAttribute("id",e)}formatAt(t,e,o,i){("bold"!==o&&"italic"!==o&&"code"!==o||!i)&&super.formatAt(t,e,o,i)}}n.blotName="blockHeader",n.tagName="h3",i.a.register(n)},638:function(t,e,o){"use strict";var i=o(55);e.a=((t,e)=>{const o=i.a`${e}`;i.b(o,t)})},646:function(t,e,o){"use strict";class i extends HTMLElement{constructor(t,e=!1,o="open"){super(),this.connected=!1,this.attr={};const i=e=>{this.connected&&t(e,this.render())};this._attach=i.bind(null,e?this.attachShadow({mode:o}):this)}set state(t){this._state=t||this.state,this._attach()}get state(){return this._state}static get observedAttributes(){return Object.keys(this.attributes).map(t=>this.attributes[t])}connectedCallback(){this.connected=!0,this._attach()}attributeChangedCallback(t,e,o){if(e!==o){this.attr[t]!==o&&(this.attr[t]=o);for(const[e,i]of Object.entries(this.constructor.attributes))if(i===t&&this[e]!==o){this[e]=o;break}this._attach()}}forceUpdate(){this._attach()}_attach(){}}function l(t){return e=>{try{customElements.define(t,e)}catch(t){console.warn(t)}}}function n(){return function(t,e,o){!function(t,e,o,i){if(i){const t=i.set||function(){};i.set=function(e){t.apply(this,[e]),this.forceUpdate()}}else{const i=new Map;Reflect.defineProperty(t,e,{set(t){Reflect.defineProperty(this,e,{get(){return i.get(this)},set(t){i.set(this,o(t)),this.forceUpdate()},enumerable:!0}),this[e]=t},enumerable:!0,configurable:!0})}}(t,e,t=>t,o)}}function s(t){return function(e,o,i){const l=Reflect.get(e.constructor,"attributes");Reflect.defineProperty(e.constructor,"attributes",{value:Object.assign({},l,{[o]:t}),enumerable:!0,writable:!0})}}i.attributes={},o.d(e,"b",function(){return l}),o.d(e,"d",function(){return n}),o.d(e,"c",function(){return s}),o.d(e,"a",function(){return i})},650:function(t,e,o){"use strict";o.r(e),o.d(e,"browser",function(){return $}),o.d(e,"editor",function(){return O});o(634),o(635),o(572),o(202),o(1185),o(741),o(201);var i=o(1186),l=o.n(i),n=o(592),s=o.n(n),r=o(532),a=o(530),c=o(598),d=o(722),u=o(1190),h=o(636),p=o(642),f=o(723),m=o(560),b=o(573),g=o(724),_=o(725),v=o(726),k=o(561),y=o(727),S=o(728),T=o(729),E=o(593),L=o(655),x=o(637),A=o(730),q=o(945),N=o.n(q),w=o(656),B=o(599),C=o(574);function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=[],i=!0,l=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(i=(s=r.next()).done)&&(o.push(s.value),!e||o.length!==e);i=!0);}catch(t){l=!0,n=t}finally{try{i||null==r.return||r.return()}finally{if(l)throw n}}return o}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}N.a.configure({languages:["javascript","typescript","html","css"]});let R=navigator.userAgent.toLowerCase(),$={opera:/opera/i.test(R)||/opr/i.test(R),msie:/msie/i.test(R)&&!/opera/i.test(R)||/trident\//i.test(R)||/edge/i.test(R),msie_edge:/edge/i.test(R)&&!/opera/i.test(R),mozilla:/firefox/i.test(R),chrome:/chrome/i.test(R)&&!/edge/i.test(R),safari:!/chrome/i.test(R)&&/webkit|safari|khtml/i.test(R),iphone:/iphone/i.test(R),ipod:/ipod/i.test(R),ipad:/ipad/i.test(R),android:/android/i.test(R),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(R),safari_mobile:/iphone|ipod|ipad/i.test(R),opera_mobile:/opera mini|opera mobi/i.test(R),opera_mini:/opera mini/i.test(R),mac:/mac/i.test(R)};function O(t,e){console.log(_.MyQuill.length),console.log(_.MyQuill.imports["formats/"]),g.LinkBlot.blotName="link",g.LinkBlot.tagName="a",g.LinkBlot.showLinkTooltip=(e=>{t.showLinkTooltip(e,e.value,Object(C.isEdit)(),z)}),g.LinkBlot.hideLinkTooltip=(()=>t.hideLinkTooltip(z)),_.MyQuill.register(g.LinkBlot,!0),S.FigureBlot.blotName="blockFigure",S.FigureBlot.tagName="figure",S.FigureBlot.quillSetSelection=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return z.setSelection(t,e,a.a.sources.USER)},S.FigureBlot.quillDeleteText=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.a.sources.USER;return z.deleteText(t,e,o)},S.FigureBlot.quillInsertText=((t,e)=>z.insertText(t,e,a.a.sources.USER)),S.FigureBlot.draftSave=(()=>Object(C.draftSave)(o,z)),_.MyQuill.register(S.FigureBlot,!0),_.MyQuill.register({"modules/syntax":w.InsSyntaxModule,"formats/bold":E.a,"formats/italic":L.a,"formats/indent":u.a,"formats/list":d.ListContinuer,"formats/list-item":c.a,"formats/code":h.a},!0);var o=!1;$.mobile&&document.body.classList.add("mobile");document.querySelector(".tl_page");let i=document.querySelector(".tl_article"),n=document.querySelector(".tl_article_header"),q=document.querySelector(".tl_article_content"),R=document.querySelector("#_bold_button"),O=document.querySelector("#_italic_button"),I=document.querySelector("#_link_button"),U=document.querySelector("#_header_button"),F=document.querySelector("#_subheader_button"),D=document.querySelector("#_quote_button"),j=document.querySelector("#_image_button"),M=document.querySelector("#_embed_button"),H=(document.querySelector("#_edit_button"),document.querySelector("#_publish_button"),document.querySelector(".account"));var z=new _.MyQuill(e,{scrollingContainer:"html, body",readOnly:!0,modules:{syntax:{highlight:t=>N.a.highlightAuto(t).value},clipboard:{matchers:[W("h2",{blockHeader:!0}),W("h5",{blockSubheader:!0}),W("h6",{blockSubheader:!0}),["img",function(t,e){return t.src&&Object(C.sanitize)(t.src,["http","https","data"])?(new s.a).insert({blockFigure:{image:t.src,caption:t.alt||""}}):new s.a}],["video",function(t,e){return t.src&&Object(C.sanitize)(t.src,["http","https","data"])?(new s.a).insert({blockFigure:{video:t.src}}):new s.a}],["br",function(t,e){return console.log("modules.clipboard.matchers.br"),t.classList.contains("inline")?(new s.a).insert({textBreak:!0}):e}]]},keyboard:{bindings:{"required enter":{key:p.a.keys.ENTER,collapsed:!0,shiftKey:null,format:["blockTitle","blockAuthor"],suffix:/^$/,handler:function(t,e){console.log("keyboard.bindings.required_enter.handler");let o=P(this.quill.scroll.descendant(b.FieldBlot,t.index),1)[0];return!(o&&o.next&&o.next.domNode&&!o.next.domNode.textContent)||(this.quill.setSelection(o.next.offset(this.quill.scroll),0,a.a.sources.USER),!1)}},"required tab prev":{key:p.a.keys.TAB,shiftKey:!0,handler:function(t,e){console.log("keyboard.bindings.required_tab_prev.handler");let o=null;if(t.length>0){let e=z.scroll.descendants(r.c,t.index,t.length);if(1!=e.length)return!0;o=e[0]}else{o=P(z.scroll.descendant(r.c,t.index),1)[0]}if(null!=o&&null!=o.prev&&o.prev instanceof b.FieldBlot){let t=o.prev.offset(z.scroll),e=o.prev.length();return z.setSelection(t,e>1?e:0,a.a.sources.USER),!1}return!0}},"required tab next":{key:p.a.keys.TAB,shiftKey:!1,handler:function(t,e){console.log("keyboard.bindings.required_tab_next.handler");let o=null;if(t.length>0){let e=z.scroll.descendants(r.c,t.index,t.length);if(1!=e.length)return!0;o=e[0]}else{o=P(z.scroll.descendant(r.c,t.index),1)[0]}if(null!=o&&o instanceof b.FieldBlot&&null!=o.next){let t=o.next.offset(z.scroll);if(o.next instanceof b.FieldBlot){let e=o.next.length();z.setSelection(t,e>1?e:0,a.a.sources.USER)}else z.setSelection(t,0,a.a.sources.USER);return!1}return!0}},"no tab":{key:p.a.keys.TAB,shiftKey:null,handler:function(t,e){return console.log("keyboard.bindings.no_tab.handler"),!1}},"detect embed":{key:p.a.keys.ENTER,collapsed:!0,handler:function(e,o){console.log("keyboard.bindings.detect_embed.handler");let i=P(z.scroll.line(e.index),2),l=i[0],n=i[1];if(l){let o,i=l.domNode.textContent.substr(0,n);if(o=i.match(/(^|\s)(https?:\/\/\S+)$/)){let r=o[2];if(z.scroll.descendants(g.LinkBlot,e.index-r.length,r.length).length||z.formatText(e.index-r.length,r.length,"link",r,a.a.sources.USER),!i.substr(0,n-r.length).trim().length&&"P"==l.domNode.tagName){let e=X(r);if(e){let o=l.offset(z.scroll);return z.updateContents((new s.a).retain(o).delete(i.length).insert({blockFigure:e}),a.a.sources.USER),t.hideBlocksTooltip(),!1}}}}return!0}},"divider autofill":{key:p.a.keys.ENTER,collapsed:!0,prefix:/^([-*])\1{2,}$/,handler:function(t,e){console.log("keyboard.bindings.divider_autofill.handler");let o=P(z.scroll.line(t.index),2),i=o[0];o[1];if(i&&"P"==i.domNode.tagName){let t=i.offset(z.scroll),e=(new s.a).retain(t).delete(i.length()).insert({blockDivider:!0});return i.next||e.insert("\n"),z.updateContents(e,a.a.sources.USER),!1}return!0}},break:{key:p.a.keys.ENTER,shiftKey:!0,handler:J.bind(null,!0)},enter:{key:p.a.keys.ENTER,handler:J.bind(null,!1)},"detect link":{key:" ",collapsed:!0,handler:function(t){console.log("detectLinkHandler",t);let e=P(z.scroll.line(t.index),2),o=e[0],i=e[1];if(o){let e,l=o.domNode.textContent,n=l.substr(0,i);if(e=n.match(/(^|\s)((?:https?|tg):\/\/\S+|www\.\S+)$/)){let o=e[2],i=o.length;"www."==o.substr(0,4)&&(o="http://"+o);let l=z.scroll.descendants(g.LinkBlot,t.index-i,i);l.length||z.formatText(t.index-i,i,"link",o,a.a.sources.USER)}}return!0}},"cancel placeholder":{key:p.a.keys.ESCAPE,handler:function(t,e){return console.log("keyboard.bindings.cancel_placeholder.handler"),Y(),this.quill.updateSelection(a.a.sources.USER),!0}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{list:!1,"code-block":!1,blockquote:!1,header:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(this.quill.scroll.query&&null==this.quill.scroll.query("list"))return!0;const o=e.prefix.length,i=P(this.quill.getLine(t.index),2),l=i[0],n=i[1];if(n>o)return!0;let r;switch(e.prefix.trim()){case"[]":case"[ ]":r="unchecked";break;case"[x]":r="checked";break;case"-":case"*":r="bullet";break;default:r={type:"ordered",start:Number(e.prefix.slice(0,-1))-1}}this.quill.insertText(t.index," ",a.a.sources.USER),this.quill.history.cutoff(),console.log("keyboard.bindings.list_autofill.handler",t,e);const c=(new s.a).retain(t.index-n).delete(o+1).retain(l.length()-2-n).retain(1,{list:r,start:r.start});console.log("keyboard.bindings.list_autofill.handler",c);const d=this.quill.updateContents(c,a.a.sources.USER);return console.log("keyboard.bindings.list_autofill.handler",d),this.quill.history.cutoff(),this.quill.setSelection(t.index-o,a.a.sources.SILENT),!1}},"pre wrap":{key:192,collapsed:!0,format:{"code-block":!1},prefix:/^``$/,offset:2,handler:function(t,e){console.log("keyboard.bindings.pre_wrap.handler");let o=e.prefix.length,i=t.index-o;this.quill.scroll.deleteAt(i,o),this.quill.formatLine(i,1,"code-block",!0,a.a.sources.USER),this.quill.setSelection(i,a.a.sources.SILENT)}},code:{key:192,handler:function(t,e){if(console.log("keyboard.bindings.code.handler",!e.format),!e.collapsed){let o=z.scroll.descendants(r.c,t.index,t.length);if(o.length>1||1==o.length&&o[0]instanceof B.a)return this.quill.format("code-block",!e.format["code-block"],a.a.sources.USER),!1;if(z.scroll.descendants(m.BreakBlot,t.index,t.length).length)return this.quill.format("code-block",!e.format["code-block"],a.a.sources.USER),!1}if(e.collapsed&&!e.format.code&&!/\s$/.test(e.prefix))return!0;this.quill.format("code",!e.format.code,a.a.sources.USER)}},"figure delete":{key:p.a.keys.BACKSPACE,collapsed:!0,offset:0,handler:function(t,e){console.log("keyboard.bindings.figure_delete.handler");let o=P(z.scroll.line(t.index),2),i=o[0];o[1];return!(i&&i.prev&&i.prev instanceof S.FigureBlot)||(e.empty&&z.deleteText(t.index,1,a.a.sources.USER),z.setSelection(i.prev.offset(z.scroll)),!1)}},"field backspace":{key:p.a.keys.BACKSPACE,collapsed:!0,offset:0,handler:function(t,e){console.log("keyboard.bindings.field_backspace.handler");let o=P(z.scroll.line(t.index),2),i=o[0];o[1];return!(i&&i.prev&&i.prev instanceof b.FieldBlot&&i.domNode.textContent.length>0)}}}}}});function W(t,e){return[t,function(t,o){return o.compose((new s.a).retain(o.length(),e))}]}function K(t){let e=function(t){let e=P(z.scroll.line(t),2),o=e[0],i=e[1];return z.getText(t,o.length()-i)}(t);return!e||"\n"==e}function J(t,e,o){console.log("breakHandler",t,e,o);let i,l=e.index;e.length>0&&z.scroll.deleteAt(l,e.length);let n=K(l),s=!1;(i=P(z.scroll.descendant(m.BreakBlot,l),1)[0])?(!i.prev||i.prev instanceof m.BreakBlot)&&(z.scroll.deleteAt(--l,1),s=!0):(i=P(z.scroll.descendant(m.BreakBlot,l-1),1)[0])&&(z.scroll.deleteAt(--l,1),s=!0);(i=P(z.scroll.descendant(k.SingleLineBlot,l),1)[0])||s||!t?(z.insertText(l,"\n",a.a.sources.USER),z.setSelection(++l,0,a.a.sources.USER),(o.format.blockHeader||o.format.blockSubheader||o.format.blockBlockquote||o.format.blockPullquote)&&n&&z.formatLine(l,1,{blockHeader:!1,blockSubheader:!1,blockBlockquote:!1,blockPullquote:!1},a.a.sources.USER)):(z.insertEmbed(l,"textBreak",!0,a.a.sources.USER),!(i=P(z.scroll.descendant(m.BreakBlot,l),1)[0])||i.next||i.prev&&i.prev instanceof m.BreakBlot||(z.insertEmbed(++l,"textBreak",!0,a.a.sources.SILENT),z.setSelection(l,0,a.a.sources.SILENT)));return!1}function Q(t){let e=null==t?{}:z.getFormat(t),o=!!e.blockAuthor,i=!(!e.blockHeader&&!e.blockSubheader),l=!!e["code-block"];if(R.classList.toggle("active",!!e.bold),R.classList.toggle("disabled",o||i||l),O.classList.toggle("active",!!e.italic),O.classList.toggle("disabled",o||i||l),U.classList.toggle("active",!!e.blockHeader),U.classList.toggle("disabled",o),F.classList.toggle("active",!!e.blockSubheader),F.classList.toggle("disabled",o),D.classList.toggle("active",!(!e.blockBlockquote&&!e.blockPullquote)),D.classList.toggle("pullquote",!!e.blockPullquote),D.classList.toggle("disabled",o),null!=t){let e=z.scroll.descendants(g.LinkBlot,t.index,t.length);I.classList.toggle("active",!!e.length)}else I.classList.toggle("active",!1);I.classList.toggle("disabled",l)}function X(t){let e;if((e=t.match(/^(https?):\/\/(www\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/i))||(e=t.match(/^(https?):\/\/(www\.)?youtu\.be\/([a-zA-Z0-9_-]+)/i)))return{embed:"/embed/youtube?url="+encodeURIComponent(t)};if(e=t.match(/^(https?):\/\/(www\.)?vimeo\.com\/(\d+)/i))return{embed:"/embed/vimeo?url="+encodeURIComponent(t)};if(e=t.match(/^(https?):\/\/(www\.|mobile\.)?twitter\.com\/(.+)\/status\/(\d+)/i))return{embed:"/embed/twitter?url="+encodeURIComponent(t)};if(e=t.match(/^(https?):\/\/(t\.me|telegram\.me|telegram\.dog)\/([a-zA-Z0-9_]+)\/(\d+)/i))return{embed:"/embed/telegram?url="+encodeURIComponent(t)};if(e=t.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/))return"video/"==e[1].substr(0,6)?{video:t}:{image:t};if(e=t.match(/^(https?):\/\/\S+/i)){let o=document.createElement("a");if(o.href=t,o.pathname.match(/\.(jpe?g|png|gif|mp4)$/i))return"mp4"==e[1]?{video:t}:{image:t}}return!1}function Y(){const t=document.querySelector(".placeholder_once");null!==t&&(t.removeAttribute("data-placeholder"),t.classList.remove("placeholder_once","empty"))}function G(t){t.scroll.descendants(r.c,0,t.scroll.length()).forEach(t=>{if(t.domNode.hasAttribute("data-placeholder")){let e=t.domNode.textContent;t.domNode.classList.toggle("empty",!e)}})}function Z(t){let e=P(t.scroll.lines(),2),o=e[0],i=e[1];if(o instanceof r.a)t.updateContents((new s.a).insert("\n",{blockTitle:!0}).insert("\n",{blockAuthor:!0}),a.a.sources.SILENT);else if(o instanceof y.TitleBlot||t.formatLine(0,1,{blockTitle:!0},a.a.sources.SILENT),i){if(i instanceof r.a){let e=i.offset(t.scroll);t.updateContents((new s.a).retain(e).insert("\n",{blockAuthor:!0}),a.a.sources.SILENT)}else if(!(i instanceof T.AuthorBlot)){let e=i.offset(t.scroll);t.formatLine(e,1,{blockAuthor:!0},a.a.sources.SILENT)}}else{let e=t.scroll.length();t.updateContents((new s.a).retain(e).insert("\n",{blockAuthor:!0}),a.a.sources.SILENT)}let l=P(t.scroll.lines(),3)[2];if(l){let e=l.offset(t.scroll),o=t.scroll.length()-e;t.scroll.descendants(b.FieldBlot,e,o).forEach(e=>{let o=e.offset(t.scroll),i=e.length(),l=e.constructor.blotName;t.formatText(o,i,l,!1,a.a.sources.SILENT)})}else{let e=t.scroll.length();t.insertText(e,"\n",a.a.sources.SILENT)}let n=t.scroll.lines();n.forEach((t,e)=>{"P"==t.domNode.tagName&&(3==n.length&&2==e?t.domNode.setAttribute("data-placeholder","Your story..."):t.domNode.removeAttribute("data-placeholder"))})}function V(t,e){(e=e||{}).close_btn=e.close_btn||"OK",e.submit_btn=e.submit_btn||!1,e.close=e.close||tt,e.submit=e.submit||e.close,tt();var o=document.createElement("div");o.classList.add("tl_alert"),o.innerHTML='<main class="tl_alert_message"><section></section><aside class="tl_message_buttons"></aside></main>',o.querySelector("section").innerHTML=t;var i=o.querySelector("aside");if(e.close_btn){var l=document.createElement("button");l.classList.add("button"),l.innerHTML=e.close_btn,l.addEventListener("click",e.close),l.append(i)}if(e.submit_btn){var n=document.createElement("button");n.classList.add("button"),n.innerHTML=e.submit_btn,n.addEventListener("click",function(){o.classList.add("tl_alert_loading"),e.submit()}),n.append(i)}o.append("body")}function tt(){const t=document.querySelector(".tl_alert");t&&t.remove()}function et(t){console.log(et)}function ot(t){let e=t.querySelector(".prompt_input"),o=t.querySelector(".close");e.onkeydown=null,e.onblur=null,o.onclick=null,t.style.display="",t.classList.remove("tooltip_prompt"),z.focus()}return z.addContainer(t.$tl_link_tooltip),z.addContainer(t.$tl_tooltip),z.addContainer(t.$tl_blocks),z.on(a.a.events.EDITOR_CHANGE,function(e,o){if(e!==a.a.events.SELECTION_CHANGE)return;if(!z.isEnabled())return;if(null==o)return;!function(e){let o=P(z.scroll.descendant(S.FigureBlot,e.index),1)[0];z.scroll.descendants(S.FigureBlot,0,z.scroll.length()).forEach(t=>{o!==t&&t.blur()}),o&&(o.focus(),t.hideFormatTooltip(z),t.hideBlocksTooltip())}(o);let l=P(z.scroll.descendant(r.c,o.index),2),n=l[0];l[1];0===o.length?(t.hideFormatTooltip(z),null==n||n instanceof b.FieldBlot||n instanceof f.BlockquoteBlot||n instanceof v.PullquoteBlot||n instanceof B.a||n instanceof c.a||""!==n.domNode.textContent?t.hideBlocksTooltip():t.showBlocksTooltip(o,Object(C.isEdit)(),z)):(null==n||n instanceof y.TitleBlot?t.hideFormatTooltip(z):(t.showFormatTooltip(o,z,Object(C.isEdit)()),Q(o)),t.hideBlocksTooltip());let s=z.getFormat(o);i&&i.classList.toggle("title_focused",!(!s.blockTitle&&!s.blockAuthor)),Y()}),z.on(a.a.events.TEXT_CHANGE,function(){z.getSelection();Z(z),G(z),Y(),Object(C.draftSave)(o,z)}),z.on(a.a.events.SCROLL_OPTIMIZE,function(t){t.forEach(t=>{if("childList"==t.type&&!t.addedNodes.length&&t.removedNodes.length){let e=t.previousSibling,o=t.nextSibling;if(!o&&e&&"BR"==e.tagName&&"inline"==e.className){let e=document.createElement("br");e.className="inline",t.target.appendChild(e)}else!o||!e||"BR"==e.tagName&&"inline"==e.className||"BR"!=o.tagName||"inline"!=o.className||o.nextSibling||o.parentNode&&o.parentNode.removeChild(o)}})}),z.scroll.domNode.setAttribute("dir","auto"),document.addEventListener("click touchstart",function(e){let o=e.target;for(;o;){if(o===z.container)return;o=o.parentNode}t.hideFormatTooltip(z),t.hideBlocksTooltip()}),Z(z),G(z),function(){const e={page_id:C.T.pageId};e.save_hash&&(C.T.saveHash=e.save_hash);(e.can_edit&&C.T.saveHash||!C.T.pageId)&&(e.short_name&&H&&(H.textContent=e.short_name),i&&i.classList.add("tl_article_editable"));if(!C.T.pageId&&(i&&i.classList.add("tl_article_edit"),!function(){if(!C.T.pageId)return function(t){try{return localStorage.getItem(t)}catch(t){return!1}}("draft");return!1}()&&e.author_name)){let t;t=e.author_url?{link:e.author_url}:{};let o=z.scroll.descendants(T.AuthorBlot),i=P(o,1),l=i[0];l&&z.updateContents((new s.a).retain(l.offset()).delete(l.length()).insert(e.author_name,t),a.a.sources.USER)}if(e.auth_alert&&e.short_name){var l="Success! You are now logged in as <b>"+e.short_name.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\'/g,"&#39;").replace(/%/g,"&#37;")+"</b> in this browser.";e.migrate_count>0&&e.migrate_hash?(l+="<br/><br/>",V(l+="We can also add "+e.migrate_count+" Telegraph page"+(e.migrate_count>1?"s":"")+" from this browser to your account.",{close_btn:"Skip",submit_btn:"Add",submit:function(){et(e.migrate_hash)}})):V(l)}o=Object(C.getPageContent)(!0,z),function(e){i&&i.classList.toggle("tl_article_edit",e),Object(C.updateEditableText)(document.body),z&&(z.enable(e),e&&z.focus());if(!e&&q&&n){var o=q.querySelector("h1").textContent,l=q.querySelector("address").textContent,s=q.querySelector("address a").getAttribute("href");n.querySelector("h1").textContent=o,n.querySelector("address a").textContent=l,s?n.querySelector("address a").setAttribute("href",s):n.querySelector("address a").removeAttribute("href"),t.hideFormatTooltip(z),t.hideBlocksTooltip()}}(Object(C.isEdit)())}(),R.onclick=(t=>{console.log("$bold_button.onclick");let e=t.target.classList.contains("active");t.preventDefault(),console.log("$bold_button.onclick",!e),z.format("bold",!e),console.log("$bold_button.onclick",z.getSelection(!0)),z.updateSelection(a.a.sources.API)}),O.onclick=(t=>{let e=t.target.classList.contains("active");t.preventDefault(),z.format("italic",!e),z.updateSelection(a.a.sources.API)}),I.onclick=(e=>{let o=e.target.classList.contains("active");e.preventDefault();var i=z.getSelection(!0);if(o){z.scroll.descendants(g.LinkBlot,i.index,i.length).forEach(t=>{let e=t.offset(z.scroll),o=t.length();z.formatText(e,o,"link",!1)}),Q(i)}else!function(t,e,o){let i=t.querySelector(".prompt_input"),l=t.querySelector(".close");i.value="",i.setAttribute("placeholder",e),i.onkeydown=(e=>{let l=e.which||e.keyCode;if(27==l)ot(t);else if(13==l){let l=i.value;l&&(o&&o(l),e.preventDefault()),ot(t)}}),i.onblur=(()=>{ot(t)}),l.onclick=(()=>{ot(t)}),t.style.display="",t.classList.add("tooltip_prompt"),i.focus()}(t.$tl_tooltip,"Paste or type a link...",function(t){"#"!=(t=t.trim()).substr(0,1)&&"/"!=t.substr(0,1)&&"http://"!=t.substr(0,7)&&"https://"!=t.substr(0,8)&&"tg://"!=t.substr(0,5)&&"mailto:"!=t.substr(0,7)&&(t=t.indexOf("@")>0?"mailto:"+t:"http://"+t),z.focus(),z.format("link",t),Q(i)})}),U.onclick=(t=>{let e=t.target.classList.contains("active");t.preventDefault();let o=z.getSelection(!0);z.format("blockHeader",!e),z.scroll.descendants(x.HeaderBlot,o.index,o.length).forEach(t=>{let e=t.offset(z.scroll),o=t.length();z.formatText(e,o,{bold:!1,italic:!1,code:!1},a.a.sources.SILENT)}),z.updateSelection(a.a.sources.API)}),F.onclick=(t=>{let e=t.target.classList.contains("active");t.preventDefault();let o=z.getSelection(!0);z.format("blockSubheader",!e),z.scroll.descendants(A.SubheaderBlot,o.index,o.length).forEach(t=>{let e=t.offset(z.scroll),o=t.length();z.formatText(e,o,{bold:!1,italic:!1,code:!1},a.a.sources.SILENT)}),z.updateSelection(a.a.sources.API)}),D.onclick=(t=>{let e=t.target,o=e.classList.contains("active"),i=e.classList.contains("pullquote");t.preventDefault();z.getSelection(!0);o?z.format("blockPullquote",!i):z.format("blockBlockquote",!0),z.updateSelection(a.a.sources.API)}),j.onclick=(()=>{let t=z.container.querySelector("input.ql-image[type=file][data-status=ready]");null==t&&((t=document.createElement("input")).setAttribute("type","file"),t.setAttribute("accept",$.safari_mobile?"image/gif, image/jpeg, image/jpg, image/png":"image/gif, image/jpeg, image/jpg, image/png, video/mp4"),t.classList.add("ql-image"),t.addEventListener("change",()=>{if(t&&null!=t.files&&null!=t.files[0]){var e=t.files[0];const o=function(){Object(C.showError)("File too big (up to 5 MB allowed)")},i=5242880;!function(t,e){if("image/jpg"==t.type||"image/jpeg"==t.type)return l()(t,o=>{if("error"===o.type)e(t);else if(o.toBlob)o.toBlob(function(t){e(t)},t.type);else{var i=o.toDataURL(t.type),l={type:t.type,base64_data:i.split(",")[1]};e(Object(C.uploadDataToBlob)(l))}},{canvas:!0,orientation:!0});e(t)}(e,e=>{if(e.size>i)return o&&o();var l=new FileReader;l.onload=function(e){if(e&&null!==e.target){let o=X(e.target.result);if(o){let t=z.getSelection(!0);z.updateContents((new s.a).retain(t.index).delete(t.length).insert({blockFigure:o}),a.a.sources.USER)}else Object(C.showError)("Invalid file format");t.value="",t.setAttribute("data-status","ready")}},l.readAsDataURL(e)})}}),z.container.appendChild(t)),t.setAttribute("data-status","busy"),t.click()}),M.onclick=(e=>{let o=z.getSelection(!0),i=P(z.scroll.line(o.index),1)[0];const l=i.domNode;if(i){l.textContent||(l.setAttribute("data-placeholder","Paste a YouTube, Vimeo or Twitter link, and press Enter"),l.classList.add("placeholder_once","empty"),t.hideBlocksTooltip())}}),window.addEventListener("scroll resize",()=>{t.tooltipUpdatePosition(t.$tl_tooltip,null,t.formatTTOptions,z),t.tooltipUpdatePosition(t.$tl_link_tooltip,null,t.linkTTOptions,z)}),z}},654:function(t,e,o){"use strict";o.r(e),o.d(e,"uploadFileService",function(){return n});const i="inscriptum",l="cz5pibn5";function n(t,e){return new Promise((o,n)=>{var s=`https://api.cloudinary.com/v1_1/${i}/upload`,r=new XMLHttpRequest,a=new FormData;r.open("POST",s,!0),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.upload.addEventListener("progress",function(t){t.lengthComputable&&e&&e(t.loaded,t.total)}),e&&e(0,1),a.append("upload_preset",l),a.append("tags","browser_upload"),a.append("file",t),r.send(a),r.onreadystatechange=(t=>{if(4==r.readyState&&200==r.status){var e=JSON.parse(r.responseText);console.log(1111,e),e.src=e.secure_url,o(e)}}),r.onerror=function(){n(new Error("Network Error"))}})}},656:function(t,e,o){"use strict";o.r(e),o.d(e,"CodeEndLineFlag",function(){return s}),o.d(e,"InsSyntaxCodeBlock",function(){return r}),o.d(e,"InsSyntaxModule",function(){return a});o(201),o(572);var i=o(530),l=o(571),n=o(599);class s extends l.a{static formats(){return{}}}s.blotName="code-end",s.className="l",s.tagName="SPAN",i.a.register(s);class r extends n.a{highlight(t){let e=this.domNode.textContent||"";if(this.cachedText!==e){if(e.trim().length>0||null==this.cachedText){let o="";const i=t(e).split("\n");for(let t=0;t<i.length-1;t++)o+=`<span class="l">${i[t]||" "}</span>\n`;o+=`<span class="l">${i[i.length-1]}</span>`,this.domNode.innerHTML=`<code class="hljs">${o}</code>`}this.cachedText=e}}}class a extends n.c{static register(){i.a.register(n.b,!0),i.a.register(r,!0)}highlight(){if(this.quill.selection.composing)return;this.quill.update(i.a.sources.USER);let t=this.quill.getSelection();this.quill.scroll.descendants(r).forEach(t=>{t.highlight(this.options.highlight)}),this.quill.update(i.a.sources.SILENT),null!=t&&document.activeElement===this.quill.container.querySelector("[contenteditable]")&&this.quill.setSelection(t,i.a.sources.SILENT)}}},722:function(t,e,o){"use strict";o.r(e),o.d(e,"ListContinuer",function(){return l});var i=o(598);class l extends i.b{static create(t){let e;return"string"==typeof t?e=super.create(t):(e=super.create(t.type),void 0!==t.start&&(e.setAttribute("start",t.start),e.style["counter-reset"]=`list-0 ${t.start}`)),e}static formats(t){let e=super.formats(t);return console.log("MyList-static.formats",e,t.getAttribute("start")),{type:e,start:t.getAttribute("start")}}}},723:function(t,e,o){"use strict";o.r(e),o.d(e,"BlockquoteBlot",function(){return n});var i=o(530),l=o(532);class n extends l.c{}n.blotName="blockBlockquote",n.tagName="blockquote",i.a.register(n)},724:function(t,e,o){"use strict";o.r(e),o.d(e,"LinkBlot",function(){return n});o(944);var i=o(571),l=o(574);class n extends i.a{constructor(t,e){super(t),this.value=e,t.addEventListener("mouseover",n.showLinkTooltip.bind(this,this),!1),t.addEventListener("mouseout",n.hideLinkTooltip,!1)}static create(t){let e=super.create(t);t=this.sanitize(t),e.setAttribute("href",t);var o=t.substr(0,1);return"/"!=o&&"#"!=o&&"tg://"!=t.substr(0,5)&&"mailto:"!=t.substr(0,7)&&e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){const e=n.relativeUrl(t);return Object(l.sanitize)(t,["http","https","tg","mailto"])?e:"about:blank"}detach(){this.domNode.removeEventListener("mouseover",n.showLinkTooltip.bind(this,this),!1),this.domNode.removeEventListener("mouseout",n.hideLinkTooltip,!1),super.detach(),n.hideLinkTooltip()}format(t,e){if(t!==this.statics.blotName||!e)return super.format(t,e);e=n.sanitize(e),this.domNode.setAttribute("href",e),this.domNode.setAttribute("data-title",e)}static relativeUrl(t){let e=location,o=document.createElement("a");return o.href=t,e.origin!==o.origin?o.href:e.pathname!==o.pathname||e.search!==o.search?o.pathname+o.search+o.hash:e.href===o.href?o.hash||o.pathname+o.search+o.hash:o.hash}}},725:function(t,e,o){"use strict";o.r(e),o.d(e,"MyQuill",function(){return l});var i=o(530);class l extends i.a{formatLine(){super.formatLine(...arguments),this.updateSelection()}formatText(){super.formatText(...arguments),this.updateSelection()}updateSelection(t){if(this.hasFocus()){t=t||l.sources.SILENT;let e=this.getSelection(!0);this.setSelection(++e.index,e.length,t),this.setSelection(--e.index,e.length,t)}}}},726:function(t,e,o){"use strict";o.r(e),o.d(e,"PullquoteBlot",function(){return n});var i=o(530),l=o(532);class n extends l.c{}n.blotName="blockPullquote",n.tagName="aside",i.a.register(n)},727:function(t,e,o){"use strict";o.r(e),o.d(e,"TitleBlot",function(){return n});var i=o(530),l=o(573);class n extends l.FieldBlot{static create(t){let e=super.create(t);return e.setAttribute("data-placeholder","Title"),e.setAttribute("data-label","Title"),e}formatAt(t,e,o,i){o===n.blotName&&super.formatAt(t,e,o,i)}}n.blotName="blockTitle",n.tagName="h1",i.a.register(n)},728:function(t,e,o){"use strict";o.r(e),o.d(e,"FigureBlot",function(){return u});o(634),o(635),o(741),o(201);var i=o(530),l=o(532),n=o(642),s=o(643),r=o.n(s),a=o(654),c=o(574);function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=[],i=!0,l=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(i=(s=r.next()).done)&&(o.push(s.value),!e||o.length!==e);i=!0);}catch(t){l=!0,n=t}finally{try{i||null==r.return||r.return()}finally{if(l)throw n}}return o}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class u extends l.a{constructor(t,e){super(t),this.domNode=t,this.domWrapper=document.createElement("div"),this.domCursor=document.createElement("span"),this.domCaption=document.createElement("figcaption"),this.domWrapper.classList.add("figure_wrapper"),this.domCursor.classList.add("cursor_wrapper"),this.domCursor.setAttribute("contenteditable","true"),this.domCaption.classList.add("editable_text"),this.domCaption.setAttribute("data-placeholder","Caption (optional)"),e.caption&&(this.domCaption.innerText=e.caption),this.domNode.appendChild(this.domWrapper),this.domNode.appendChild(this.domCursor),this.domNode.appendChild(this.domCaption),setTimeout(()=>{Object(c.updateEditableText)(this.domNode)},1);let o=!1;e.image?(this.appendImgNode(e.image),o=this.uploadData(e.image)):e.video?(this.appendVideoNode(e.video),o=this.uploadData(e.video)):e.embed&&this.appendIframeNode(e.embed),o&&(this.domProgress=document.createElement("div"),this.domProgressBar=document.createElement("div"),this.domProgress.classList.add("file_progress"),this.domProgressBar.classList.add("file_progress_bar"),this.domWrapper.classList.add("loading"),this.domProgress.appendChild(this.domProgressBar),this.domWrapper.appendChild(this.domProgress),this.uploadFile(o)),this.domWrapper.onclick=(()=>{if(!this.domNode.classList.contains("focus")){let t=this.offset(this.scroll);this.focus(),u.quillSetSelection(t)}}),this.domCursor.onkeydown=(t=>{let e=t.which||t.keyCode;if(e==n.a.keys.BACKSPACE){let e=this.offset(this.scroll);u.quillDeleteText(e,this.length()),u.quillSetSelection(e-1),t.preventDefault()}else if(e==n.a.keys.ENTER){let e=this.offset(this.scroll)+this.length();this.focus(),u.quillInsertText(e,"\n"),u.quillSetSelection(e),t.preventDefault()}}),this.domCursor.onpaste=(t=>{t.stopPropagation(),t.preventDefault()}),this.domCaption.onkeydown=(t=>{let e=t.which||t.keyCode,o=t.target;if(e==n.a.keys.ENTER){if(t.shiftKey)return;let e={start:o.selectionStart,end:o.selectionEnd},i=o.value;if(e.start!=e.end)i=i.substr(0,e.start)+i.substr(e.end),o.setSelectionRange(i.length,i.length);else if(e.end==i.length){let t=this.offset(this.scroll)+this.length();this.focus(),u.quillInsertText(t,"\n"),u.quillSetSelection(t)}t.preventDefault()}else if(e==n.a.keys.DOWN||e==n.a.keys.TAB||e==n.a.keys.RIGHT){let e={start:o.selectionStart,end:o.selectionEnd},i=o.value;if(e.start==e.end&&e.end==i.length){let e=this.offset(this.scroll)+this.length();this.focus(),u.quillSetSelection(e,0),t.preventDefault()}}else if(e==n.a.keys.LEFT||e==n.a.keys.UP){let e={start:o.selectionStart,end:o.selectionEnd};if(e.start==e.end&&0===e.start){let e=this.offset(this.scroll)-1;this.focus(),u.quillSetSelection(e,0),t.preventDefault()}}});const i=t=>{null!==t&&null!==t.target&&(this.domCaption.classList.toggle("empty",!t.target.value),r.a.update(t.target),u.draftSave())};this.domCaption.onpaste=(t=>{t.stopPropagation(),i(t)}),this.domCaption.onkeyup=i,this.domCaption.ondrop=i,this.domCaption.onchange=i,this.domCaption.oninput=i,this.domCaption.oncut=i,this.domCaption.onclick=(t=>{t.target&&t.target.focus()})}static create(t){let e=super.create(t);return e.setAttribute("contenteditable","false"),e}appendImgNode(t){let e=document.createElement("img");return e.setAttribute("src",this.sanitize(t)),this.domWrapper.appendChild(e),e}appendVideoNode(t){let e=document.createElement("video");return e.setAttribute("src",this.sanitize(t)),e.setAttribute("preload","auto"),e.setAttribute("controls","controls"),e.addEventListener("loadeddata",function(){this.mozHasAudio||this.webkitAudioDecodedByteCount||this.audioTracks&&this.audioTracks.length||(this.setAttribute("autoplay","autoplay"),this.setAttribute("loop","loop"),this.setAttribute("muted","muted"),this.removeAttribute("controls"),this.play())}),this.domWrapper.appendChild(e),e}appendIframeNode(t){let e=document.createElement("div"),o=document.createElement("div"),i=document.createElement("iframe");return e.classList.add("iframe_wrap"),e.appendChild(o),o.classList.add("iframe_helper"),o.style.paddingTop="56.25%",o.appendChild(i),i.setAttribute("src",this.sanitize(t)),i.setAttribute("width","640"),i.setAttribute("height","360"),i.setAttribute("frameborder","0"),i.setAttribute("allowtransparency","true"),i.setAttribute("allowfullscreen","true"),i.setAttribute("scrolling","no"),this.domWrapper.appendChild(e),e}uploadFile(t){this.uploadFileStart(t,(t,e)=>{let o=0;e&&t&&(o=100*t/e,o=Math.min(100,o)),this.domProgressBar.style.width=o+"%"},e=>{if(e){let o=this.sanitize(e.src);if("video/"==t.type.substr(0,6)){let t=this.domWrapper.querySelector("video");t&&t.setAttribute("src",o)}else{let t=this.domWrapper.querySelector("img");t&&t.setAttribute("src",o)}this.domWrapper.classList.remove("loading"),u.draftSave()}},t=>(u.quillDeleteText(this.offset(this.scroll),this.length(),i.a.sources.SILENT),u.draftSave(),Object(c.showError)(t)))}uploadData(t){let e=null;return!!(e=t.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/))&&{type:e[1],base64_data:e[2]}}sanitize(t){return Object(c.sanitize)(t,["http","https","data"])?t:"//:0"}static value(t){let e={caption:""},o=t.querySelector("img");o&&(e.image=o.src);let i=t.querySelector("video");i&&(e.video=i.src);let l=t.querySelector("iframe");l&&(e.embed=l.src);let n=t.querySelector("figcaption");if(n){let t=n.querySelector(".editable_input");e.caption=t?t.value:n.innerText}return e}focus(){this.domNode.classList.add("focus")}blur(){this.domNode.classList.remove("focus")}_index(t,e){if(t===this.domCaption)return 0;let o=0;return t.nodeType==t.TEXT_NODE&&(o+=e>=0?e:t.data.length),t.previousSibling?o+this._index(t.previousSibling,-1):t.parentNode?o+this._index(t.parentNode,-1):0}_position(t,e){if(t.nodeType==t.TEXT_NODE)return e<=t.data.length?[t,e]:[null,e-=t.data.length];{let i=t.firstChild;for(;i;){let t=null;var o=d(this._position(i,e),2);if(t=o[0],e=o[1],t)return[t,e];i=i.nextSibling}return[t,e]}}update(t){this.domCursor.innerHTML=""}index(t,e){return 0}position(t,e){return[this.domCursor,0]}async uploadFileStart(t,e,o,i){try{const l=await Object(a.uploadFileService)(Object(c.uploadDataToBlob)(t),e);o&&o(l)}catch(t){i&&i("Network error")}}}},729:function(t,e,o){"use strict";o.r(e),o.d(e,"AuthorBlot",function(){return n});o(202);var i=o(530),l=o(573);class n extends l.FieldBlot{static create(t){console.log("AuthorBlot create ",t);let e=super.create(t);return e.setAttribute("data-placeholder","Your name"),e.setAttribute("data-label","Author"),e}formatAt(t,e,o,i){console.log("AuthorBlot formatAt ",t,e,o,i),o===n.blotName?super.formatAt(t,e,o,i):"link"===o&&super.formatAt(0,this.length(),o,i)}format(t,e){console.log("AuthorBlot format ",t,e),super.format(t,e)}replace(t){console.log("AuthorBlot replace ",t),super.replace(t)}insertAt(t,e,o){console.log("AuthorBlot insertAt ",t,e,o),super.insertAt(t,e,o)}}n.blotName="blockAuthor",n.tagName="address",i.a.register(n)},730:function(t,e,o){"use strict";o.r(e),o.d(e,"SubheaderBlot",function(){return n});var i=o(530),l=o(637);class n extends l.HeaderBlot{}n.blotName="blockSubheader",n.tagName="h4",i.a.register(n)},946:function(t,e,o){"use strict";o.r(e),o.d(e,"EditorTooltipComponent",function(){return r});var i=o(646),l=o(55),n=o(638),s=o(650);let r=class extends i.a{constructor(){super(n.a,!1),this.html=l.a,this.linkTTOptions={padding:7,position:"bottom",depend:this.$tl_tooltip,dependPadding:10},this.formatTTOptions={padding:10,position:s.browser.mobile?"bottom":"top",minDelta:5}}connectedCallback(){super.connectedCallback(),this.$tl_link_tooltip=this.querySelector("#_tl_link_tooltip")||document.createElement("div"),this.$tl_tooltip=this.querySelector("#_tl_tooltip")||document.createElement("div"),this.$tl_blocks=this.querySelector("#_tl_blocks")||document.createElement("div")}render(){return this.html`
      <div id="_tl_link_tooltip" class="tl_link_tooltip"></div>
      <div id="_tl_tooltip" class="tl_tooltip" @mouseover=${this.handleMouseover.bind(this)} @mouseout=${this.handleMouseout.bind(this)}>
        <div class="buttons">
          <span class="button_hover"></span>
          <div class="button_group">
            <button id="_bold_button"></button>
            <button id="_italic_button"></button>
            <button id="_link_button"></button>
          </div>
          <div class="button_group">
            <button id="_header_button"></button>
            <button id="_subheader_button"></button>
            <button id="_quote_button"></button>
          </div>
        </div>
        <div class="prompt">
          <span class="close"></span>
          <div class="prompt_input_wrap"><input type="url" class="prompt_input" /></div>
        </div>
      </div>
      <div id="_tl_blocks" class="tl_blocks">
        <div class="buttons">
          <button id="_image_button"></button>
          <button id="_embed_button"></button>
        </div>
      </div>
    `}handleMouseover(t){let e=t.target;t&&e&&"BUTTON"==e.tagName&&!e.classList.contains("disabled")&&(this.$tl_tooltip.setAttribute("data-hover",e.id),this.$tl_tooltip.classList.add("hover"),setTimeout(()=>{this.$tl_tooltip.classList.add("hover_anim")},1),clearTimeout(this.$tl_tooltip.to))}handleMouseout(t){"BUTTON"==t.target.tagName&&(this.$tl_tooltip.classList.remove("hover"),this.$tl_tooltip.to=setTimeout(()=>{this.$tl_tooltip.classList.remove("hover_anim")},70))}tooltipUpdatePosition(t,e,o,i){if(o=o||{padding:10,position:"top"},null==(e=e||t._range||null))return;let l=i.getBounds(e),n=i.container.getBoundingClientRect(),s={width:t.offsetWidth,height:t.offsetHeight},r=window.outerWidth,a=window.outerHeight,c=document.body.scrollTop,d=9,u=c+9,h=r-s.width-9,p=c+a-s.height-9;s.left=l.left+l.width/2-s.width/2;let f,m=n.left+s.left;if(m<d?s.left=d-n.left:m>h&&(s.left=h-n.left),"top"==o.position){s.top=l.top-s.height-o.padding,f=!1,n.top+s.top<u&&(s.top=l.bottom+o.padding,f=!0)}else if("bottom"==o.position){let t=!1;s.top=l.bottom+o.padding,(t=this.isOverElement(s,o.depend,o.dependPadding))&&(s.top=t.bottom+o.dependPadding),f=!0,n.top+(s.top||0)>p&&(s.top=l.top-s.height-o.padding,(t=this.isOverElement(s,o.depend,o.dependPadding))&&(s.top=t.top-s.height-o.dependPadding),f=!1)}s.left=Math.round(s.left),s.top=Math.round(s.top||0),t._range=e,o.minDelta&&Math.abs(s.left-t._left)<o.minDelta&&Math.abs(s.top-t._top)<o.minDelta||(t._left=s.left,t._top=s.top,t.style.left=s.left+"px",t.style.top=s.top+"px",t.classList.toggle("bottom",f))}isOverElement(t,e,o){if(!e||!e.classList.contains("shown"))return!1;t.bottom=t.top+t.height,t.right=t.left+t.width;let i={_left:e.offsetLeft,_top:e.offsetTop},l={top:i._top,bottom:i._top+e.offsetHeight,left:i._left,right:i._left+e.offsetWidth};return!(t.left-l.right>=o||l.left-t.right>=o||t.top-l.bottom>=o||l.top-t.bottom>=o)&&l}hideBlocksTooltip(){this.$tl_blocks.classList.remove("shown")}showFormatTooltip(t,e,o){o&&(this.$tl_tooltip.classList.remove("tooltip_prompt"),this.tooltipUpdatePosition(this.$tl_tooltip,t,this.formatTTOptions,e),this.$tl_tooltip.classList.contains("move_anim")||setTimeout(()=>{this.$tl_tooltip.classList.add("move_anim")},10),this.$tl_tooltip.classList.contains("shown")?this.tooltipUpdatePosition(this.$tl_link_tooltip,null,this.linkTTOptions,e):setTimeout(()=>{this.$tl_tooltip.classList.add("shown"),this.tooltipUpdatePosition(this.$tl_link_tooltip,null,this.linkTTOptions,e)},10))}hideFormatTooltip(t){this.$tl_tooltip.classList.remove("move_anim","shown"),this.tooltipUpdatePosition(this.$tl_link_tooltip,null,this.linkTTOptions,t)}showBlocksTooltip(t,e,o){e&&(this.$tl_blocks.classList.add("shown"),this.blocksUpdatePosition(t,o))}blocksUpdatePosition(t,e){if(void 0===t&&(t=e.getSelection()),null==t||!e)return;let o=e.getBounds(t);this.$tl_blocks.style.top=o.top+o.height/2+"px"}showLinkTooltip(t,e,o,i){if(!o)return;let l={index:t.offset(i.scroll),length:t.length()};this.$tl_link_tooltip.textContent=e,this.tooltipUpdatePosition(this.$tl_link_tooltip,l,this.linkTTOptions,i),this.$tl_link_tooltip.classList.contains("move_anim")||setTimeout(()=>{this.$tl_link_tooltip.classList.add("move_anim")},1),this.$tl_link_tooltip.classList.contains("shown")||setTimeout(()=>{this.$tl_link_tooltip.classList.add("shown")},10)}hideLinkTooltip(t){this.$tl_link_tooltip.classList.remove("move_anim","shown")}};r=function(t,e,o,i){var l,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(l=t[r])&&(s=(n<3?l(s):n>3?l(e,o,s):l(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s}([Object(i.b)("inscriptum-editor-tooltip")],r)}}]);