"use strict";(self.webpackChunkinscriptum=self.webpackChunkinscriptum||[]).push([[943],{1760:(t,e,n)=>{n.d(e,{j7:()=>s,Bc:()=>l});var r=n(6798);var i=n(8638),a=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((r=r.apply(t,e||[])).next())}))};const o=/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/,s="figure",l=r.NB.create({name:s,draggable:!0,defining:!0,selectable:!0,content:()=>"text*",addOptions:()=>({inline:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML:()=>[{tag:"figure",contentElement:"figcaption",getAttrs:t=>{const e=t.querySelector("img");return{src:null==e?void 0:e.getAttribute("src"),alt:null==e?void 0:e.getAttribute("alt"),title:null==e?void 0:e.getAttribute("title")}}},{tag:"img[src]",preserveWhitespace:!0,getContent:(t,e)=>i.HY.from(e.text(t.alt.length>0?t.alt:" ")),getAttrs:t=>({src:t.getAttribute("src")})}],renderHTML({HTMLAttributes:t}){return["figure",["img",(0,r.P1)(this.options.HTMLAttributes,t)],["figcaption",0]]},addCommands(){return{setFigure:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[(0,r.x2)({find:o,type:this.type,getAttributes:t=>{const[,e,n,r]=t;return{src:n,alt:e,title:r}}})]},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const i=document.createElement("figure");i.setAttribute("draggable","true");const o=document.createElement("div"),s=document.createElement("figcaption");o.classList.add("figure_wrapper"),o.contentEditable="false",s.classList.add("editable_text"),s.classList.add("empty"),s.setAttribute("data-placeholder","Caption (optional)");const l=t.content.firstChild;(null==l?void 0:l.isText)&&null!=l.text&&l.text.trim().length>0&&s.classList.remove("empty"),i.appendChild(o),i.appendChild(s);const u=function(t,e){const n=document.createElement("img");return n.setAttribute("src",c(t)),e.appendChild(n),n}(t.attrs.src,o);t.attrs.alt&&u.setAttribute("alt",t.attrs.alt),t.attrs.title&&u.setAttribute("title",t.attrs.title);const d=function(t){const e=t.match(/^data:(image\/gif|image\/jpe?g|image\/png|video\/mp4);base64,(.*)$/);if(null!=e)return{type:e[1],base64_data:e[2]}}(t.attrs.src);if(null!=d){const t=document.createElement("div"),e=document.createElement("div");t.classList.add("file_progress"),e.classList.add("file_progress_bar"),o.classList.add("loading"),t.appendChild(e),o.appendChild(t),function(t,e,n){!function(t,e,n,r){a(this,void 0,void 0,(function*(){try{const r=yield function(t,e){return new Promise(((n,r)=>{var i=new XMLHttpRequest,a=new FormData;i.open("POST","https://api.cloudinary.com/v1_1/inscriptum/upload",!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.upload.addEventListener("progress",(function(t){t.lengthComputable&&e&&e(t.loaded,t.total)})),e&&e(0,1),a.append("upload_preset","cz5pibn5"),a.append("tags","browser_upload"),a.append("file",t),i.send(a),i.onreadystatechange=t=>{if(4==i.readyState&&200==i.status){var e=JSON.parse(i.responseText);console.log(1111,e),e.src=e.secure_url,n(e)}},i.onerror=function(){r(new Error("Network Error"))}}))}(function(t){for(var e=atob(t.base64_data),n=[],r=0;r<e.length;r++)n.push(e.charCodeAt(r));return new Blob([new Uint8Array(n)],{type:t.type})}(t),e);n&&n(r)}catch(t){r&&r(t)}}))}(t,((t,e)=>{let r=0;e&&t&&(r=100*t/e,r=Math.min(100,r)),n.style.width=r+"%"}),(t=>{if(t){const n=c(t.src),r=e.querySelector("img");null!=r&&(r.src=n),e.classList.remove("loading")}}),(t=>function(t){let e=document.querySelector("#_error_msg");e.textContent=t,clearTimeout(e.to),e.classList.add("shown"),e.to=setTimeout((()=>{e.classList.remove("shown")}),3e3)}(t)))}(d,o,e)}return u.onclick=()=>{"function"==typeof n&&this.editor.commands.setNodeSelection(n())},{dom:i,contentDOM:s,ignoreMutation:e=>"attributes"===e.type&&null!=e.attributeName&&(["src","title","alt"].includes(e.attributeName)&&(t.attrs[e.attributeName]=e.target.getAttribute(e.attributeName)),!0),update:t=>t.type===this.type&&(s.classList.toggle("empty",0===t.content.size),!0)}}}});function c(t){return function(t,e){const n=document.createElement("a");n.href=t;const r=n.href.slice(0,n.href.indexOf(":"));return e.indexOf(r)>-1}(t,["http","https","data"])?t:"//:0"}},9586:(t,e,n)=>{n.d(e,{W:()=>i,V:()=>a});var r=n(6798);const i="topicSummary",a=r.NB.create({name:i,group:"topicDoc",content:"inline*",addAttributes:()=>({"data-placeholder":{default:"Summary of the text"},"data-label":{default:"Summary"},role:{default:"definition"}}),parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",(0,r.P1)(this.options.HTMLAttributes,t),0]}})},9059:(t,e,n)=>{n.d(e,{H:()=>i,l:()=>a});var r=n(6798);const i="topicTitle",a=r.NB.create({name:i,content:"inline*",group:"topicDoc",defining:!0,selectable:!0,addAttributes:()=>({"data-placeholder":{default:"Title"},"data-label":{default:"Title"}}),parseHTML:()=>[{tag:"h1"}],renderHTML({HTMLAttributes:t}){return["h1",(0,r.P1)(this.options.HTMLAttributes,t),0]}})},4938:(t,e,n)=>{n.d(e,{WV:()=>o,iv:()=>l,Ro:()=>c});var r=n(1760),i=n(9586),a=n(9059);function o(t){var e,n,o;let l="<noname>",c="...",u="";if(null!=t){const d=s(t,a.H);null!=(null==d?void 0:d.content)&&(l=null!==(e=d.content[0].text)&&void 0!==e?e:l);const p=s(t,i.W);null!=(null==p?void 0:p.content)&&(c=null!==(n=p.content[0].text)&&void 0!==n?n:c);const f=s(t,r.j7);null!=(null==f?void 0:f.attrs)&&(u=null!==(o=f.attrs.src)&&void 0!==o?o:u)}return c=c.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/`/g,"&DiacriticalGrave;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),{title:l,description:c,image:u}}function s(t,e){if(t.type===e)return t;if(Array.isArray(t.content))for(const n of t.content){const t=s(n,e);if(null!=t)return t}return null}const l=String.raw;function c(t,e=!1){const n="щ   ш  ч  ц  ю  я  ё  ж  ъ  ы  э  а б в г д е з и й к л м н о п р с т у ф х ь".split(/ +/g),r="shh sh ch cz yu ya yo zh `` y' e` a b v g d e z i j k l m n o p r s t u f x `".split(/ +/g);for(let i=0;i<n.length;i++)t=(t=t.split(e?r[i]:n[i]).join(e?n[i]:r[i])).split(e?r[i].toUpperCase():n[i].toUpperCase()).join(e?n[i].toUpperCase():r[i].toUpperCase());return t}},7848:(t,e,n)=>{n.d(e,{G:()=>c});var r=n(5467),i=n(7948),a=n(3e3),o=n(4727),s=n(5196),l=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((r=r.apply(t,e||[])).next())}))};function c(t,e=`${document.location.origin}/drafts`){return l(this,void 0,void 0,(function*(){return new Promise((n=>{a.f.pipe((0,o.q)(1)).subscribe((t=>{var n;null!=(null===(n=t.data)||void 0===n?void 0:n.accessToken)||t.isLoading||i.Z.dispatch({type:r.C.AUTH,payload:{redirectUri:e}})})),a.f.pipe((0,s.P)((t=>null!=t.data&&!t.isLoading))).subscribe((e=>{console.log("authorizedWork AUTH_ACTION.AUTH_DONE"),n(t(e.data))}))}))}))}},669:(t,e,n)=>{n.d(e,{$:()=>l});var r=n(1640),i=n(7167),a=n(3255);class o extends i.s{render(t,e){return e.current=this,t}}const s=(0,a.XM)(o);function l(t,e){if(!(e.current instanceof HTMLElement))return e.current instanceof o&&e.current.setValue(t),s(t,e);(0,r.sY)(t,e.current)}}}]);