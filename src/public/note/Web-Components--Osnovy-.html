  
    <html>
      <head>
        <meta charset="utf-8">
        <title>Web Components. Основы</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="MobileOptimized" content="176">
        <meta name="HandheldFriendly" content="True">
        <meta name="robots" content="index, follow">
        <meta name="description" content="Базовые вещи касательно Web Components. Способы создания элементов веб-страницы на основе Web Components. Четыре спецификации Web Components. Фундаментальные аспекты компонентов.">
        <meta property="og:site_name" content="inscriptum">
        <meta property="og:type" content="article">
        <meta property="og:title" content="Web Components. Основы">
        <meta property="og:description" content="Базовые вещи касательно Web Components. Способы создания элементов веб-страницы на основе Web Components. Четыре спецификации Web Components. Фундаментальные аспекты компонентов.">
        <meta property="og:image" content="https://inscriptum.js.org/data/articles/webcomponents-base/images/recipe.jpg">
        <meta property="article:published_time" content="2019-09-26T19:19:34+00:00">
        <meta property="article:modified_time" content="2022-01-01T14:54:02.082Z">
        <meta property="article:author" content="test@test.test">
        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Web Components. Основы">
        <meta name="twitter:description" content="Базовые вещи касательно Web Components. Способы создания элементов веб-страницы на основе Web Components. Четыре спецификации Web Components. Фундаментальные аспекты компонентов.">
        <meta name="twitter:image" content="https://inscriptum.js.org/data/articles/webcomponents-base/images/recipe.jpg">
        <style>
@font-face {
  font-family: "Inter";
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url(/fonts/inter/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format("woff2");
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}

@font-face {
  font-family: "Inter";
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url(/fonts/inter/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format("woff2");
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: "JetBrainsMono";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/fonts/jetbrainsmono/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTPlOTk6OThhvAWV8.woff) format("woff");
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}

@font-face {
  font-family: "JetBrainsMono";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/fonts/jetbrainsmono/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOlOTk6OThhvA.woff) format("woff");
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
html {
  font-family: sans-serif;
}

@supports (font-variation-settings: normal) {
  html {
    font-family: "Inter var", sans-serif;
  }
}
.container {
  max-width: 800px;
}
</style>
        <link rel="shortcut icon" type="image/png" href="favicon.png">
        <link href="/css/note.css" rel="stylesheet">
        <link href="/css/custom_editor_fonts.css" rel="stylesheet">
      </head>
      <body>
        <article>
          <section><h1 data-placeholder="Title" data-label="Title">Web Components. Основы</h1><p data-placeholder="Summary of the text" data-label="Summary" role="definition">Базовые вещи касательно Web Components. Способы создания элементов веб-страницы на основе Web Components. Четыре спецификации Web Components. Фундаментальные аспекты компонентов.</p><p data-placeholder="Take a notes">Что из себя представляют Web Components</p><p>Рецепт Web Components прост - это три фундаментальных блока: HTML, CSS и JavaScript.</p><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/recipe.jpg"><figcaption></figcaption></figure><p>HTML определяет каркас компонента, является разметкой как и для обычной страницы. CSS отвечает за визуальное отображение. JavaScript - это логика компонента, его поведение и функциональность. Спецификации Web Components позволяют нам использовать эти три технологии вместе для построения собственных компонентов. Отсутствие дополнительных требований и инструментов существенно упрощают создание и использование таких компонентов как отдельно, так и внутри уже существующих приложений.</p><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/wc.jpg"><figcaption></figcaption></figure><p>Компоненты, создаваемые на основе принципов Web Components, на сегодняшний день, имеют максимальную модульность, гибкость и переиспользуемость. Независимость от иного контента на странице дает возможность не беспокоиться о неправильном отображении.</p><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/shadow-root.png"><figcaption></figcaption></figure><p>А наследование и переиспользование уже существующих компонентов делают их универсальным инструментом для приложений любых масштабов. Но, пожалуй, основным достоинством Web Components остается их простота - разработчикам нет необходимости изучать дополнительные фреймворки и библиотеки, все, что нужно - это HTML, CSS и JavaScript.</p><p>Таким образом достигаются следующие цели:</p><ul><li><p>изоляция стилей;</p></li><li><p>отсутствие зависимостей в виде библиотек и фреймворков;</p></li><li><p>универсальность и простота компонентов.</p></li></ul><h3>Спецификации Web Components</h3><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/spec.jpeg"><figcaption></figcaption></figure><p>Web Components состоит из четырех спецификаций:</p><ul><li><p>Custom Elements</p></li><li><p>Shadow DOM</p></li><li><p>HTML Templates</p></li><li><p>HTML Imports</p></li></ul><p>Каждая из этих спецификаций предоставляет отдельную функциональность для создания и использования компонентов.</p><h3>Custom Elements</h3><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/custom-elements.jpeg"><figcaption></figcaption></figure><p>Custom Elements описывает как создавать собственные DOM элементы, добавлять свойства и функции к ним, а также расширять их на основе уже существующих элементов. Для создания пользовательского DOM элемента необходимо использовать классы ES2015. Рассмотрим создание пользовательского элемента на простом примере.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;Custom Elements<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-keyword">class</span> <span class="hljs-title class_">FirstCustomElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-title function_">constructor</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">super</span>();</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''constructor''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; }</div><div class="l">&nbsp;&nbsp;</div><div class="l">&nbsp; &nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">''first-custom-element''</span>, <span class="hljs-title class_">FirstCustomElement</span>);</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">first-custom-element</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">first-custom-element</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt;&nbsp;</div><div class="l"></div></code></pre><p>Был создан класс расширяющий нативный HTMLElement. Таким образом мы унаследовали функции самого базового DOM элемента. Внутри класса определен конструктор, который будет вызван при создании элемента. В конструкторе обязательно необходимо вызвать метод super() чтобы выполнился конструктор базового класса. Наконец, вызываем метод window.customElements.define, определенный в спецификации Custom Elements v1. На вход он принимает название тега, который в дальнейшем будет использован на странице и, собственно, класс для создания элемента. Теперь мы можем в теле документа вставить наш элемент, после чего в консоли выведется сообщение из метода конструктора.</p><p>Помимо конструктора в Custom Elements присутствует ряд методов, предоставляемых API и описанных в спецификации, как методы жизненного цикла (lifecycle hooks). Они используются для выполнения определенных участков кода в отдельные периоды “жизни” компонента.</p><p>Рассмотрим три наиболее употребимых из них. Для этого изменим предыдущий пример следующим образом:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;Custom Elements<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">class</span> <span class="hljs-title class_">FirstCustomElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">constructor</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">super</span>();</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''constructor''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">connectedCallback</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''connectedCallback''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">observedAttributes</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">return</span> [<span class="hljs-string">''test''</span>]</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">attributeChangedCallback</span>(<span class="hljs-params">name, oldValue, newValue</span>) {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''attributeChangedCallback ''</span>, name, oldValue, newValue);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">disconnectedCallback</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''disconnectedCallback''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">''first-custom-element''</span>, <span class="hljs-title class_">FirstCustomElement</span>);</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">first-custom-element</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">first-custom-element</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><ul><li><p><strong>connectedCallback</strong> выполняется в момент добавления элемента к DOM;</p></li><li><p><strong>attributeChangedCallback</strong> метод выполняемый в момент изменения атрибутов. Он позволяет подписываться на изменения определенных атрибутов. Для того, чтобы можно было указать какие именно из них отслеживать статический метод observedAttributes должен вернуть их в виде массива текстовых значений.</p></li><li><p><strong>disconnectedCallback</strong> выполняется в момент удаления элемента из DOM. Данный метод наиболее удобен, если необходимо выполнить некоторую работу (удалить интервалы, очистить дополнительные данные) после удаления.</p></li></ul><p><strong>Расширение Custom Elements</strong>&nbsp;- это возможность создавать свои элементы, основываясь на уже созданных ранее. Для понимания рассмотрим пример.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;Custom Elements<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloCustomElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">sayHello</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''Hello!''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">''hello-custom-element''</span>, <span class="hljs-title class_">HelloCustomElement</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">class</span> <span class="hljs-title class_">HowAreYouCustomElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HelloCustomElement</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">constructor</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">super</span>();</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">howAreYou</span>();</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">howAreYou</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sayHello</span>();</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">''How are you!''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">''howareyou-custom-element''</span>, <span class="hljs-title class_">HowAreYouCustomElement</span>);</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">howareyou-custom-element</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">howareyou-custom-element</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>После выполнения в консоли будет выведено:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l">Hello<span class="hljs-operator">!</span></div><div class="l">How <span class="hljs-keyword">are</span> you<span class="hljs-operator">!</span></div><div class="l"></div></code></pre><p><strong>Расширение Custom Elements на основе стандартных элементов</strong>&nbsp;- еще одна очень важная функция при создании своих элементов. Если необходимо добавить небольшой функционал к стандартному DOM элементу это можно сделать через его расширение. Предположим, что у нас есть input, в котором при его создании должно появиться подготовленное заранее содержимое.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;Custom Elements<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdnjs.cloudflare.com/ajax/libs/document-register-element/1.5.0/document-register-element.js"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloInputCustomElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLInputElement</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title function_">connectedCallback</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">''value''</span>, <span class="hljs-string">''Hello''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-string">''helloinput-custom-element''</span>,&nbsp;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-title class_">HelloInputCustomElement</span>, {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">extends</span>: <span class="hljs-string">''input''</span></div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; );</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span> <span class="hljs-attr">is</span>=<span class="hljs-string">"helloinput-custom-element"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">input</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>В результате, после создания в нашем элементе input будет содержаться текст <code>Hello</code>. Для расширения стандартного элемента мы выполнили следующие шаги:</p><ol><li><p>Унаследовались от расширяемого элемента extends HTMLInputElement.</p></li><li><p>При создании элемента добавили тег расширяемого элемента <code>window.customElements.define(''helloinput-custom-element'', HelloInputCustomElement, {extends: ''input''}).</code></p></li><li><p>В документе наш элемент используется через указание атрибута is в стандартном теге.</p></li><li><p>Важно! На данный момент расширение стандартных элементов не реализовано в большинстве браузеров, поэтому необходимо воспользоваться&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/WebReflection/document-register-element#using-innerhtml">поллифилом</a>&nbsp;выше мы подключили его через cdn.</p></li></ol><p>Итак, мы рассмотрели, пожалуй, основную из спецификаций Web Components. Custom Elements является ядром компонента, именно с неё начинается его создание.</p><h3>Shadow DOM</h3><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/shadow-dom.jpeg"><figcaption></figcaption></figure><p>Следующая из спецификаций Web Components называется Shadow DOM. Она позволяет создавать дополнительное DOM дерево для создаваемого элемента. Особенность такого внутреннего DOM дерева заключается в его инкапсуляции - независимости от основного DOM дерева.</p><p>Существует два способа использования Shadow DOM - в закрытом и открытом виде:</p><ul><li><p><strong>open</strong> - открытый тип, позволяет получить полный контроль над дополнительным DOM-ом;</p></li><li><p><strong>close</strong> - закрытый тип, не позволяет манипулировать дополнительным DOM-ом после его создания.</p></li></ul><p>Рассмотрим пример кода:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l">	<span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l">	 </div><div class="l">	<span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;Shadow DOM<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">style</span>&gt;</div><div class="l">	        <span class="hljs-selector-tag">input</span> {</div><div class="l">	            <span class="hljs-attribute">border-color</span>: red;</div><div class="l">	            <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</div><div class="l">	        }</div><div class="l">	    <span class="hljs-tag">&lt;/</span><span class="hljs-name">style</span>&gt;</div><div class="l">	<span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l">	</div><div class="l"> </div><div class="l">	<span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hello"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</div><div class="l">	</div><div class="l"> </div><div class="l">	    <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span>&gt;</div><div class="l">	        let $helloDiv = document.getElementById(''hello'');</div><div class="l">	        $helloDiv.attachShadow({</div><div class="l">	            mode: "open"</div><div class="l">	        });</div><div class="l">	        $helloDiv.shadowRoot.innerHTML =</div><div class="l">	            `<span class="hljs-tag">&lt;</span><span class="hljs-name">style</span>&gt;</div><div class="l">	                <span class="hljs-selector-tag">input</span> {</div><div class="l">	                <span class="hljs-attribute">border</span>: none;</div><div class="l">	                }</div><div class="l">	            <span class="hljs-tag">&lt;/</span><span class="hljs-name">style</span>&gt;</div><div class="l">				<span class="hljs-tag">&lt;</span><span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"hello"</span>/&gt;`</div><div class="l">             ;</div><div class="l">  	    <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l">  	<span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l">  	</div><div class="l">  	<span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>В результате его исполнения браузер отобразит три input элемента, два из них с красной рамкой и один без нее:</p><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/shadow-dom_example.png"><figcaption></figcaption></figure><p>Такой результат получился в результате использования функции attachShadow и добавления дополнительного содержимого через shadowRoot.innerHTML. Если посмотреть в инспектор кода, то можно увидеть структуру дерева дополнительного DOM.</p><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/shadow-root.png"><figcaption></figcaption></figure><p>Дополнительное содержимое было добавлено в shadow-root. Это позволяет компонентам не влиять на общие стили страницы и не испытывать их влияние на себе.</p><h3>HTML Templates</h3><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/html-templates.jpeg"><figcaption></figcaption></figure><p>HTML Templates позволяет создавать шаблоны на основе HTML. Такие шаблоны обладают рядом особенностей:</p><ol><li><p>Создаются с помощью тега&nbsp;.</p></li><li><p>Не отображаются в браузере до момента их явного использования.</p></li><li><p>Могут быть использованы для определения разметки компонента и её дальнейшего рендеринга во время создания.</p></li></ol><p>Для использования шаблона достаточно создать разметку внутри тега template:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;HTML Templates<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"task"</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span>&gt;Task name<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span>&gt;Task body<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">li</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">template</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">ui</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"todo-list"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">ui</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> tasks = [{</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">name</span>: <span class="hljs-string">"Сделать зарядку"</span>,</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">body</span>: <span class="hljs-string">"Разминка, пробежка, подтягивание на перекладине"</span></div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">name</span>: <span class="hljs-string">"Купить продукты"</span>,</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">body</span>: <span class="hljs-string">"Хлеб, овощи, чай"</span></div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">name</span>: <span class="hljs-string">"Подготовить доклад"</span>,</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attr">body</span>: <span class="hljs-string">"Найти проблему, описать суть, найти решение"</span></div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; ];</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> $template = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">''task''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> $todoList = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">''todo-list''</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; tasks.<span class="hljs-title function_">forEach</span>(<span class="hljs-params">task</span> =&gt; {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> $clone = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">importNode</span>($template.<span class="hljs-property">content</span>, <span class="hljs-literal">true</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $clone.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">''h1''</span>).<span class="hljs-property">innerText</span> = task.<span class="hljs-property">name</span>;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $clone.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">''p''</span>).<span class="hljs-property">innerText</span> = task.<span class="hljs-property">body</span>;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $todoList.<span class="hljs-title function_">appendChild</span>($clone);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; });</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>В примере выше у нас есть список задач и шаблон для отображения отдельной задачи. С помощью функции document.importNode мы создаем клон шаблона (глубокое клонирование при помощи второго параметра со значением true). Далее измененный шаблон добавляется к элементу списка задач функцией appendChild. Как видно из примера, шаблон был переиспользован несколько раз внутри цикла.</p><p>HTML Templates является наиболее устоявшейся из спецификаций, она реализована во всех современных браузерах.</p><h3>HTML Imports</h3><figure><img src="https://inscriptum.js.org/data/articles/webcomponents-base/images/html-imports.jpeg"><figcaption></figcaption></figure><p>Последней из спецификаций Web Components является HTML Imports. Как и следует из её названия она описывает способ импорта html файла. Это можно сравнить с импортом css файла внутри страницы. Только в данном случае вместо разметки стилей будет загружен файл с одним или более компонентами.</p><p>Для демонстрации создадим два файла. Первый hello.html с содержимым:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l">  </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span>&gt;Hello Web Components!<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>Второй index.html:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;HTML Imports<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"import"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"hello.html"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hello"</span> /&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> $link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"hello"</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> content = $link.<span class="hljs-property">import</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"h1"</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(content.<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>));</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>Открытие страницы index выведет заголовок из файла hello.html.</p><p>HTML Imports является наиболее спорной из всех спецификаций, на сегодняшний день она реализована только в браузере Chrome и Opera. К тому же, смысл работы данной спецификации выглядит несколько избыточным с появлением динамических импортов в ES2015. Тем не менее, функция загрузки компонентов через импорт html файла существует и может оказаться весьма нужной в отдельных случаях.</p><h3>Итог</h3><p>На этом мы закончили рассмотрение основ Web Components. Познакомились с целями, которые позволяют достичь компоненты и как эти цели коррелируют с четырьмя спецификациями:</p><ul><li><p>Custom Elements - создание элемента внутри страницы со своим жизненным циклом, разметкой и логикой отображения.</p></li><li><p>Shadow DOM - дополнительный DOM внутри страницы, позволяющий добиться инкапсуляции стилей.</p></li><li><p>HTML Templates - шаблон для переиспользуемых частей внутри компонентов.</p></li><li><p>HTML Imports - импорт html файлов внутри основной страницы.</p></li></ul><h3>Ссылки</h3><ul><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/webcomponents/webcomponentsjs"><strong>webcomponentsjs</strong></a>&nbsp;и&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://www.webcomponents.org/polyfills"><strong>polyfills</strong></a>&nbsp;- полифиллы и как их использовать (для работы еще нереализованных спецификаций в браузерах).</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://developers.google.com/web/fundamentals/getting-started/primers/customelements"><strong>Custom Elements</strong></a>.</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://developers.google.com/web/fundamentals/getting-started/primers/shadowdom"><strong>Shadow DOM</strong></a>.</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.html5rocks.com/en/tutorials/webcomponents/template/"><strong>HTML Templates</strong></a>.</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.html5rocks.com/en/tutorials/webcomponents/imports/"><strong>HTML Imports</strong></a>.</p></li></ul></section>
        </article>
      </body>
      <script type="text/javascript" src="/js/note.js"></script>
    </html>