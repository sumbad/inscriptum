  
    <html>
      <head>
        <meta charset="utf-8">
        <title>Web Components. Принцип использования</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="MobileOptimized" content="176">
        <meta name="HandheldFriendly" content="True">
        <meta name="robots" content="index, follow">
        <meta name="description" content="Рассмотрение вопросов использования Web Components в приложении, какие существуют подходы, их плюсы и минусы. Способы подключения компонентов через HTML Imports и JavaScript.">
        <meta property="og:site_name" content="inscriptum">
        <meta property="og:type" content="article">
        <meta property="og:title" content="Web Components. Принцип использования">
        <meta property="og:description" content="Рассмотрение вопросов использования Web Components в приложении, какие существуют подходы, их плюсы и минусы. Способы подключения компонентов через HTML Imports и JavaScript.">
        <meta property="og:image" content="">
        <meta property="article:published_time" content="2019-09-26T12:43:16+00:00">
        <meta property="article:modified_time" content="2022-01-01T14:35:06.335Z">
        <meta property="article:author" content="test@test.test">
        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Web Components. Принцип использования">
        <meta name="twitter:description" content="Рассмотрение вопросов использования Web Components в приложении, какие существуют подходы, их плюсы и минусы. Способы подключения компонентов через HTML Imports и JavaScript.">
        <meta name="twitter:image" content="">
        <style>
@font-face {
  font-family: "Inter";
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url(/fonts/inter/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format("woff2");
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}

@font-face {
  font-family: "Inter";
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url(/fonts/inter/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format("woff2");
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: "JetBrainsMono";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/fonts/jetbrainsmono/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTPlOTk6OThhvAWV8.woff) format("woff");
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}

@font-face {
  font-family: "JetBrainsMono";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/fonts/jetbrainsmono/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOlOTk6OThhvA.woff) format("woff");
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
html {
  font-family: sans-serif;
}

@supports (font-variation-settings: normal) {
  html {
    font-family: "Inter var", sans-serif;
  }
}
.container {
  max-width: 800px;
}
</style>
        <link rel="shortcut icon" type="image/png" href="favicon.png">
        <link href="/css/note.css" rel="stylesheet">
      </head>
      <body>
        <article>
          <section><h1 data-placeholder="Title" data-label="Title">Web Components. Принцип использования</h1><p data-placeholder="Summary of the text" data-label="Summary" role="definition">Рассмотрение вопросов использования Web Components в приложении, какие существуют подходы, их плюсы и минусы. Способы подключения компонентов через HTML Imports и JavaScript.</p><p data-placeholder="Take a notes">Использование Web Components посредством спецификации HTML Imports</p><p>В предыдущей статье мы рассмотрели четыре спецификации Web Components, одна из них это HTML Imports. Напомню, что основное её назначение это механизм внедрения созданного компонента в приложение. Создадим компонент use.html следующим образом:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">template</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">style</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-selector-tag">h1</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-attribute">background-color</span>: dimgray;</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-attribute">color</span>: darkgray;</div><div class="l">&nbsp; &nbsp; }</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">style</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span>&gt;Use Web Components!<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">template</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">script</span>&gt;</div><div class="l">&nbsp; <span class="hljs-keyword">const</span> $ownerDocument = <span class="hljs-variable language_">document</span>.<span class="hljs-property">currentScript</span>.<span class="hljs-property">ownerDocument</span>;</div><div class="l">&nbsp; <span class="hljs-keyword">const</span> $template = $ownerDocument.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"template"</span>);</div><div class="l">&nbsp; <span class="hljs-keyword">class</span> <span class="hljs-title class_">UseWebComponents</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {</div><div class="l">&nbsp; &nbsp; <span class="hljs-title function_">connectedCallback</span>(){</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-keyword">const</span> $content = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">importNode</span>($template.<span class="hljs-property">content</span>, <span class="hljs-literal">true</span>);</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">appendChild</span>($content);</div><div class="l">&nbsp; &nbsp; }</div><div class="l">&nbsp; }</div><div class="l">&nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">"use-web-components"</span>, <span class="hljs-title class_">UseWebComponents</span>);</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt; </div><div class="l"></div></code></pre><p>Используем компонент use-web-components в файле index.html:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;HTML Imports<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"import﻿﻿﻿"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"use.html"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"use"</span> /&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">use-web-components</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">use-web-components</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt;﻿</div><div class="l"></div></code></pre><p>В примере выше весь код нашего компонента был сосредоточен в html файле. Далее, в соответствии с HTML Imports мы подключили компонент к основному приложению в index.html через строку</p><p><br></p><p>Подключение компонентов с помощью спецификации HTML Imports имеет ряд преимуществ:</p><ol><li><p>Автоматически исключаются множественные импорты на уровне браузера.</p></li><li><p>Написание разметки HTML, CSS стилей и JS кода в одном html файле поддерживается всеми редакторами и средами разработки, а также не противоречит принципам Web.</p></li></ol><p>Но есть и весомые отрицательные стороны у данного подхода:</p><ol><li><p>Спецификация HTML Imports не поддерживается во всех современных браузерах. Их производители до сих пор не пришли к общему мнению по данному вопросу.</p></li><li><p>Данные подход затруднительно использовать с современными системами сборки, такими как Webpack.</p></li><li><p>Если в приложении используется несколько компонентов, то все их придется подгружать через link с атрибутом rel="import" или хранить все компоненты в одном файле. И первое и второе нельзя назвать хорошим решением.</p></li><li><p>HTML Imports появилась до динамических импортов ES2015. Теперь же гораздо предпочтительнее использовать JavaScript для загрузки дополнительной функциональности, что в некотором роде нивелирует преимущества HTML Imports.</p></li></ol><h3>Использование Web Components посредством JavaScript</h3><p>Чтобы понять механизм создания и подключения компонента на JavaScript, и сравнить его с предыдущим подходом, создадим аналогичный пример. Компонент use.js:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l">class UseWebComponents extends HTMLElement {</div><div class="l">&nbsp; connectedCallback(){</div><div class="l">&nbsp; &nbsp; this.innerHTML = `</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">style</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-selector-tag">h1</span> {</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attribute">background-color</span>: dimgray;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-attribute">color</span>: darkgray;</div><div class="l">&nbsp; &nbsp; &nbsp; &nbsp; }</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">style</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span>&gt;Use Web Components!<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span>&gt;</div><div class="l">&nbsp; &nbsp; `;</div><div class="l">&nbsp; }</div><div class="l">}</div><div class="l"> </div><div class="l"> </div><div class="l">window.customElements.define("use-web-components", UseWebComponents); </div><div class="l"></div></code></pre><p>Используем компонент use-web-components в файле index.html:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span>&gt;HTML Imports<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"use.js"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">use-web-components</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">use-web-components</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>При подключении компонентов с помощью JavaScript гораздо больше преимуществ и меньше недостатков. Из плюсов:</p><ol><li><p>Близость современным JavaScript разработчикам. Этот подход не нужно разбирать и заново осмысливать, он близок всем, кто создавал компоненты на ReactJS или Angular.</p></li><li><p>Подключение компонента подобно подключению любого другого js файла.</p></li><li><p>Не требует дополнительных полифилов для работы.</p></li><li><p>Просто использовать вместе с Webpack.</p></li></ol><p>Но есть и весомые отрицательные стороны у данного подхода:</p><ol><li><p>Писать HTML и CSS внутри JS кода может показаться не лучшей идеей.</p></li><li><p>Писать разметку в виде шаблонных строк неудобно, тем более, что в этом случае почти все среды разработки будут воспринимать её как обычную строку.</p></li></ol><p>Хоть данный подход и не лишен своих минусов, использовать его гораздо удобнее.</p><h3>Итог</h3><p>При создании компонента необходимо заранее определить способ его дальнейшего использования. Существует два подхода:</p><ul><li><p>подключать компоненты с помощью HTML Imports;</p></li><li><p>загружать компоненты как обычные JavaScript файлы.</p></li></ul><p>Оба подхода имеют плюсы и минусы, но, пожалуй, решающим является современная экосистема JavaScript, которая делает второй фаворитом. Помимо возможности использовать сборки и лучшие практики компоновки приложений, он позволяет подключать компоненты в современных браузерах без загрузки дополнительных зависимостей в виде полифилов.</p><h3>Ссылки</h3><ul><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/webcomponents/webcomponentsjs"><strong>webcomponentsjs</strong></a>&nbsp;и&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://www.webcomponents.org/polyfills"><strong>polyfills</strong></a>&nbsp;- полифиллы и как их использовать (для работы еще не реализованных спецификаций в браузерах).</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.html5rocks.com/en/tutorials/webcomponents/imports/"><strong>HTML Imports</strong></a>.</p></li></ul></section>
        </article>
      </body>
      <script type="text/javascript" src="/js/note.js"></script>
    </html>