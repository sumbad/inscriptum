  
    <html>
      <head>
        <meta charset="utf-8">
        <title>Использование Vue.js для создания пользовательских Web компонентов</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="MobileOptimized" content="176">
        <meta name="HandheldFriendly" content="True">
        <meta name="robots" content="index, follow">
        <meta name="description" content="Перевод статьи Simon Tarchichi &quot;Use Vue.js to create custom web components&quot;. Автор делает краткий обзор Web components и показывает как их можно создавать с помощью Vue.js.">
        <meta property="og:site_name" content="inscriptum">
        <meta property="og:type" content="article">
        <meta property="og:title" content="Использование Vue.js для создания пользовательских Web компонентов">
        <meta property="og:description" content="Перевод статьи Simon Tarchichi &quot;Use Vue.js to create custom web components&quot;. Автор делает краткий обзор Web components и показывает как их можно создавать с помощью Vue.js.">
        <meta property="og:image" content="">
        <meta property="article:published_time" content="2019-09-04T04:52:26+00:00">
        <meta property="article:modified_time" content="2022-01-01T14:59:20.145Z">
        <meta property="article:author" content="test@test.test">
        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Использование Vue.js для создания пользовательских Web компонентов">
        <meta name="twitter:description" content="Перевод статьи Simon Tarchichi &quot;Use Vue.js to create custom web components&quot;. Автор делает краткий обзор Web components и показывает как их можно создавать с помощью Vue.js.">
        <meta name="twitter:image" content="">
        <style>
@font-face {
  font-family: "Inter";
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url(/fonts/inter/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format("woff2");
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}

@font-face {
  font-family: "Inter";
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url(/fonts/inter/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format("woff2");
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: "JetBrainsMono";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/fonts/jetbrainsmono/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTPlOTk6OThhvAWV8.woff) format("woff");
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}

@font-face {
  font-family: "JetBrainsMono";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/fonts/jetbrainsmono/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOlOTk6OThhvA.woff) format("woff");
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
html {
  font-family: sans-serif;
}

@supports (font-variation-settings: normal) {
  html {
    font-family: "Inter var", sans-serif;
  }
}
.container {
  max-width: 800px;
}
</style>
        <link rel="shortcut icon" type="image/png" href="favicon.png">
        <link href="/css/note.css" rel="stylesheet">
      </head>
      <body>
        <article>
          <section><h1 data-placeholder="Title" data-label="Title">Использование Vue.js для создания пользовательских Web компонентов</h1><p data-placeholder="Summary of the text" data-label="Summary" role="definition">Перевод статьи Simon Tarchichi&nbsp;"Use Vue.js to create custom web components". Автор делает краткий обзор Web components и показывает как их можно создавать с помощью Vue.js.</p><p data-placeholder="Take a notes">Web компоненты позволяют определять новые HTML теги,&nbsp;которые принято называть пользовательскими элементами (custom elements). Эти теги могут быть в дальнейшем использованы непосредственно в HTML коде вашего приложения:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"my-app"</span>&gt;</div><div class="l">  <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span>&gt;Introduction text<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span>&gt;</div><div class="l">  <span class="hljs-tag">&lt;</span><span class="hljs-name">share-buttons</span>/&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt; </div><div class="l"></div></code></pre><p>В этом примере,&nbsp;будет интерпретирован браузером и "заменен" HTML разметкой, которую вы для него определили. В результате получим:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"my-app"</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span>&gt;Introduction text<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">share-buttons</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"share-buttons"</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;Facebook<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;Twitter<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">share-buttons</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l"></div></code></pre><p>Так же здесь можно было бы использовать JS логику, чтобы при событии click делиться страницей через Facebook или Twitter.</p><p><strong>Web компоненты подобны Vue.js компонентам.</strong>&nbsp;Они имеют жизненный цикл (lifecycle), свойства и могут быть вложенными. Их API менее мощный, но зато следует стандарту, определенному в&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://www.w3.org/standards/techs/components#w3c_all">W3C спецификации</a>.</p><p><strong>Проблема в том, что Web компоненты не имеют полной поддержки в браузерах до настоящего момента.</strong>&nbsp;Посмотреть поддержку Web компонентов браузерами можно на сайте&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="http://jonrimmer.github.io/are-we-componentized-yet/">are-we-componentized-yet</a> или <a target="_blank" rel="noopener noreferrer nofollow" href="http://caniuse.com/#search=web%20components">caniuse.com</a> (*).</p><p>Но, применив немного JS магии&nbsp;<strong>вы можете прямо сейчас перевести ваши Vue.js компоненты в Web компоненты</strong>,&nbsp;что позволит использовать их в любых web приложениях, даже вместе с React, Angular или&nbsp;.</p><h3>Как получить из вашего Vue.js компонента универсальные Web компоненты</h3><p>Понадобится&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://karol-f.github.io/vue-custom-element">vue-custom-element</a>&nbsp;библиотека написанная&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/karol-f">@karol-f</a>. Она позволит вам&nbsp;<strong>использовать Vue.js компонент как пользовательский элемент</strong>.</p><h3>HTML подход</h3><p>Один раз зарегистрировав пользовательский компонент вы можете&nbsp;вставлять его тег&nbsp;в обычный HTML, SPA, React, Angular или Vue.js проект.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"my-app"</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span>&gt;Introduction text<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">share-buttons</span> <span class="hljs-attr">gplus</span>=<span class="hljs-string">"false"</span>/&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"share-buttons-template"</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"share-buttons"</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">"share"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"facebook"</span>&gt;Facebook<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">"share"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"twitter"</span>&gt;Twitter<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">"share"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"gplus"</span>&gt;Google+<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">template</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"vue.min.js"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"vue-custom-element.min.js"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">script</span>&gt;</div><div class="l">  <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">customElement</span>(<span class="hljs-string">''share-buttons''</span>, {</div><div class="l">  &nbsp; <span class="hljs-attr">template</span>: <span class="hljs-string">''#share-buttons-template''</span>,</div><div class="l">  &nbsp; <span class="hljs-attr">props</span>: {</div><div class="l">  &nbsp; &nbsp; <span class="hljs-attr">facebook</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>, <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span> },</div><div class="l">  &nbsp; &nbsp; <span class="hljs-attr">twitter</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>, <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span> },</div><div class="l">  &nbsp; &nbsp; <span class="hljs-attr">gplus</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>, <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span> }</div><div class="l">  &nbsp; },</div><div class="l">  &nbsp; <span class="hljs-attr">methods</span>: {</div><div class="l">  &nbsp; &nbsp; share ($event) {</div><div class="l">  &nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">''Share on ''</span> + $event.<span class="hljs-property">target</span>.<span class="hljs-property">innerHTML</span>);</div><div class="l">  &nbsp; &nbsp; }</div><div class="l">  &nbsp; }</div><div class="l">  });</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt; </div><div class="l"></div></code></pre><p><strong>Данный подход требует включения в вашу страницу ядра Vue.js и библиотеки vue-custom-element.</strong></p><p>Props будут&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://karol-f.github.io/vue-custom-element/#/demos/basic">автоматически интерпретированы к их нативным типам</a>&nbsp;(атрибут "false" интерпретируется как boolean значение false).</p><p>API пользовательского элемента доступно так же как любого другого HTML элемента: document.getElementsByTagName(''share-buttons'').</p><p>Пример выше использует HTML тег&nbsp;, но вы можете поместить строку шаблона непосредственно в template свойство вашего компонента.</p><h4>Плюсы и минусы</h4><p>Из вышеописанного подхода следует что:</p><ul><li><p>зависимый скрипт должен быть включен в итоговый HTML файл</p></li><li><p>поведение компонента можно прочитать непосредственно из исходного кода страницы</p></li></ul><p>Это может оказаться как плюсами, так и минусами в зависимости от ваших задач.Наиболее вероятный подход, который я могу представить - это распространение Vue.js компонентов в форме виджетов на множество вебсайтов. Итак, давайте соберем весь этот код в единый файл.</p><h3>Сборка Vue.js компонентов в единый .js файл</h3><p>Посмотрите на&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/kartsims/vue-customelement-bundler">vue-customelement-bundler</a>&nbsp;репозиторий, который содержит:</p><ul><li><p>настройки Webpack</p></li><li><p>код компонента (ES2015 во .vue файле)</p></li><li><p>NPM зависимости, чтобы можно было собрать и запустить собственный экземпляр</p></li></ul><p><strong>Он позволяет взять код Vue.js компонента (в форме .vue файла) и на выходе получить единый .js файл</strong>&nbsp;с вложенным кодом самого Vue, библиотеки vue-custom-element и вашего Vue.js компонента. Получившийся файл будет зарегистрирован, чтобы использоваться, как пользовательский элемент. Далее, можно использовать ваш компонент в любом HTML/JS приложении, подобно этому:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; &nbsp; ...</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">my-vue-component</span>/&gt;</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; &nbsp; <span class="hljs-comment">&lt;!-- allows multiples instances of the same component --&gt;</span></div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">my-vue-component</span> <span class="hljs-attr">my-prop</span>=<span class="hljs-string">"true"</span>/&gt;</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"my-vue-component.js"</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"> </div><div class="l"> </div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt;</div><div class="l"></div></code></pre><p>Замечание:&nbsp; Итоговый файл весит 266kB (предыдущий текст перечеркнут). Слишком большой размер файла. Мои навыки в работе с Webpack не позволили его уменьшить. Попытки ипользовать плагин UglifyJsPlugin привели к ошибке, которую не удалось устранить. Возможно, у вас получиться лучше, пожалуйста сообщите мне как можно оптимизировать мои настройки, уверен их можно улучшить.</p><p>Изменение 5/4: Спасибо&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/anthonygore">@anthonygore</a>&nbsp;и UglifyJS,&nbsp;итоговый файл стал весить 113kB (предыдущий текст перечеркнут).</p><p>Изменение 6/4: Энтони удалось уменьшить сборку еще на 22kB.&nbsp;<strong>Итоговый файл теперь весит 91kB (32kB в gzip)!</strong></p><p>Изменение 11/4:&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/chimon2000">@chimon2000</a>&nbsp;предложено в качестве альтернативы для сборки&nbsp;<strong>использовать rollup.js, таким образом, вес файла стал 76kB (24kB в gzip)</strong>, спасибо Раян! Эта сборка находится в&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/kartsims/vue-customelement-bundler/tree/rollup">rollup&nbsp;ветке&nbsp;репозитория</a>.</p><h3>Немного об API Web компонентов (Web Components API)</h3><p>Это часть статьи не обязательна&nbsp;для использования Vue.js компонентов, как Web компонентов, но часто бывает полезно знать как это работает, чтобы писать код лучше.</p><p>Web компоненты включают следующие W3C спецификации:</p><ul><li><p>Custom Element</p></li><li><p>HTML Template</p></li><li><p>HTML Import</p></li></ul><p>Рассмотрим каждую из них подробнее.</p><h4>Custom Element</h4><p>Custom Element является основным API, доступным разработчикам для определения новых HTML тегов, которые могут быть интерпретированы браузером.</p><p><strong>Функции обратных вызовов жизненного цикла (иначе говоря,&nbsp;</strong><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.w3.org/TR/custom-elements/#custom-element-reactions"><strong>реакции</strong></a><strong>):</strong></p><ul><li><p>constructor (элемент обновлен, имеется ввиду вставлен в DOM с помощью JS или изначально там находился)</p></li><li><p>connectedCallback (вставка в DOM)</p></li><li><p>disconnectedCallback (удаление из DOM)</p></li><li><p>adoptedCallback (перемещение в новый документ)</p></li><li><p>attributeChangedCallback</p></li></ul><p>Звучит знакомо? Да, это выглядит как жизненный цикл компонентов Vue.js!Однако, написание пользовательских элементов намного более многословно. Одна из причин этого - вы не можете получить выгоду от магии реактивных свойств во Vue.js, или "сахара" в синтаксисе шаблонов типо v-if выражений.</p><p>Регистрация пользовательских элементов выполняется используя window.customElements.define, как в примере ниже:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {</div><div class="l"> </div><div class="l">&nbsp; <span class="hljs-title function_">constructor</span>() {</div><div class="l">&nbsp; &nbsp; <span class="hljs-variable language_">super</span>();</div><div class="l">&nbsp; &nbsp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">msg</span> = <span class="hljs-string">''Hello, World!''</span>;</div><div class="l">&nbsp; }</div><div class="l">  </div><div class="l">&nbsp; <span class="hljs-title function_">connectedCallback</span>() {</div><div class="l">&nbsp; &nbsp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`&lt;p&gt;</span><span class="hljs-subst">${</span><span class="hljs-variable language_">this</span>.msg}&lt;/p&gt;`;</div><div class="l">&nbsp; }</div><div class="l">}</div><div class="l"> </div><div class="l"><span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">''my-element''</span>, <span class="hljs-title class_">MyElement</span>); </div><div class="l"></div></code></pre><p>Обратите внимание, что connectedCallback вызывается, когда элемент уже вставлен.</p><p>Помимо этого, теги компонентов должны соответствовать нескольким требованиям:</p><ul><li><p>содержать дефис</p></li><li><p>не содержать заглавных символов</p></li><li><p>не использовать одно из запрещенных имен (annotation-xml, color-profile и т.д.)</p></li></ul><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.w3.org/TR/custom-elements/#valid-custom-element-name">Подробнее в&nbsp;W3C спецификации.</a></p><h4>HTML Template</h4><p>Разметка пользовательского элемента может содержаться в теге&nbsp;внутри DOM.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"share-buttons-template"</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"share-buttons"</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;Facebook<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;Twitter<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">template</span>&gt;</div><div class="l"></div></code></pre><p>Эта разметка может быть импортирована и клонирована в пользовательский элемент по реакции на createdCallback.</p><h4>HTML Import</h4><p>Определяет разметку и JS логику в одном файле, который может быть импортирован в ваше приложение с помощью одного тега.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"import"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"share-buttons.html"</span>&gt;</div><div class="l">&nbsp; &nbsp; ...</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">body</span>&gt;</div><div class="l">&nbsp; &nbsp; ...</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">share-buttons</span>&gt;<span class="hljs-tag">&lt;/</span><span class="hljs-name">share-buttons</span>&gt;</div><div class="l">&nbsp; &nbsp; ...</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>Содержимое файла share-buttons.html:</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-tag">&lt;</span><span class="hljs-name">html</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">template</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"share-buttons"</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;Facebook<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;Twitter<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span>&gt;</div><div class="l">&nbsp; &nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">template</span>&gt;</div><div class="l">&nbsp; <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span>&gt;</div><div class="l">&nbsp; &nbsp; (<span class="hljs-keyword">function</span>() {</div><div class="l">&nbsp; &nbsp; &nbsp; ...</div><div class="l">&nbsp; &nbsp; &nbsp; <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">registerElement</span>(<span class="hljs-string">''share-buttons''</span>, { <span class="hljs-attr">prototype</span>: <span class="hljs-title class_">MyCustomElement</span> });</div><div class="l">&nbsp; &nbsp; });</div><div class="l">&nbsp; <span class="hljs-tag">&lt;/</span><span class="hljs-name">script</span>&gt;</div><div class="l"><span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span>&gt; </div><div class="l"></div></code></pre><p>Звучит все более и более знакомо, не так ли?</p><p>(**)</p><h3>Взаимодействие компонентов</h3><p>Взаимодействие компонента с его родителем происходит посредством событий, точно так же как во Vue.js. События запускаются используя dispatchEvent метод HTML элементов.</p><pre><code autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"><div class="l"><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">''content-shared''</span>)); </div><div class="l"></div></code></pre><p>Родительский компонент может взаимодействовать с дочерними двумя способами:</p><ul><li><p>используя атрибуты</p></li><li><p>используя методы компонента прототипа</p></li></ul><p>Первый способ точно такой же как во Vue.js. Вы можете установить атрибуты, только они не будут реактивными, так что вам будет нужно использовать attributeChangedCallback если захотите запускать логику, когда заначение атрибутов меняется.</p><p>Второй метод тоже работает во Vue.js, хотя там он и не рекомендуется.</p><h3>Поддержка и полифиллы (polyfills)</h3><p>Состоянии поддержки браузерами пользовательских компонентов можно узнать на&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="http://caniuse.com/#search=web%20components">caniuse.com</a>&nbsp;или&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="http://jonrimmer.github.io/are-we-componentized-yet/">are-we-componentized-yet</a>.</p><p>Библиотека полифиллов позволяет вам использовать эти API в браузерах, еще не имеющих их поддержки. Ниже ссылки на некоторые из них:</p><ul><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/webcomponents/custom-elements">Custom Elements polyfill</a>&nbsp;(от команды Polymer)</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/WebReflection/document-register-element">document-register-element</a>&nbsp;(от Andrea Giammarchi)</p></li></ul><p><em>Замечание: я не упоминал Shadow DOM в этой статье. Думаю это могло бы смутить разработчиков, которые фокусируются на переносе их Vue.js компонентов к пользовательским элементам. Посмотрите ссылки в конце, чтобы получить больше информации по данной теме.</em></p><h3>Ссылки</h3><ul><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://karol-f.github.io/vue-custom-element/">Vue Custom Element</a>: трансформация Vue.js компонентов в пользовательские элементы.</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/kartsims/vue-customelement-bundler">Vue Custom Element Bundler</a>: сборка Vue.js компонентов в виде единого .js файла.</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.webcomponents.org/">WebComponents.org</a>: каталог и ресурсы по пользовательским элементам (Custom Elements).</p></li><li><p>Статья "The case for Custom Elements" (<a target="_blank" rel="noopener noreferrer nofollow" href="https://medium.com/dev-channel/the-case-for-custom-elements-part-1-65d807b4b439#.lj3f8evee">часть 1</a>&nbsp;и&nbsp;<a target="_blank" rel="noopener noreferrer nofollow" href="https://medium.com/dev-channel/the-case-for-custom-elements-part-2-2efe42ce9133#.x0xz0nwph">часть 2</a>) автор Rob Dodson.</p></li><li><p><a target="_blank" rel="noopener noreferrer nofollow" href="http://www.backalleycoder.com/2016/08/26/demythstifying-web-components/">Demythstifying Web Components</a>&nbsp;автор Daniel Buchner.</p></li></ul><h3><br></h3><h3>Примечания к переводу</h3><p>* На начало августа 2019 года все современные браузеры начали поддерживать актуальные спецификации Web Components. Исключением можно назвать MS Edge, но стоит учитывать, что Microsoft отказалась от дальнейшего развития собственной архитектуры и <a target="_blank" rel="noopener noreferrer nofollow" href="https://habr.com/en/company/microsoft/blog/447364/">уже планируется выход Edge на основе Chromium</a>.</p><p>** Со времени написания и перевода статьи спецификации претерпели ряд изменений. Актуальную информацию можно найти на сайте <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.webcomponents.org/">webcomponents.org</a>.</p><p>*** К сожалению, ссылка на оригинал недоступна, автор удалил сайт.</p></section>
        </article>
      </body>
      <script type="text/javascript" src="/js/note.js"></script>
    </html>